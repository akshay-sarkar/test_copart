angular.element(document).ready(function(){angular.bootstrap(document,["g2app"])});var app=angular.module("g2app",["ngRoute","ngCookies","ui.bootstrap","ui.sortable","angular-loading-bar","LocalStorageModule","ngSanitize","ngCsv","angular-google-adsense","ui.carousel","vcRecaptcha"]);
app.factory("config",["$location","$cookies",function($location,$cookies){if(AppUtils.isUndefined(appInit))throw Error('Missing "appInit" object.');var logLevel=appInit.logLevel;logLevel=AppUtils.isString(logLevel)?logLevel.toLowerCase().trimToNull():"info";logLevel=logLevel!==null?logLevel:"info";var userLang=AppUtils.trimToNull(appInit.userLang);userLang=!AppUtils.isUndefined(userLang)?userLang.toLowerCase():"en";var userVariant=AppUtils.trimToNull(appInit.userVariant);userVariant=!AppUtils.isUndefined(userVariant)?
userVariant.toLowerCase():null;var userTerritory=AppUtils.trimToNull(appInit.userTerritory);_.templateSettings={interpolate:/\[\[(.+?)\]\]/g,evaluate:/\{\[(.+?)\]\}/g};return{appName:"Member",appDescription:"Copart Member",appRelease:"0.0.1",logLevel:logLevel?logLevel:"debug",locale:{lang:userLang,variant:userVariant,territory:userTerritory}}}]);"use strict";
function UserConfig(params){ModelBase(this);var self=this;if(params==null)params={};var userConfig=params.data.userConfig;var buildPhysicalAddress=function(memberContactInfo){var physicalAddress=new AddressVO;physicalAddress.line1=memberContactInfo.physicalAddressLine1;physicalAddress.line2=memberContactInfo.physicalAddressLine2;physicalAddress.country=memberContactInfo.country;physicalAddress.city=memberContactInfo.city;physicalAddress.state=memberContactInfo.state;physicalAddress.postCode=memberContactInfo.zip1;
return physicalAddress};self.updateContactInfo=function(memberContactInfo){if(memberContactInfo.mailingAddressZip1)self.buyerZip=memberContactInfo.mailingAddressZip1;if(memberContactInfo.mailingAddressCountry)self.country=memberContactInfo.mailingAddressCountry;self.memberContactInfo=memberContactInfo};self.membershipExpiringSoon=userConfig.membershipExpiringSoon;self.membershipExpiresIn=userConfig.membershipExpiresIn;self.userAccess=userConfig.userAccess;self.timezoneList=moment.tz.names();self.selectedTimezone=
null;self.currentTimezone=null;self.currentTime=null;self.buyerZip=null;self.country=null;self.timeInTimezonePicker=null;self.roles=userConfig.roles;self.siteCode=userConfig.siteCode;self.siteDomain=userConfig.siteDomain;self.displayPref=userConfig.displayPref;self.selectedLang=userConfig.selectedLang;self.defaultDisplayPref=userConfig.defaultDisplayPref;self.internationalMember=userConfig.internationalMember;self.isUpgradeMembershipInProgressFlag=userConfig.isUpgradeMembershipInProgressFlag;if(userConfig.memberContactInfo){self.updateContactInfo(userConfig.memberContactInfo);
self.physicalAddress=buildPhysicalAddress(self.memberContactInfo)}self.userLang=userConfig.userLang;self.privileges=userConfig.privileges;self.buyerStatus=userConfig.buyerStatus;self.isUpdateEmailRequired=userConfig.updateEmail;self.siteCode=userConfig.siteCode;self.membershipType=userConfig.membershipType;self.licenceCategory=userConfig.licenceCategory;self.pwdDaysToExp=userConfig.pwdDaysToExp;self.crmId=userConfig.crmId;self.buyerNumber=userConfig.buyerNumber;if(userConfig.displayUserName!=null)self.displayUserName=
userConfig.displayUserName;self.langOptions=userConfig.defaultDisplayPref.languageOptions;self.currencyCode=userConfig.defaultDisplayPref.currencyCode;self.secondaryCurrencyCode=userConfig.defaultDisplayPref.secondaryCurrencyCode;if(userConfig.zipToCoordinate)self.zipToCoordinate=userConfig.zipToCoordinate;self.signInOptions=userConfig.defaultDisplayPref.signInOptions;self.userHomepageWidget=userConfig.defaultDisplayPref.userHomepageWidget;self.paymentsDueWidget=userConfig.defaultDisplayPref.paymentsDueWidget;
self.homepageWidget=userConfig.defaultDisplayPref.homepageWidget;self.navigationOptions=userConfig.defaultDisplayPref.navigationOptions;self.footerLinks=userConfig.defaultDisplayPref.footerLinks;self.headerLinks=userConfig.defaultDisplayPref.headerLinks;self.sellavehicleBusiness=userConfig.defaultDisplayPref.sellavehicleBusiness;self.blockAccountInfoLinks=userConfig.displayPref.blockAccountInfoLinks;self.blockMyAccountDropDownLinks=userConfig.displayPref.blockMyAccountDropDownLinks;self.myBidsPreference=
userConfig.defaultDisplayPref.myBidsPreference;self.lotsWonPreference=userConfig.defaultDisplayPref.lotsWonPreference;self.lotsLostPreference=userConfig.defaultDisplayPref.lotsLostPreference;self.payOptions=userConfig.defaultDisplayPref.payOptions;self.isPayOnline=userConfig.payOnline;self.dateFormat=userConfig.defaultDisplayPref.dateFormat.toUpperCase();self.timeFormat=userConfig.defaultDisplayPref.timeFormat;self.phoneFormatCountry=userConfig.phoneFormatCountry;self.auctionMapCoordinates=userConfig.displayPref.auctionMapCoordinates;
self.downloadSalesDataPreference=userConfig.defaultDisplayPref.downloadSalesDataPreference;self.companyCode=userConfig.companyCode;self.registrationPreference=userConfig.defaultDisplayPref.registrationPreference;self.blockLiveChat=userConfig.defaultDisplayPref.blockLiveChat;self.allowJivoChat=userConfig.defaultDisplayPref.allowJivoChat;self.preferredCountryCode=userConfig.defaultDisplayPref.preferredCountryCode;if(userConfig.prefLocs)self.prefLocs=userConfig.prefLocs;self.lotDetailsPreference=userConfig.defaultDisplayPref.lotDetailsPreference||
{"saleDateFormat":"ddd. MMM DD, YYYY","saleTimeFormat":"hh:mm A zz","lastUpdatedDateFormat":"MM/dd/yyyy h:mm a"};self.salesListPreference=userConfig.defaultDisplayPref.salesListPreference;self.auctionFields=userConfig.defaultDisplayPref.auctionFields;self.vehicleFinderPreference=userConfig.defaultDisplayPref.vehicleFinderPreference;var defaultPasswordRule={"minLength":"5","maxLength":"10"};self.passwordRule=userConfig.defaultDisplayPref.passwordRule||defaultPasswordRule;var defaultEmailRule={"maxLength":"40"};
self.emailRule=userConfig.defaultDisplayPref.emailRule||defaultEmailRule;self.showEmailSubscription=userConfig.defaultDisplayPref.showEmailSubscription;self.showVirtualSales=userConfig.defaultDisplayPref.showVirtualSales;self.email=userConfig.email;if(userConfig.defaultDisplayPref.hideSaleType)self.hideSaleType=userConfig.defaultDisplayPref.hideSaleType;else self.hideSaleType=false;if(userConfig.defaultDisplayPref.hideSalesList)self.hideSalesList=userConfig.defaultDisplayPref.hideSalesList;else self.hideSalesList=
false;self.supportedMemberChoices=self.defaultDisplayPref.supportedMemberChoices;self.siteRegionCode=userConfig.siteRegionCode;self.searchPreference=self.defaultDisplayPref.searchPreference;if(userConfig.defaultDisplayPref&&userConfig.defaultDisplayPref.customLocationsList)self.customLocationsList=userConfig.defaultDisplayPref.customLocationsList;self.mobileAppUser=userConfig.mobileAppUser;self.availableSubscriptionsMap=userConfig.availableSubscriptionsMap;self.brand=userConfig.brand;self.countryFlagsPreference=
userConfig.defaultDisplayPref.countryFlagsPreference;self.paymentCap=userConfig.defaultDisplayPref.paymentCap;self.isKioskBidder=userConfig.isKioskBidder;self.isNonSyncedBuyer=userConfig.nonSyncedBuyer;self.noLicensesPresent=userConfig.noLicensesPresent;self.isMemberGoingTobeLapsed=userConfig.memberGoingTobeLapsed;self.companyFlag=userConfig.companyFlag;self.txtSubscribed=userConfig.txtSubscribed;self.highVolPayments=userConfig.displayPref.highVolPayments;self.highVolPaymentCri=userConfig.paymentDueInquiryVO;
self.accountAlerts=userConfig.accountAlerts;self.displayAlertsModal=userConfig.displayAlertsModal;self.driverSeat=userConfig.defaultDisplayPref.driverSeat;return self}
app.provider("copartUser",function(){var self=this;var _userTimeZone=null;var _dateFormat="dd-MMM-yyyy";var _timeFormat="hh:mm:ss";var _dateTimeFormat="dd-MMM-yyyy hh:mm";var _userConfig=null;self.fetchUserConfig=function(){jQuery.ajax({cache:false,url:"/public/data/userConfig",success:function(data){data.selectedLang="en";data.timezoneList=moment.tz.names();_userConfig=new UserConfig(data)},async:false})};self.getUserConfig=function(){return _userConfig};self.fetchUserConfig();this.$get=function($q,
$cookies,$window){return{config:_userConfig,setUserConfig:function(userConfig){self._userConfig=userConfig},getUserConfig:function(){return _userConfig},getUserTimzone:function(){return _userConfig.selectedTimezone},getUserTimzoneAbbr:function(){var time=moment.tz(moment(),_userConfig.selectedTimezone);var abbr=time.tz(_userConfig.currentTimezone).zoneAbbr();return abbr},getUserTimzoneOffset:function(){var time=moment.tz(moment(),_userConfig.selectedTimezone);var offset=time.utcOffset();return offset},
getUserDateFormat:function(){return _dateFormat},getUserTimeFormat:function(){return _timeFormat},getUserDateTimeFormat:function(){return _dateTimeFormat},setUserTimezone:function(userTimeZone){_userTimeZone=userTimeZone},hasAccessPrivilege:function(accessValue){return _.contains(_userConfig["privileges"],accessValue)},hasRoleAccess:function(accessValue){return _.contains(_userConfig["roles"],accessValue)},hasAccessSitePref:function(sitePrefCode,accessValue){var hasValue=false;var sitePrefValue=this.getPreferenceValue(sitePrefCode);
if(accessValue&&sitePrefValue)if(Array.isArray(sitePrefValue))hasValue=_.contains(sitePrefValue,accessValue);else if(sitePrefValue.indexOf(accessValue)>-1)hasValue=true;else hasValue=false;return hasValue},getPreferenceValue:function(sitePrefCode){return getNestedProperty(sitePrefCode,_userConfig)},changeTimezone:function(saveNewTimeZone){var time=moment.tz(moment(),_userConfig.selectedTimezone);var abbr=time.tz(_userConfig.selectedTimezone).zoneAbbr();_userConfig.timeInTimezonePicker=moment(time).format(_userConfig.timeFormat)+
" "+abbr;if(saveNewTimeZone){_userConfig.currentTimezone=_userConfig.selectedTimezone;$cookies.put("timezone",_userConfig.selectedTimezone);_userConfig.currentTime=_userConfig.timeInTimezonePicker;var userPrefTZ={displayStr:abbr,offset:time.utcOffset()/60,dst:time.isDST(),windowsTz:_userConfig.selectedTimezone};$cookies.put("copartTimezonePref",JSON.stringify(userPrefTZ))}},updateTime:function(){var time=moment.tz(moment(),_userConfig.selectedTimezone);var abbr=time.tz(_userConfig.selectedTimezone).zoneAbbr();
_userConfig.timeInTimezonePicker=moment(time).format(_userConfig.timeFormat)+" "+abbr;var currentTime=moment.tz(moment(),_userConfig.currentTimezone);var currentTimeAbbr=currentTime.tz(_userConfig.currentTimezone).zoneAbbr();_userConfig.currentTime=moment(currentTime).format(_userConfig.timeFormat)+" "+currentTimeAbbr},updateLanguage:function(selectedLang){_userConfig.selectedLang=selectedLang;$cookies.put("userLangChanged_"+_userConfig.siteCode,true)},initializeTime:function(){var timezone=$cookies.get("timezone"),
time,abbr,tz,userPrefTZ;if(timezone!=null){time=moment.tz(moment(),timezone);abbr=time.tz(timezone).zoneAbbr();_userConfig.currentTimezone=timezone}else{time=moment();tz=jstz.determine();abbr=time.tz(tz.name()).zoneAbbr();_userConfig.currentTimezone=tz.name()}_userConfig.selectedTimezone=_userConfig.currentTimezone;_userConfig.timeInTimezonePicker=moment(time).format(_userConfig.timeFormat)+" "+abbr;var currentTime=moment.tz(moment(),_userConfig.currentTimezone);var currentTimeAbbr=currentTime.tz(_userConfig.currentTimezone).zoneAbbr();
_userConfig.currentTime=moment(currentTime).format(_userConfig.timeFormat)+" "+currentTimeAbbr;userPrefTZ={displayStr:abbr,offset:time.utcOffset()/60,dst:time.isDST(),windowsTz:_userConfig.currentTimezone};$cookies.put("copartTimezonePref",JSON.stringify(userPrefTZ));$cookies.put("timezone",_userConfig.currentTimezone)},getLocationUrlWithLocale:function(url){return _userConfig.defaultDisplayPref.selectedLang===_userConfig.selectedLang?url:"/"+_userConfig.selectedLang+url},setUpgradeFlag:function(value){_userConfig.isUpgradeMembershipInProgressFlag=
value},getUpgradeFlag:function(){return null==_userConfig?false:_userConfig.isUpgradeMembershipInProgressFlag},setTextSubscribed:function(value){_userConfig.txtSubscribed=value},refreshAndGetConfig:function(){self.fetchUserConfig();return _userConfig},updateAccountAlerts:function(accountAlertCode){var accountAlerts=_userConfig.accountAlerts;for(var i=0;i<accountAlerts.length;++i)if(accountAlerts[i].alerts&&accountAlerts[i].alerts.length>0)accountAlerts[i].alerts=accountAlerts[i].alerts.filter(function(alert){return alert.alertCode!==
accountAlertCode});_userConfig.accountAlerts=accountAlerts},addAccountAlerts:function(value){_userConfig.accountAlerts=value},setDisplayAlertsModal:function(value){_userConfig.displayAlertsModal=value}}}});
app.config(function($routeProvider,$locationProvider,copartUserProvider,$httpProvider,$compileProvider,localStorageServiceProvider,$cookiesProvider,$windowProvider,searchCriteriaConstants){$compileProvider.debugInfoEnabled(false);var $thisWindow=$windowProvider.$get();$httpProvider.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";if(!$httpProvider.defaults.headers.get)$httpProvider.defaults.headers.get={};function filterContentUrl(url){var contentPath=url;return contentPath}var region=
appInit.appPlatform=="gbl"?"_GLOBAL":"";localStorageServiceProvider.setPrefix("g2app").setStorageType("sessionStorage").setNotify(true,true);$cookiesProvider.defaults.domain="."+copartUserProvider.getUserConfig().siteDomain;$cookiesProvider.defaults.path="/";$httpProvider.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT";$httpProvider.defaults.timeout=15E3;$httpProvider.defaults.headers.get["Cache-Control"]="no-cache";$httpProvider.defaults.headers.get["Pragma"]="no-cache";
if(appInit.csrfToken!=null){$httpProvider.defaults.xsrfHeaderName="X-XSRF-TOKEN";$httpProvider.defaults.headers.common["Accept"]="application/json, text/plain, */*";$httpProvider.defaults.headers.common["Access-Control-Allow-Headers"]="Content-Type, X-XSRF-TOKEN";$httpProvider.defaults.headers.common["X-XSRF-TOKEN"]=appInit.csrfToken}$httpProvider.interceptors.push("templateInterceptor");$httpProvider.interceptors.push("authHttpResponseInterceptor");$httpProvider.interceptors.push("HttpRequestTimeoutInterceptor");
$httpProvider.interceptors.push("XSSRequestWrapperInterceptor");$locationProvider.html5Mode(true);$httpProvider.interceptors.push(function($q,$cookies){return{"request":function(config){if($cookies.get("JWT_TOKEN"))$httpProvider.defaults.headers.common.Authorization=$cookies.get("JWT_TOKEN");return config}}});var getLocDetailsRouteInfo=function(){return{templateUrl:"/public/fetchDirective.html?directive\x3dlocation/locationdetail",controller:"locationDetailController",allowAccess:["ROLE_ANONYMOUS"],
pageName:"locations_",titleKey:"app.locations.title",descKey:"app.locations.description",titleArguments:["yardName"],descArguments:["yardAddress"],activeTab:"locations"}};var getLocListRouteInfo=function(){return{templateUrl:"/public/fetchDirective.html?directive\x3dlocation/locationsList",controller:"locationsListController",allowAccess:["ROLE_ANONYMOUS"],pageName:"locations",titleKey:"app.ourLocations.title",descKey:"app.ourLocations.description",activeTab:"locations"}};$routeProvider.when("/",
{templateUrl:"/home/content?userLang\x3d"+appInit.userLang,controller:"homeContentController",pageName:"homepage",resolve:{cldrData:waitForCLDRInitialization.cldrData},allowAccess:["ROLE_ANONYMOUS"],titleKey:"app.home.title",descKey:"app.home.description",redirectAfterLoginUrl:"/dashboard",displayAnchorAds:true,activeTab:"homePage"}).when("/scheduleMaintainance/",{templateUrl:"/public/fetchDirective.html?directive\x3derror/schedule-maintainance"}).when("/dashboard/",{templateUrl:"/fetchDirective.html?directive\x3dhome/dashboard2",
controller:"dashBoardController2",pageName:"dashboard",activeTab:"dashboard"}).when("/redirectToPaymentGateway/:flag",{templateUrl:"/public/fetchDirective.html?directive\x3dhome/RenewalFeesModal",controller:"UpgradeMembershipController",allowAccess:["ROLE_ANONYMOUS"]}).when("/contactUs/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Contact-Us/Member-Services",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",
descKey:"app.content.description",activeTab:"support"}).when("/myBids/",{templateUrl:"/fetchDirective.html?directive\x3dbidStatus/myBids",controller:"myBidsController",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"myBids",noCache:true,activeTab:"bidStatus"}).when("/myBids/:filterType/",{templateUrl:"/fetchDirective.html?directive\x3dbidStatus/myBids",controller:"myBidsController",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"paymentHistory",noCache:true,activeTab:"bidStatus"}).when("/Content/:region/:lang/:contentPath*",
{caseInsensitiveMatch:true,templateUrl:function(loc){var contentPath=filterContentUrl(loc.contentPath);try{if(appInit.localeString.toLowerCase()!=loc.lang.toLowerCase())$("body").trigger("contentRoute",[appInit.localeString,loc.region,contentPath])}catch(e){console.log(e)}return"/CMS/"+appInit.localeString+"/Content/"+loc.region+"/"+appInit.localeString+"/"+contentPath},controller:"cmsController",titleKey:"app.content.title",descKey:"app.content.description",titleArguments:["title"],descArguments:["description"],
pageName:"content",ignoreCanonicalRef:true}).when("/:lang/Content/:region/:lang/:contentPath*",{caseInsensitiveMatch:true,templateUrl:function(loc){var contentPath=filterContentUrl(loc.contentPath);try{if(appInit.localeString.toLowerCase()!=loc.lang.toLowerCase())$("body").trigger("contentRoute",[appInit.localeString,loc.region,contentPath])}catch(e){console.log(e)}return"/CMS/"+appInit.localeString+"/Content/"+loc.region+"/"+appInit.localeString+"/"+contentPath},controller:"cmsController",titleArguments:["title"],
descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",pageName:"content",ignoreCanonicalRef:true}).when("/international-shipping",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/landing-page/International-shipping-index",controller:"shippingContentController"}).when("/setNewPassword",{controller:"loginController"}).when("/tempPasswordExpired",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/tempPasswordExpired"}).when("/locations/",
getLocListRouteInfo()).when("/locationsList/",getLocListRouteInfo()).when("/locations/:locationName/",getLocDetailsRouteInfo()).when("/locationDetail/:yardNumber/",getLocDetailsRouteInfo()).when("/location/:yardNumber/",getLocDetailsRouteInfo()).when("/contactBroker/",{templateUrl:"/fetchDirective.html?directive\x3dbidderManagement/contactBroker",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/expiredPassword/",
{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/changePassword",controller:"accountInfoChangePwdController"}).when("/bidders/",{templateUrl:"/fetchDirective.html?directive\x3dbidderManagement/bidders",controller:"bidderManagementController",activeTab:"myAccount"}).when("/thankyou/",{templateUrl:function($routeParams){return" /CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Registration/Thank-You"+($routeParams.type?"-"+$routeParams.type:"")},
controller:"thankYouController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",pageName:"registration-thankyou"}).when("/sitemapslimfooter/",{templateUrl:"/public/fetchDirective.html?directive\x3dsitemap/sitemapslimfooter",controller:"siteMapController",allowAccess:["ROLE_ANONYMOUS"]}).when("/collect-security-questions",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/collect-security-questions",controller:"CollectSecurityQuestionsController",
resolve:{referenceData:waitForReferenceDataMoreInitialization.referenceData}}).when("/create-password",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/create-password",controller:"CreatePasswordController"}).when("/registrationlanding/",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/registrationlanding",controller:"registrationController"}).when("/doRegistration/:activeStep?",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/registration",
controller:"registrationBaseController",redirectAfterLoginUrl:"/dashboard",removeChatOnRouteChange:true,titleKey:"app.register.title",descKey:"app.register.description"}).when("/usregister/:activeStep?",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/us/usRegistration",controller:"registrationBaseController",titleKey:"app.register.title",descKey:"app.register.description",resolve:{childParam:function(){return""}}}).when("/vehicleAlerts/",{templateUrl:"/public/fetchDirective.html?directive\x3dvehicle/vehicleAlerts",
controller:"VehicleAlertsController",resolve:waitForReferenceDataInitialization,allowAccess:["ROLE_ANONYMOUS"],titleKey:"app.vehiclealerts.title",descKey:"app.vehiclealerts.description",pageName:"VehicleAlerts",activeTab:"findVehicles"}).when("/vehicleAlerts/:subscribe",{templateUrl:"./public/fetchDirective.html?directive\x3dvehicle/vehicleAlerts",controller:"VehicleAlertsController",allowAccess:["ROLE_ANONYMOUS"],titleKey:"app.vehiclealerts.title",descKey:"app.vehiclealerts.description",activeTab:"findVehicles"}).when("/smsAlerts",
{templateUrl:"./public/fetchDirective.html?directive\x3dvehicle/smsvehicleAlertsLoading",controller:"smsVehicleAlertsController",allowAccess:["ROLE_ANONYMOUS"],titleKey:"app.vehiclealerts.title",descKey:"app.vehiclealerts.description"}).when("/us/VehicleAlert/:subscribe",{allowAccess:["ROLE_ANONYMOUS"],redirectTo:"/vehicleAlerts/:subscribe",titleKey:"app.vehiclealerts.title",descKey:"app.vehiclealerts.description"}).when("/updateBrokerBidderEmail/",{templateUrl:"/fetchDirective.html?directive\x3dbidderManagement/updateEmail",
controller:"brokerBidderEmailController"}).when("/downloadSalesData/",{templateUrl:"/fetchDirective.html?directive\x3dsales/downloadSalesData",controller:"downloadSalesDataController",activeTab:"findVehicles"}).when("/condition-report/lot/:lotId/:lotInfo?",{templateUrl:"/fetchDirective.html?directive\x3d/conditionReport/conditionReport",controller:"conditionReportController"}).when("/yard-condition-report/lot/:lotId/:lotInfo?",{templateUrl:"/public/fetchDirective.html?directive\x3d/conditionReport/conditionReport",
controller:"conditionReportApiController"}).when("/todaysAuction/",{templateUrl:"/public/fetchDirective.html?directive\x3dauction/todaysAuction",controller:"todaysAuctionController",resolve:{initData:function(appConfigService,dataServiceG2,$q){var deferred=$q.defer();if(AppUtils.isUndefined(appConfigService.getEnvConfigProps()))dataServiceG2.getEnvConfigProps(function(response){deferred.resolve(response)});else deferred.resolve(appConfigService.envConfigProps);return deferred.promise}},allowAccess:["ROLE_ANONYMOUS"],
pageName:"todaysauction_list",titleKey:"app.todaysauction.title",descKey:"app.todaysauction.description",activeTab:"Auctions"}).when("/savedsearch/",{templateUrl:"/fetchDirective.html?directive\x3dsavedSearches/savedsearch",controller:"savedSearchesController",allowAccess:["ROLE_ANONYMOUS"],title:"Saved Searches",pageName:"SavedSearch",titleKey:"app.header.savedSearch.title",descKey:"app.header.savedSearch.description",activeTab:"findVehicles",blockAccess:["ROLE_GUEST"]}).when("/auctionCalendar/",
{templateUrl:function(){return mobileCheck()?"/public/fetchDirective.html?directive\x3dauction/auctionCalendarMobile":"/public/fetchDirective.html?directive\x3dauction/auctionCalendar"},controller:"auctionCalendarController",allowAccess:["ROLE_ANONYMOUS"],pageName:"auction_calendar",scrollRestore:true,scrollRestoreKey:"auction_calendar",titleKey:"app.auctioncalendar.title",descKey:"app.auctioncalendar.description",activeTab:"Auctions"}).when("/marketGuide/:lotId/:vin/:isPurchased/:secretKey/",{templateUrl:"/fetchDirective.html?directive\x3dmarketGuide/marketGuide",
controller:"marketGuideController",allowAccess:["ROLE_ANONYMOUS"]}).when("/contact/",{templateUrl:"/pages/contact.htm",controller:"contactController"}).when("/accountInformation/complete-registration/",{redirectTo:"/complete-registration/"}).when("/accountInformation/:navMenu?/:edit?",{templateUrl:"/fetchDirective.html?directive\x3daccountinfo/accountinfo",controller:"AccountInfoController",blockAccess:["COUNTERMAN"],activeTab:"myAccount"}).when("/complete-registration/",{templateUrl:"/fetchDirective.html?directive\x3dcompleteRegistration/completeRegistration",
controller:"completeRegistrationController",pageName:"complete-registraton",resolve:{data:function(dataServiceG2){if(copartUserProvider&&copartUserProvider.$get())copartUserProvider.$get().setDisplayAlertsModal(false);dataServiceG2.updateDisplayAlertsModal({"displayAlertsModal":false})}}}).when("/driverseat/:view",{templateUrl:"/fetchDirective.html?directive\x3d/driverseat/driverseat",controller:"driverSeatController",scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"driverSeatResults",
activeTab:"driverseat",resolve:{cldrData:waitForCLDRInitialization.cldrData,searchQueryCriteria:function(searchCriteriaFactory,$route,$location,dataServiceG2,urlService,$q,History,$filter){var deferred=$q.defer();var routeParam=$route.current.params.view?$route.current.params.view:"mylots";var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants[routeParam]);if(searchCriteria.getSearchCriteriaObj())$location.search("searchCriteria",JSON.stringify(searchCriteria.getSearchCriteriaObj()));
deferred.resolve(searchCriteria);return deferred.promise}}}).when("/lotSearchResults/",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",noCache:true,scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"searchResults",reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(searchCriteriaFactory,$location,dataServiceG2,urlService,$q,History,$filter){var deferred=$q.defer();
var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);var searchQuery=$filter("sanitize_html")($location.search().query);if($location.search().YardNumber&&$location.search().searchTitle){var yard=$location.search().YardNumber;var displayStr=$location.search().searchTitle;var newUrl="/saleListResult/"+yard+"/?location\x3d"+displayStr;$location.url(newUrl).replace();return}if(!_.isUndefined(searchQuery)&&!_.isNull(searchQuery)&&!isNaN(searchQuery)&&!_.isEmpty(searchQuery)&&
searchQuery.length>4){var lotSearchArr=[];lotSearchArr.push("ps_lot_number:"+searchQuery);var lotSearchCriteria={MISC:lotSearchArr};searchCriteria.setMiscFilter(lotSearchArr);dataServiceG2.getLotsByLotNumber({filter:lotSearchCriteria},function(response){try{if(!_.isUndefined(response.data.data.results.content)&&response.data.data.results.content.length==1){var lot=response.data.data.results.content[0];$location.url(urlService.lotDetailUrl+lot.ln)}else if(response.data.data.results.content.length==
0){searchCriteria.reset();deferred.resolve(searchCriteria)}else{searchCriteria.setMiscFilter(lotSearchArr);deferred.resolve(searchCriteria)}}catch(e){searchCriteria.reset();deferred.resolve(searchCriteria)}})}else{searchCriteria.reset();deferred.resolve(searchCriteria)}return deferred.promise}},titleKey:"app.searchresults.title",descKey:"app.searchresults.description",arguments:["searchText"]}).when("/popular/:item/:value",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",
allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",noCache:true,scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"searchResults",reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(searchCriteriaFactory,$location,dataServiceG2,urlService,$q,History,$route,$filter){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);searchCriteria.setQuery($filter("sanitize_html")($route.current.params.value));
searchCriteria.setFreeForm(true);searchCriteria.reset();deferred.resolve(searchCriteria);return deferred.promise}},titleKey:"app.searchresults.title",descKey:"app.searchresults.description",arguments:["searchText"]}).when("/quickpick/:value/",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"quickpick",noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,
miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);var miscFilter=searchCriteria.getMiscFilter();if(!searchCriteria||!miscFilter||miscFilter.length==0)dataServiceG2.getQuickPicks("HOME",function(quickPicks){if(quickPicks&&quickPicks.quickPicksByUri[$route.current.params.value]){miscFilter.push(quickPicks.quickPicksByUri[$route.current.params.value]);searchCriteria.setMiscFilter(miscFilter);
searchCriteria.setDisplayStr(quickPicks.displayNameByUri[$route.current.params.value]);deferred.resolve(searchCriteria)}else deferred.reject(searchCriteria)});else deferred.resolve(searchCriteria);return deferred.promise}},titleKey:"app.quickpick.searchresults.title",descKey:"app.quickpick.searchresults.description",arguments:["searchText"]}).when("/search/:value/",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",scrollRestore:true,
scrollOnEvent:true,scrollRestoreKey:"search",noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);var miscFilter=searchCriteria.getMiscFilter();if(!searchCriteria||!miscFilter||miscFilter.length==0)dataServiceG2.getQuickPicks("VEHICLE_FINDER",function(quickPicks){if(quickPicks&&
quickPicks.quickPicksByUri[$route.current.params.value]){miscFilter.push(quickPicks.quickPicksByUri[$route.current.params.value]);searchCriteria.setMiscFilter(miscFilter);searchCriteria.setDisplayStr(quickPicks.displayNameByUri[$route.current.params.value]);deferred.resolve(searchCriteria)}else deferred.reject(searchCriteria)});else deferred.resolve(searchCriteria);return deferred.promise}},titleKey:"app.quickpick.searchresults.title",descKey:"app.quickpick.searchresults.description",arguments:["searchText"]}).when("/public/quickPickSearch/:pageId/:category/:value/",
{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"public/quickPickSearch",noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);var miscFilter=
searchCriteria.getMiscFilter();if(!searchCriteria||!miscFilter||miscFilter.length==0)dataServiceG2.getQuickPicks($route.current.params.pageId,function(quickPicks){if(quickPicks&&quickPicks.quickPicksByUri[$route.current.params.value]){miscFilter.push(quickPicks.quickPicksByUri[$route.current.params.value]);searchCriteria.setMiscFilter(miscFilter);searchCriteria.setDisplayStr(quickPicks.displayNameByUri[$route.current.params.value]);deferred.resolve(searchCriteria)}else deferred.reject(searchCriteria)});
else deferred.resolve(searchCriteria);return deferred.promise}},titleKey:"app.quickpick.searchresults.title",descKey:"app.quickpick.searchresults.description",arguments:["searchText"]}).when("/vehicleFinderSearch/",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Search Results",noCache:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestore:true,scrollRestoreKey:"vehicleFinderSearch",resolve:{miscSearchQuery:function(searchCriteriaFactory,
$location,History){var searchStr=$location.search().searchStr;var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);if(_.isUndefined(searchStr)){history.pushState(null,null,"/"+History.secondLastRoute);var vehicleFinderSearch={"MISC":searchCriteria.getMiscFilter(),"sortByZip":searchCriteria.getSortByZip(),"buyerEnteredZip":searchCriteria.getBuyerEnteredZip(),"milesAway":searchCriteria.getMilesAway()};$location.search("searchStr",JSON.stringify(vehicleFinderSearch))}else searchCriteria.reInitialize(JSON.parse($location.search().searchStr));
return searchCriteria}},pageName:"vehiclefinder",titleKey:"app.searchresults.title",descKey:"app.searchresults.description",arguments:["searchText"]}).when("/watchList/",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",title:"Watchlist",noCache:true,scrollOnEvent:true,scrollRestore:true,reloadOnSearch:false,scrollRestoreKey:"watchlist",allowAccess:["ROLE_ANONYMOUS"],resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,
$q,$route,$location){var deferred=$q.defer();var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);searchCriteria.reset();deferred.resolve(searchCriteria);return deferred.promise}},pageName:"watchlist",titleKey:"app.header.watchlist.title",descKey:"app.header.watchlist.description",activeTab:"findVehicles"}).when("/public/watchList/",{templateUrl:"/fetchDirective.html?directive\x3dwatchlist/watchlistContent",controller:"appController",allowAccess:["ROLE_ANONYMOUS"],
title:"Watchlist",pageName:"Public:watchlist",titleKey:"app.header.watchlist.title",descKey:"app.header.watchlist.description",redirectAfterLoginUrl:"/watchList",activeTab:"findVehicles"}).when("/saleListResult/auctionId/:auctionId/:yard/:auctionDate",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",
arguments:["searchText"],noCache:true,reloadOnSearch:false,resolve:{miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}},canonicalRef:"/saleListResult"}).when("/saleListResult/auctionId/:auctionId",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],
title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,reloadOnSearch:false,resolve:{miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}},
canonicalRef:"/saleListResult"}).when("/saleListResult/auctionId/:auctionId/:lane",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,reloadOnSearch:false,resolve:{miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,
$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}},canonicalRef:"/saleListResult"}).when("/salesListResult/",{templateUrl:"/salesListResultPage",controller:"salesListController",allowAccess:["ROLE_ANONYMOUS"],title:"Sales List",noCache:true,pageName:"upcomingauction_list",scrollRestore:true,scrollRestoreKey:"salesListResult",titleKey:"app.saleslist.title",
descKey:"app.saleslist.description",activeTab:"findVehicles"}).when("/saleListResult/:yard",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,
searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}}}).when("/saleListResult/inventory/:yardNumber",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",
descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}}}).when("/saleListResultAll/inventory/:yardNumber",{templateUrl:"/saleListResultAll",controller:"saleListController",
allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",noCache:true,resolve:{miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}},scrollRestore:true,scrollRestoreKey:"saleListResultAll"}).when("/location/inventory/:yardNumber",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",
allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,reloadOnSearch:false,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,resolve:{miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,
searchCriteria,$q,$route,$location)}}}).when("/saleListResult/:yard/:auctionDate",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",titleKey:"app.label.saleListResultWithDate.title",descKey:"app.label.saleListResultWithDate.description",arguments:["searchText","auctionDate"],noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,
miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}}}).when("/saleListResult/:yard/:auctionDate/:lane",{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"saleListResult",
titleKey:"app.label.saleListResult.title",descKey:"app.label.saleListResult.description",arguments:["searchText"],noCache:true,reloadOnSearch:false,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}}}).when("/saleListResultAll/auctionId/:auctionId",
{templateUrl:"/saleListResultAll",controller:"saleListController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",noCache:true,resolve:{miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}},scrollRestore:true,scrollRestoreKey:"saleListResultAll"}).when("/saleListResultAll/auctionId/:auctionId/:lane",
{templateUrl:"/saleListResultAll",controller:"saleListController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollRestoreKey:"saleListResultAll",noCache:true,resolve:{miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}}}).when("/saleListResultAll/:yard",{templateUrl:"/saleListResultAll",
controller:"saleListController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}},scrollRestore:true,scrollRestoreKey:"saleListResultAll"}).when("/saleListResultAll/:yard/:auctionDate/",
{templateUrl:"/saleListResultAll",controller:"saleListController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",noCache:true,scrollRestore:true,scrollRestoreKey:"saleListResultAll",resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}}}).when("/saleListResultAll/:yard/:auctionDate/:lane",
{templateUrl:"/saleListResultAll",controller:"saleListController",allowAccess:["ROLE_ANONYMOUS"],title:"Sale List",scrollRestore:true,scrollRestoreKey:"saleListResultAll",noCache:true,resolve:{cldrData:waitForCLDRInitialization.cldrData,miscSearchQuery:function(dataServiceG2,searchCriteriaFactory,$q,$route,$location){var searchCriteria=searchCriteriaFactory.getSearchCriteria(searchCriteriaConstants.lotSearch);return searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location)}}}).when("/paymentHistory/",
{templateUrl:function(){var paymentUrl=appInit.appPlatform=="gbl"?"/fetchDirective.html?directive\x3dpayments/paymentsHistoryGlobal":"/payment-history-view";return paymentUrl},controller:function(){var paymentsHistoryController=appInit.appPlatform=="gbl"?"paymentsHistoryGlobalController":"paymentHistoryController";return paymentsHistoryController}(),scrollRestore:true,scrollOnEvent:true,resolve:{cldrData:waitForCLDRInitialization.cldrData},scrollRestoreKey:"paymentHistory",pageName:"paymenthistory",
activeTab:"payments"}).when("/paymentOptions/",{templateUrl:"/fetchDirective.html?directive\x3dpayments/paymentOptions",controller:"appController",pageName:"payment-options"}).when("/login/",{templateUrl:"/login.html",controller:"loginController",pageName:"signin",redirectAfterLoginUrl:"/dashboard",titleKey:"app.login.title",descKey:"app.login.description"}).when("/logout",{templateUrl:function(){$thisWindow.location.href="/doLogout.html";return null},controller:"appController",pageName:"logout"}).when("/sso/login/",
{templateUrl:"/public/fetchDirective.html?directive\x3dlogin/ssoLogin",controller:"ssoController"}).when("/vehicleFinderDirective/",{templateUrl:"/public/fetchDirective.html?directive\x3dvehicleFinder/vehicleFinderDirective",allowAccess:["ROLE_ANONYMOUS"],pageName:"vehiclefinder",titleKey:"app.vehiclefinder.title",descKey:"app.vehiclefinder.description"}).when("/vehicleFinder/",{templateUrl:"/public/vehicleFinder",controller:"vehicleFinderController",allowAccess:["ROLE_ANONYMOUS"],pageName:"vehiclefinder",
titleKey:"app.vehiclefinder.title",descKey:"app.vehiclefinder.description",activeTab:"findVehicles",caseInsensitiveMatch:true}).when("/lotsWon/",{templateUrl:"/fetchDirective.html?directive\x3dbidStatus/lotswon",controller:"bidStatusLotsWonController",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"lotsWon",noCache:true,pageName:"lotswon",resolve:{cldrData:waitForCLDRInitialization.cldrData},activeTab:"bidStatus"}).when("/lotsLost/",{templateUrl:"/fetchDirective.html?directive\x3dbidStatus/lotslost",
controller:"bidStatusLotsLostController",scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"lotsLost",noCache:true,pageName:"lotslost",activeTab:"bidStatus"}).when("/compareLots/:lotIdList/",{templateUrl:"/public/fetchDirective.html?directive\x3dlotDetail/compareLotSearch_"+appInit.appPlatform,controller:"compareLotsController",allowAccess:["ROLE_ANONYMOUS"],pageName:"comparevehicles"}).when("/lotDetail/:lotId/:showAllPhotos?",{allowAccess:["ROLE_ANONYMOUS"],redirectTo:"/lot/:lotId",titleKey:"app.lotdetails.title",
descKey:"app.lotdetails.description",arguments:["lotDesc","yardName","saleDate"]}).when("/lot/:lotId/Photos/:lotInfo?",{templateUrl:"/public/fetchDirective.html?directive\x3dlotDetail/lotdetails",controller:"lotDetailsController",restoreUrlOnLogin:true,allowAccess:["ROLE_ANONYMOUS"],resolve:{staticLotDetails:function(dataServiceG2,$q,$route,$location){var deferred=$q.defer();var lotId=$route.current.params.lotId;dataServiceG2.getLotDetails(lotId,function(response){deferred.resolve(response.data)});
return deferred.promise},cldrData:waitForCLDRInitialization.cldrData},pageName:"lotdetails",titleKey:"app.lotdetails.title",descKey:"app.lotdetails.description",titleArguments:["lotDesc","yardName","saleDate"],descArguments:["lotDesc","yardName","saleDate"]}).when("/lot/:lotId/:lotInfo?",{templateUrl:"/public/fetchDirective.html?directive\x3dlotDetail/lotdetails",controller:"lotDetailsController",restoreUrlOnLogin:true,allowAccess:["ROLE_ANONYMOUS"],resolve:{staticLotDetails:function(dataServiceG2,
$q,$route,$location){var deferred=$q.defer();var lotId=$route.current.params.lotId;dataServiceG2.getLotDetails(lotId,function(response){deferred.resolve(response.data)});return deferred.promise},cldrData:waitForCLDRInitialization.cldrData},pageName:"lotdetails",titleKey:"app.lotdetails.title",descKey:"app.lotdetails.description",titleArguments:["lotDesc","yardName","saleDate"],descArguments:["lotDesc","yardName","saleDate"]}).when("/manageCounterman/",{templateUrl:"/fetchDirective.html?directive\x3dcounterman/counterman",
controller:"manageCountermanController",pageName:"profile_managecounterman"}).when("/findAPart/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/CounterMan/FindAPart",pageName:"findapart",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/paymentsDue/",{templateUrl:function(){var paymentUrl=appInit.appPlatform=="gbl"?"/fetchDirective.html?directive\x3dpayments/paymentsDue/paymentsDueGlobal":
"/fetchDirective.html?directive\x3dpayments/paymentsDue/paymentsDue";return paymentUrl},controller:function(){var paymentController=appInit.appPlatform=="gbl"?"paymentsDueGlobalController":"paymentsDueController";return paymentController}(),scrollRestore:true,scrollOnEvent:true,scrollRestoreKey:"paymentsDue",resolve:{cldrData:waitForCLDRInitialization.cldrData},blockAccess:["ROLE_BROKER_BIDDER"],altRoute:"/contactBroker",pageName:"paymentsdue",activeTab:"payments"}).when("/makePayment/",{templateUrl:"/fetchDirective.html?directive\x3dpayments/paymentsDue/makePayment",
controller:"makePaymentController",resolve:{cldrData:waitForCLDRInitialization.cldrData},pageName:"makePayment",activeTab:"payments"}).when("/MEAPaymentRedirection/:currencyCode",{templateUrl:function($routeParams){return"/MEAPaymentConfirmation/"+$routeParams.currencyCode+"?responseParameter\x3d"+$routeParams.responseParameter},pageName:"networkOnlineResponse"}).when("/auctionDashboard",{templateUrl:"/public/fetchDirective.html?directive\x3dauction/auctionDashboard",controller:"auctionDashboardController",
pageName:"auctionjoin",titleKey:"app.auctiondashboard.title",descKey:"app.auctiondashboard.description",activeTab:"Auctions"}).when("/auctions/auctionDashboard",{redirectTo:"/auctionDashboard",activeTab:"Auctions"}).when("/invoiceDetails/:invoiceId/:paymentType/:selectedCurrency/",{templateUrl:"/fetchDirective.html?directive\x3dpayments/paymentsDue/invoiceDetails",controller:"invoiceDetailsController",pageName:"invoice"}).when("/invoiceDetails/:invoiceId/:paymentType/:selectedCurrency/:invoiceType/:lotNumber/:secretId/:bidderNumber",
{templateUrl:"./fetchDirective.html?directive\x3dpayments/paymentsDue/invoiceDetails",controller:"invoiceDetailsController",pageName:"invoice"}).when("/paidInvoicesList/:transactionId?/:paymentType?/:paidInvoiceSecretId?",{templateUrl:"/fetchDirective.html?directive\x3dpayments/paymentsDue/paidInvoiceList",controller:"paidInvoiceListController",pageName:"paymentsdue"}).when("/inspectors",{templateUrl:"/public/fetchDirective.html?directive\x3dsupport/services/inspectors",controller:"SupportServicesController",
allowAccess:["ROLE_ANONYMOUS"],title:"Inspectors",pageName:"inspector_services",titleKey:"app.inspectors.title",descKey:"app.inspectors.description",reloadOnSearch:false,activeTab:"services"}).when("/inspectorDetails/:inspectorNumber/",{templateUrl:"/public/fetchDirective.html?directive\x3dsupport/services/inspectorDetails",controller:"InspectorController",allowAccess:["ROLE_ANONYMOUS"],title:"Inspector Details",pageName:"inspectordetails_services"}).when("/brokersmarketmakers/:tab/",{templateUrl:"/public/fetchDirective.html?directive\x3dsupport/services/brokersmarketmakers",
controller:"SupportServicesBrokersController",allowAccess:["ROLE_ANONYMOUS"],pageName:"brokers",titleKey:"app.brokersmarketmakers.title",descKey:"app.brokersmarketmakers.description",activeTab:"services"}).when("/hireabroker/:lotNumber",{templateUrl:"/fetchDirective.html?directive\x3dbroker/hireABroker",controller:"hireABrokerController",allowAccess:["ROLE_ANONYMOUS"],resolve:{staticLotDetails:function(dataServiceG2,$q,$route,$location){var deferred=$q.defer();var lotNumber=$route.current.params.lotNumber;
dataServiceG2.getLotDetails(lotNumber,function(response){deferred.resolve(response.data)});return deferred.promise}},pageName:"hirebroker"}).when("/brokerdetail/:lotNumber/:brokerID",{templateUrl:"/fetchDirective.html?directive\x3dbroker/brokerDetail",controller:"brokerDetailController",allowAccess:["ROLE_ANONYMOUS"],resolve:{staticLotDetails:function(dataServiceG2,$q,$route,$location){var deferred=$q.defer();var lotNumber=$route.current.params.lotNumber;dataServiceG2.getLotDetails(lotNumber,function(response){deferred.resolve(response.data)});
return deferred.promise}},pageName:"broker_detail"}).when("/viewbroker/:brokerNumber/",{templateUrl:"/public/fetchDirective.html?directive\x3dsupport/services/viewbroker",controller:"SupportServicesViewBrokerController",allowAccess:["ROLE_ANONYMOUS"],pageName:"brokers_"}).when("/towproviders/",{templateUrl:"/public/fetchDirective.html?directive\x3dsupport/services/towProviders",controller:"TowProviderContactUsController",allowAccess:["ROLE_ANONYMOUS"],pageName:"towproviders",titleKey:"app.towproviders.title",
descKey:"app.towproviders.description"}).when("/viewmarketmaker/:marketMaker/",{templateUrl:"/public/fetchDirective.html?directive\x3dsupport/services/viewmarketmaker",controller:"SupportServicesViewMarketMakerController",allowAccess:["ROLE_ANONYMOUS"],pageName:"brokers"}).when("/countermanInventory/",{templateUrl:"/fetchDirective.html?directive\x3dcounterman/inventory",controller:"inventoryController",pageName:"counterman-inventory",activeTab:"findVehicles"}).when("/brokerProfile/",{templateUrl:"/fetchDirective.html?directive\x3dbroker/brokerprofile",
controller:"brokerProfileController",pageName:"broker-profile",activeTab:"myAccount"}).when("/countermanInventorySearchResults/",{templateUrl:"/fetchDirective.html?directive\x3dcounterman/inventorySearchResults",controller:"inventorySearchResultsController",pageName:"counterman-inventory-search-results"}).when("/aboutus/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/About-Copart/About-Copart",controller:"cmsController",titleArguments:["title"],
descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/aboutusDir/",{templateUrl:"/public/fetchDirective.html?directive\x3dcms/cmsDirective"}).when("/helpWithLicensing/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Licensing/Index",pageName:"licensing",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support"}).when("/copartreview/",
{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/landing-page/copart-reviews?intcmp\x3dfooter_aboutcopart_copartreviews",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/glossary/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Support/FAQ-Topics/Common-Terms",pageName:"faq_common-terms",controller:"cmsController",
titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/paymentOptions/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/buyer/Payments/Payment-Options",pageName:"paymentoptions",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/sellForDealers/",{templateUrl:"/public/fetchDirective.html?directive\x3dsell/sellForDealers",
controller:"registrationController",pageName:"dealeradvantage",activeTab:"sellAVehicle"}).when("/messagesettings/email-subscriptions/",{templateUrl:"/fetchDirective.html?directive\x3daccountinfo/messagesettings",controller:"emailSubscriptionController",pageName:"message-settings",activeTab:"myAccount"}).when("/messagesettings/text-subscriptions/",{templateUrl:"/fetchDirective.html?directive\x3daccountinfo/messagesettings",controller:"textMessageSubscriptionController",pageName:"message-settings",
activeTab:"myAccount"}).when("/messagesettings/:navMenu/",{templateUrl:"/fetchDirective.html?directive\x3daccountinfo/messagesettings",controller:"MessageSettingsController",pageName:"message-settings",activeTab:"myAccount"}).when("/termsAndConditions/",{templateUrl:"/public/fetchDirective.html?directive\x3dlogin/termsandcondition",controller:"termsAndConditionsController",pageName:"member-terms-and-conditions"}).when("/sellForIndividuals/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+
"/"+appInit.localeString+"/How-To-Sell/For-Individual.html",controller:"SellByIndividualController",resolve:waitForReferenceDataInitialization,pageName:"howtosell_individual",titleKey:"app.sellForIndividual.title",descKey:"app.sellForIndividual.description",activeTab:"sellAVehicle"}).when("/sellForBusiness/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/How-To-Sell/For-Business.html",controller:"SellByBusinessOrDealerController",pageName:"howtosell_business",
titleKey:"app.sellForBusiness.title",descKey:"app.sellForBusiness.description",activeTab:"sellAVehicle"}).when("/BreakerBid4U/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/breakerbid4u",controller:"breakerBid4UController",pageName:"BreakerBid4U",activeTab:"services"}).when("/vehicleDelivery/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/vehicleDelivery",controller:"vehicleDeliveryController"}).when("/sellForDealer/",
{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/How-To-Sell/For-Dealer-Advantage.html",controller:"SellByBusinessOrDealerController",pageName:"dealeradvantage",titleKey:"app.sellForDealer.title",descKey:"app.sellForDealer.description"}).when("/aboutus2/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/about-copart/about-copart-G2",pageName:"about-us",controller:"cmsController",titleArguments:["title"],
descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/overview/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Support/How-to-Buy/Overview",pageName:"htb_overview",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support"}).when("/faq/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+
"/"+appInit.localeString+"/Support/FAQ-Topics/Buying",pageName:"faq_buying",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support"}).when("/cms/pressreleases/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Press-Releases/Index",pageName:"press-release",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",
descKey:"app.content.description"}).when("/howVb3Works/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Support/How-VB3-Works",pageName:"how-vb3-works",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description",activeTab:"support"}).when("/investorrelation/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Investor-Relations/Investor-Relations",
controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/unknown-error",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Landing-Page/Page-Not-Available"}).when("/notfound-error",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Landing-Page/Page-Not-Available"}).when("/copartVideos/",{templateUrl:"/CMS/"+
appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/videos/popular",controller:"copartVideosController",pageName:"videos_copartvideos",titleKey:"app.videos.title",descKey:"app.videos.description",activeTab:"support"}).when("/memberFees/",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Premier-Member-Fees",blockAccess:["ROLE_ANONYMOUS"],altRoute:"/login",activeTab:"myAccount"}).when("/public/memberFees/",{templateUrl:"/CMS/"+
appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Premier-Member-Fees"}).when("/termsofservice",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Terms-of-Service",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/privacypolicy",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+
"/Privacy-Policy",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/termConditionModal",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/Member-Terms-and-Conditions",controller:"cmsController",titleArguments:["title"],descArguments:["description"],titleKey:"app.content.title",descKey:"app.content.description"}).when("/confirmSubscription",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/confirmSubscription",
pageName:"confirmEmailSubscription",controller:"confirmEmailSubscriptionController"}).when("/confirmUnSubscription",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/confirmSubscription",pageName:"confirmEmailSubscription",controller:"confirmEmailSubscriptionController"}).when("/network-response",{templateUrl:"/public/fetchDirective.html?directive\x3duitemp/network-response",controller:"appController"}).when("/ctv",{caseInsensitiveMatch:true,templateUrl:"/CMS/content/us/en/ctv",
controller:"validateTowProviderController"}).when("/member-subscriptions",{templateUrl:"/public/fetchDirective.html?directive\x3dlogin/memberSubscriptions",controller:"accountInfoSubscriptionPreferenceController"}).when("/document-status-pending",{templateUrl:"/public/fetchDirective.html?directive\x3dlogin/documentApprovalPending",controller:"awaitingDocApprovalController"}).when("/help",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/content-search",
controller:"helpController",activeTab:"support",pageName:"help"}).when("/help/results",{templateUrl:"/CMS/"+appInit.localeString+"/Content/"+appInit.regionCode+"/"+appInit.localeString+"/content-search",controller:"helpController",activeTab:"support",pageName:"help/results"}).when("/kiosk/login?",{templateUrl:function($location){if(!_.isUndefined($location.uid))return"/public/member/login?uid\x3d"+$location.uid;else return"/public/member/login"},controller:"loginController",pageName:"signin"}).when("/kiosklotSearchResults",
{templateUrl:"/lotSearchResultsPage",controller:"lotSearchResultsController",allowAccess:["ROLE_ANONYMOUS"],title:"Search Results"}).when("/regstep2",{templateUrl:"/public/fetchDirective.html?directive\x3dregistration/step2",controller:"step2Controller"}).when("/intlShippingSearch",{templateUrl:"/public/fetchDirective.html?directive\x3dtransportation/intlShippingSearch",controller:"intlShippingSearchController",allowAccess:["ROLE_ANONYMOUS"]}).otherwise({templateUrl:"/CMS/"+appInit.localeString+"/Content/"+
appInit.regionCode+"/"+appInit.localeString+"/Landing-Page/Page-Not-Available",controller:function($scope){$scope.message="Stay tuned!!!"},allowAccess:["ROLE_ANONYMOUS"]})});
app.factory("authHttpResponseInterceptor",["$q","$location","$window","$log","copartUser","urlStore","HttpPendingRequestsService","userService",function($q,$location,$window,$log,copartUser,urlStore,HttpPendingRequestsService,userService){return{response:function(response){var contentPath=location.pathname;if(urlStore.protectedUrls.indexOf(contentPath)>-1&&userService.isAnonymous())$location.url("/login?redirectUrl\x3d"+contentPath);return response||$q.when(response)},responseError:function(rejection){if(rejection.status===
401){jQuery(".modal-backdrop").remove();copartUser.config=copartUser.refreshAndGetConfig();HttpPendingRequestsService.cancelAll();$window.location.href=urlStore.login+"?redirectUrl\x3d"+encodeURIComponent($location.url())}else if(rejection.status===403)jQuery("#UnAuthorizedAccessModal").modal("show");else if(rejection.status===460||rejection.status==="460"){HttpPendingRequestsService.cancelAll();$window.location.href="/termsAndConditions"}else if(rejection.status===461||rejection.status=="461"||rejection.status==
469){HttpPendingRequestsService.cancelAll();$window.location.href="/redirectToPaymentGateway/renewal"}else if(rejection.status===462||rejection.status=="462"){HttpPendingRequestsService.cancelAll();$window.location.href="/collect-security-questions"}else if(rejection.status===463||rejection.status=="463"){HttpPendingRequestsService.cancelAll();$window.location.href="/member-subscriptions"}else if(rejection.status===467||rejection.status=="467"){HttpPendingRequestsService.cancelAll();$window.location.href=
"/document-status-pending"}else if(rejection.status===500||rejection.status===503)try{$log.error(rejection.status+" ERROR");console.log(rejection);var url="";if(rejection&&rejection.config&&rejection.config.url){url=rejection.config.url||"";url=url.toLowerCase()}$log.error("Error fetching the source for "+url)}catch(e){console.error(e)}return $q.reject(rejection)}}}]);app.factory("templateInterceptor",["$q",function($q){return{response:function(response){return response||$q.when(response)},responseError:function(rejection){return $q.reject(rejection)}}}]);
var waitForCLDRInitialization={cldrData:function($q){var deferred=$q.defer();if(app.globalizeNumberFormatter)deferred.resolve(app.globalizeNumberFormatter);else app.globalizeNumberFormatterPromise=deferred;return deferred.promise}};var waitForReferenceDataInitialization={referenceData:function(appConfigService,dataServiceG2,$q){var deferred=$q.defer();if(!appConfigService.isLoaded)appConfigService.isLoaded=deferred;else deferred.resolve(appConfigService.isLoaded);return deferred.promise}};
var waitForReferenceDataMoreInitialization={referenceData:function(){return true}};
function searchFunctionForSalelist(dataServiceG2,searchCriteria,$q,$route,$location){var deferred=$q.defer();var saleDateInUrl=$location.search().saleDate;searchCriteria.reset();var miscFilter=searchCriteria.getMiscFilter();if($route.current.params.auctionId)miscFilter.push("auction_id:"+$route.current.params.auctionId);if($route.current.params.yard)miscFilter.push("auction_host_id:"+$route.current.params.yard);if($route.current.params.yardNumber)miscFilter.push("physical_yard_number:"+$route.current.params.yardNumber);
if($route.current.params.lane)miscFilter.push("auction_lane:"+$route.current.params.lane);var auctionId=$location.search().auctionId;if(auctionId)miscFilter.push("auction_assignment_number:"+auctionId);if(saleDateInUrl&&$route.current.params.auctionDate){saleDateInUrl=moment.utc(parseInt(saleDateInUrl));miscFilter.push("auction_date_utc:"+getFullDayRange(saleDateInUrl));if(!$route.current.params.auctionId)miscFilter.push("auction_date_type:F")}else if($route.current.params.auctionDate){var auctionDate=
$route.current.params.auctionDate;miscFilter.push("auction_date_utc:"+getFullDayRange(moment(auctionDate).utc(auctionDate)));if(!auctionId)miscFilter.push("auction_date_type:F")}else if(saleDateInUrl=="Future"){var currentSaleDate=$location.search().recentSale;var nextSaleDate=$location.search().nextSale;var fixedAuctionDate=nextSaleDate?nextSaleDate:currentSaleDate;if(fixedAuctionDate)miscFilter.push("auction_date_utc:"+getFutureRange(moment(fixedAuctionDate).utc(fixedAuctionDate))+"+OR+auction_date_type:E");
else if($route.current.params.from=="/lot")miscFilter.push("auction_date_type:E");else if(!auctionId)miscFilter.push("auction_date_type:F")}searchCriteria.setMiscFilter(miscFilter);deferred.resolve(searchCriteria);return deferred.promise}"use strict";
app.service("copartUtils",["userService",function(userService){var self=this;self.locale={};var log=new Logger({name:"copartUtils"});var vehicleFinderPreference=userService.userConfig.vehicleFinderPreference||{};self.mailTo=function(to,subj,body,signature){var envelope="mailto:"+to+"?Subject\x3d"+subj+"\x26body\x3d"+body;return envelope};self.splitArrayIntoChunks=function(array,size){var results=[];while(array.length)results.push(array.splice(0,size));return results};self.splitIntoArray=function(input,
delimiter,trimspaces){if(input.length>1){delimiter=delimiter==null?",":delimiter;if(typeof delimiter=="undefined"&&delimiter.length<1)delimiter=",";var _eleArray=input.split(delimiter);trimspaces=trimspaces==null||trimspaces===false?false:true;if(trimspaces)for(var i=0;i<_eleArray.length;i++)_eleArray[i]=_eleArray[i].replace(/\s+/g,"");return _eleArray}else console.log("Invalid input to parse")};self.validateFile=function(inputFile,validFormats,sizeLimit){var isValidFormat=false;if(typeof sizeLimit!==
"undefined")if(inputFile.size>sizeLimit)return false;var _fileUploadedExt=inputFile.name.substring(inputFile.name.lastIndexOf(".")+1,inputFile.name.length);for(var i=0;i<validFormats.length;i++)if(_fileUploadedExt.toLowerCase()==validFormats[i].toLowerCase()){isValidFormat=true;break}return isValidFormat};self.getLanguageFromAbbreviation=function(langAbbreviations,locale,delimiter){var languages={};delimiter=delimiter==null?"|":delimiter;var langsAbbrArray=langAbbreviations.split(delimiter);for(var i=
0;i<langsAbbrArray.length;i++)languages[i]=locale.getMessage("app.lang."+langsAbbrArray[i].trim());return languages};self.closeModal=function(id){$("#"+id).modal("hide");$("body").removeClass("modal-open");$(".modal-backdrop").remove()};self.isNumber=function($event){if(isNaN(String.fromCharCode($event.keyCode))){$event.preventDefault();return false}return true};self.clubFacets=function(items,quickPickCode){if(quickPickCode.indexOf("SDAT")>-1){var retArr=[];var momentDateFormat=userService.userConfig.displayPref.dateFormat.toUpperCase();
items=_.chain(items).groupBy(function(item){var utcDate=moment.utc(item.displayName.toUpperCase(),moment.ISO_8601);var date=utcDate.tz(userService.userConfig.selectedTimezone).format(momentDateFormat);item.query="auction_date_utc:"+getFullDayRange(utcDate);item.displayName=date;return date}).mapObject(function(facets,key){var retObj=_.clone(_.first(facets));var counts=_.pluck(facets,"count");var sum=_.reduce(counts,function(memo,num){return memo+num},0);retObj.count=sum;return retObj}).values().value();
return items}else return items};self.appendQueryStringToURL=function appendQueryString(url,queryVars){var firstSeperator=url.indexOf("?")==-1?"?":"\x26";var queryStringParts=new Array;for(var key in queryVars)if(!_.isUndefined(queryVars[key]))queryStringParts.push(key+"\x3d"+queryVars[key]);var queryString=queryStringParts.join("\x26");return url+firstSeperator+queryString};self.isNullOrBlank=function(str){return!!(str||"").match(/^\s*$/)};self.formatCopartDate=function(date){if(date){var year=date.substr(0,
4);var month=date.substr(4,2);var day=date.substr(6,2);return year+"-"+month+"-"+day}return""};self.validateVIN=function(vin){var searchVinLength=vehicleFinderPreference.searchVinLength||17;var regEx=vehicleFinderPreference.regEx||"^[A-HJ-NPR-Z\\d]{8}[\\dX][A-HJ-NPR-Z\\d]{2}\\d{6}$";if(vin.length!==searchVinLength)return false;vin=vin.toUpperCase();var re=new RegExp(regEx);return vin.match(re)};self.getUnFormattedUrl=function(url){url=url||"";if(url.charAt(0)==="."&&url.charAt(1)==="/")return url.substring(1);
else if(url.charAt(0)==="/")return url;else return"/"+url};self.getFormattedUrlForLocale=function(url){url=url||"";if(url.charAt(0)==="."&&url.charAt(1)==="/")return url;else if(url.charAt(0)==="/")return"."+url;else return"./"+url};self.validateIfImage=function(url){url=url||"";return/\.(gif|jpg|jpeg|tiff|png)$/i.test(url)};self.removeTrailingSlash=function(url){url=url||"";try{return url.charAt(url.length-1)==="/"?url.slice(0,url.length-1):url}catch(e){log.error("Error in removeTrailingSlash for "+
url,e)}};self.getSiteRegionCode=function(){return userService.userConfig.siteRegionCode};self.getFormDataForLicenseUpload=function(licenseFiles,params){var formData=new FormData;_.each(licenseFiles,function(licenseFile,index){formData.append("documentServiceInquiryVOS["+index+"].file",licenseFile.file);formData.append("documentServiceInquiryVOS["+index+"].documentCategory",licenseFile.documentCategory);if(file.documentMetaData.documentNumber)formData.append("documentServiceInquiryVOS["+index+"].documentNumber",
licenseFile.documentNumber);if(file.documentMetaData.country)formData.append("documentServiceInquiryVOS["+index+"].documentCountry",licenseFile.country);if(file.documentMetaData.state)formData.append("documentServiceInquiryVOS["+index+"].documentState",licenseFile.state);if(file.documentMetaData.expDate)formData.append("documentServiceInquiryVOS["+index+"].expiryDate",licenseFile.expDate)});formData.append("applicationName",params.applicationName||"G2MBR");formData.append("destination",params.destination||
"CAS");formData.append("fileType",params.fileType||"DOCUMENT");formData.append("documentType",params.documentType||"BUYER_LICENSE");formData.append("objectType",params.objectType||"MEMBER");formData.append("country",self.getSiteRegionCode());return formData};self.bytesToSize=function(bytes,decimalPoint){if(bytes==0)return"0 Bytes";var k=1024,dm=decimalPoint||2,sizes=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(dm))+
" "+sizes[i]};self.isNonSyncedBuyer=function(){return userService.userConfig.isNonSyncedBuyer};self.sanitizePhoneNumber=function(phoneVO){if(phoneVO&&phoneVO.phoneNumber)return phoneVO.phoneNumber.replace(/[^a-zA-Z0-9]+/g,"")};self.setCountryCodeForAddress=function(address){if(_.isEmpty(address))return{};var addressWithCountryCode=angular.copy(address);addressWithCountryCode.country=address.country?address.country.code:"";return addressWithCountryCode};self.updatedConfig=function(data){if(data)return{"selectedLang":data["selectedLang"],
"selectedTimezone":data["selectedTimezone"],"zipToCoordinate":data["zipToCoordinate"]}};self.parseJwt=function(token){if(token){var base64Url=token.split(".")[1];var base64=base64Url.replace(/-/g,"+").replace(/_/g,"/");var jsonPayload=decodeURIComponent(atob(base64).split("").map(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(jsonPayload)}return null};self.mapPhysicalAddress=function(params){var address=new AddressVO;if(params){address.line1=params.addressLine1;
address.line2=params.addressLine2;address.city=params.city;address.state=params.state;address.country=params.country;address.postCode=params.zip1}return address}}]);app.filter("phoneFormatterFilter",function(){return function(value){if(typeof value===undefined);else{var phNum=value+"";phNum=phNum.substring(0,3)+"-"+phNum.substring(3);return phNum}}});
app.service("backToLinkService",function(localStorageService){var self=this;self.backToLink="";self.backToLinkText="";self.setBackToLink=function(backTo){self.backToLink=localStorageService.set("back-to-link-service",backTo)};self.getBackToLink=function(){return localStorageService.get("back-to-link-service")};self.setBackToLinkText=function(backToText){self.backToLinkText=backToText};self.getBackToLinkText=function(){return self.backToLinkText}});
app.service("saveLotNumbersService",function(){var self=this;var lotNumbers=[];self.clearAll=function(){lotNumbers=[]};self.addLotNumber=function(lotNumber){var flag=0;if(!Array.prototype.indexOf)for(var i=0;i<lotNumbers.length;i++){if(lotNumbers[i]===lotNumber)flag=1}else if(lotNumbers.indexOf(lotNumber)!=-1)flag=1;if(!flag)lotNumbers.push(lotNumber)};self.getLotNumber=function(index){return lotNumbers[index]};self.getListLength=function(){return lotNumbers.length};self.getResultIndex=function(lotNumberToAdd){if(lotNumbers.length>
0)return _.findIndex(lotNumbers,function(lotNumber){return lotNumber==lotNumberToAdd});return lotNumbers.length}});
app.service("dataTableConfig",function(){var self=this;var config={dom:'\x3c"top"iflp\x3c"clear"\x3e\x3ert\x3c"bottom"iflp\x3c"clear"\x3e\x3e',pagingType:"full_numbers"};var isMobile=window.matchMedia("screen and (max-width: 479px)").matches;if(isMobile){config.dom='\x3c"top"fp\x3c"clear"\x3e\x3ert\x3c"bottom"lpif\x3c"clear"\x3e\x3e';config.pagingType="full";config.columnDef={"visible":false,"targets":0}}self.getConfig=function(){return config}});
app.service("deviceService",function(){var self=this;var isMobileSize=window.matchMedia("(max-width: 768px)").matches;var isMobileDevice=mobileCheck();self.isMobileSize=function(){return isMobileSize};self.isMobileDevice=function(){return isMobileDevice};self.isMobileSizeOrDevice=function(){return isMobileSize||isMobileDevice}});$.fn.beforeprint=function(callback){return $(this).each(function(){if(!jQuery.isWindow(this))return;if(this.onbeforeprint!==undefined)$(this).on("beforeprint",callback);else if(this.matchMedia)this.matchMedia("print").addListener(callback)})};
$.fn.afterprint=function(callback){return $(this).each(function(){if(!jQuery.isWindow(this))return;if(this.onafterprint!==undefined)$(this).on("afterprint",callback);else if(this.matchMedia)$(this).one("mouseover",callback)})};function getFullDayRange(utcDate){var ret="["+utcDate.startOf("day").format('["]YYYY-MM-DDTHH:mm:ss[Z]["]')+" TO "+utcDate.endOf("day").format('["]YYYY-MM-DDTHH:mm:ss[Z]["]')+"]";return ret}
function getFutureRange(utcDate){var ret="["+utcDate.endOf("day").format('["]YYYY-MM-DDTHH:mm:ss[Z]["]')+" TO *]";return ret}var mobileCheck=function(){var check=false;if(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))check=true;return check};
function validateVin(vin){if(vin.length!==17)return false;vin=vin.toUpperCase();var re=new RegExp("^[A-Z\\d]{11}\\d{6}$");return vin.match(re)}function getNestedProperty(path,obj){return path.split(".").reduce(function(prev,curr){return prev?prev[curr]:undefined},obj||self)}app.service("saleListOnMessageService",function(){var self=this;var msgFunction=function(evt){};self.setMsgFunction=function(func){msgFunction=func};self.onMessage=function(evt){if(msgFunction)msgFunction(evt)}});"use strict";
app.filter("nospace",function(){return function(value){return!value?"":value.replace(/ /g,"")}});app.filter("alphanumeric",function(){return function(value){return!value?"":value.replace(/\W/g,"")}});app.filter("trim",function(){return function(value){if(_.isUndefined(value))return"";if(!angular.isString(value))return value;return value.replace(/^\s+|\s+$/g,"")}});app.filter("addDaysToDate",function(){return function(inputDate,noOfDays,dateFormat){return moment(inputDate).add(noOfDays,"days").format(dateFormat)}});
app.filter("to_trusted",["$sce",function($sce){return function(text){return $sce.trustAsHtml(text)}}]);app.filter("sanitize_html",["$sanitize",function($sanitize){return function(text){var sanitized=$sanitize(text);return _.escape(sanitized)}}]);
app.filter("currency_format",function(){return function(value,scope){var myFormat=app.getControllerScope(scope).ds.getAppConfigValue("culture.amountFormat");if(myFormat){var rawOpts=myFormat.split("#");var opts={aSep:rawOpts[0],aDec:rawOpts[1],dGroup:parseInt(rawOpts[2])};return formatCurrencySlim(Math.floor(value)+"",opts)}else return value;return value}});
app.filter("redact",function(){return function(value,maxLength){try{if(value.length>maxLength)value=value.substring(0,maxLength)+value.substring(maxLength,value.length).replace(/./g,"*")}catch(e){}return value}});app.filter("ellipses",function(){return function(value,maxLength){try{if(value.length>maxLength)value=value.substring(0,maxLength)+"..."}catch(e){}return value}});
app.filter("yes_no_expansion",function(){return function(value,locale){if(locale)if(value==="Y"||value==="y")return locale.messages["app.label.yes"];else{if(value==="N"||value==="n")return locale.messages["app.label.no"]}else if(value==="Y"||value==="y")return"Yes";else if(value==="N"||value==="n")return"No";return value}});
app.filter("yesNoForBoolean",function(){return function(value,locale){if(locale)if(value===true)return locale.messages["app.label.yes"];else{if(value===false)return locale.messages["app.label.no"]}else if(value===true)return"Yes";else if(value===false)return"No";return value}});
app.filter("date_format",function(){return function(value,scope){var myFormat=app.getControllerScope(scope).ds.getAppConfigValue("culture.dateFormat");if(myFormat){var d=new Date(value);if(d.getTimezoneOffset()>0)d.setDate(d.getDate()+1);return d.format(myFormat)}else return value;return value}});app.filter("to_titleCase",function(){return function(value){return value?value.toTitleCase():value}});app.filter("to_lowerCase",function(){return function(value){return value?value.toLowerCase():value}});
app.filter("translateRefData",function(){return function(value,scope){return app.getControllerScope(scope).ds.getRefDataTranslation(value)}});app.filter("arrayContains",function(){return function(array,value){if(!_.isUndefined(array)&&!_.isNull(array))return array.indexOf(value)>-1;else return false}});
app.filter("facetFormat",function(dateFilter,userService,globalize_format_datetimeFilter,capitalizeFilter){return function(input,optional1){var momentDateFormat=userService.userConfig.displayPref.dateFormat.toUpperCase();var output=input;if(optional1=="LOC"||optional1=="SLOC"||optional1=="ENGN")output=input.toUpperCase();else if(optional1=="MAKE")output=capitalizeFilter(input,true);return output}});
app.filter("capitalize",function(){return function(input,all){var reg=all?/([^\W_]+[^\s-]*) */g:/([^\W_]+[^\s-]*)/;return!!input?input.replace(reg,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()}):""}});app.filter("toInteger",function(){return function(value){if(value||value===0)return parseInt(value);return null}});
app.filter("formatDateWithTimeZone",["userService",function(userService){return function(value){if(value){var date=moment(value).toISOString;date=moment.utc(date).tz(userService.userConfig.selectedTimezone).format(date);date=moment.utc(date).tz(userService.userConfig.selectedTimezone).format("MM/DD/YYYY hh:mm A zz");return date}else return null}}]);
app.filter("formatUTCDateWithTimeZone",["userService",function(userService){return function(value){if(value){var dateTimeFormat=userService.userConfig.displayPref.dateFormat.toUpperCase()+" "+userService.userConfig.displayPref.timeFormat+" zz";var date=moment.utc(value).tz(userService.userConfig.selectedTimezone).format(dateTimeFormat);return date}else return null}}]);app.filter("globalize_number",function(){return function(value){if(value||value===0)return app.globalizeNumberFormatter(value);return""}});
var parseAmount=function(value,decimalLimit){if(value||value===0){if(decimalLimit==0)value=parseInt(value);else value=parseFloat(value);return value}return null};
app.filter("globalize_currency",function(){return function(value,code,decimalLimit){if(decimalLimit===undefined||decimalLimit==null)decimalLimit=0;var amount=parseAmount(value,decimalLimit);if(amount!=null&&amount!=undefined)if(code){code=code.trim();return Globalize.currencyFormatter(code,{maximumFractionDigits:decimalLimit})(amount)}else return amount;return""}});
app.filter("globalize_currency_using_code",["userService",function(userService){return function(value,code,decimalLimit){if(decimalLimit===undefined||decimalLimit==null)decimalLimit=0;var amount=parseAmount(value,decimalLimit);if(!_.isNaN(amount)&&amount!=null)if(code){code=code.trim();var formattedCurrency=Globalize.currencyFormatter(code,{maximumFractionDigits:decimalLimit})(amount);return appInit.appPlatform==="gbl"?formattedCurrency:formattedCurrency+" "+code}else return amount;return value?value:
""}}]);
app.filter("odometer_reading_display",["userService",function(userService){return function(odometerReading,odometerBranding,odometerUnit){var showBrandingFlag=userService.userConfig.defaultDisplayPref.odometerBrandDisplayPreference;var formattedValue;if(odometerReading||odometerReading==0)formattedValue=app.globalizeNumberFormatter(odometerReading);if(showBrandingFlag!=null&&showBrandingFlag==false&&odometerReading==0)return"";else if(showBrandingFlag!=null&&showBrandingFlag==false&&odometerReading>0){odometerUnit=
odometerUnit!==undefined?odometerUnit:"";return formattedValue+" "+odometerUnit}else return formattedValue+" "+odometerBranding}}]);app.filter("globalize_currency_prepend_code",["userService",function(userService){return function(value,code){if(value&&code)return code+" "+Globalize.currencyFormatter(code,{maximumFractionDigits:0})(value);return null}}]);
app.filter("globalize_currency_symbol",function(){return function(code){try{return code?Globalize.getCurencySymbol(code):null}catch(e){log.error("Exception while loading currency symbol from globalize",e)}}});app.filter("globalize_currency_exclude_symbol",function(){return function(value,code){try{value=parseInt(value);if(!_.isNaN(value)&&code)return app.globalizeNumberFormatter(parseInt(value))+" "+code.trim();return value?value:""}catch(e){log.error("Exception while loading globalize library",e)}}});
app.filter("globalize_format_date",["userService",function(userService){return function(UTCEpochTime,format){if(UTCEpochTime&&format){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);return Globalize.dateFormatter({date:format})(utcDate.toDate())}return null}}]);
app.filter("globalize_format_time",["userService",function(userService){return function(UTCEpochTime,format){if(UTCEpochTime&&format){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);return Globalize.dateFormatter({time:format})(utcDate.toDate())}return null}}]);
app.filter("globalize_format_datetime",["userService",function(userService){return function(UTCEpochTime,format){if(UTCEpochTime&&format){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);return Globalize.dateFormatter({datetime:format})(utcDate.toDate())}return null}}]);
app.filter("globalize_format_date_custom",["userService",function(userService){return function(UTCEpochTime,format){if(UTCEpochTime&&format){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);return Globalize.dateFormatter({skeleton:format})(utcDate.toDate())}return null}}]);
app.filter("globalize_parse_date",function(){return function(value,format){if(value)if(format)return Globalize.dateParser({skeleton:format})(value);else return Globalize.dateParser()(value);return null}});app.filter("globalize_length_unit_format",function(){return function(value,country){if(value||value==0)if(country&&country!="")return Globalize.unitFormatter("length-"+country.toLowerCase(),{form:"short"})(value);else return Globalize.unitFormatter("length-mile",{form:"short"})(value);return null}});
app.filter("format_intl_phone_number",["userService",function(userService){var regionToPhoneMap={"US":"US","UK":"GB","DE":"DE","ES":"ES","IN":"IN","CPRTCA":"CA","CPRTMEA":"AE"};return function(value,country,format){country=regionToPhoneMap[userService.userConfig.siteCode.toUpperCase()]||regionToPhoneMap[userService.userConfig.siteRegionCode.toUpperCase()];if(value&&country){$.fn["intlTelInput"].loadUtils("/js/lib/intlTelInput/utils.js");return intlTelInputUtils.formatNumber(value,country,format)}return value}}]);
app.filter("format_date",["userService",function(userService){return function(dateString,format){format=format||userService.userConfig.displayPref.dateFormat.toUpperCase();if(dateString&&format){if(dateString<=0)return"";var date=moment(dateString,"YYYYMMDD");return date.format(format)}return null}}]);app.filter("format_telephone",[function(){return function(value){if(value){value=value.toString();if(value.length==10)return"("+value.substr(0,3)+") "+value.substr(3,3)+" "+value.substring(6);else return value}else return null}}]);
app.filter("unique",function(){return function(arr,field){return _.uniq(arr,function(a){return a[field]})}});app.filter("convertTimeTo12Hour",["userService",function(userService){return function(value){var timeFormat=userService.userConfig.timeFormat;if(value){var split=value.split(" ");var open=split[0];var to=split[1];var close=split[2];open=moment(open,["HH:mm"]).format(timeFormat);close=moment(close,["HH:mm"]).format(timeFormat);return open+" "+to+" "+close+" "}else return null}}]);
app.filter("convert24hrsTo12hrs",function(){return function(hrs){if(hrs){hrs=paddy(hrs,4);hrs=moment(hrs,["HHmm"]).format("hh:mm A");return hrs}else return null}});app.filter("titleGroupFilter",function(){return function(value){if(value){value=value.split("_");return value[1]}else return null}});function paddy(n,p,c){var pad_char=typeof c!=="undefined"?c:"0";var pad=(new Array(1+p)).join(pad_char);return(pad+n).slice(-pad.length)}
var refCodeLookupMap={EBD:"EVERY BUSINESS DAY ",MSD:"MULTIPLE SALE DAYS PER WEEK",FRI:"Friday",MON:"Monday",SAT:"Saturday",SUN:"Sunday",THR:"Thursday",TUE:"Tuesday",WED:"Wednesday",BFR:"BIWEEKLY FRIDAY",BMO:"BIWEEKLY MONDAY",BSN:"BIWEEKLY SUNDAY",BST:"BIWEEKLY SATURDAY",BTH:"BIWEEKLY THURSDAY",BTU:"BIWEEKLY TUESDAY",BWD:"BIWEEKLY WEDNESDAY",MNT:"MONTHLY"};app.filter("refCodeToText",function(){return function(code){return refCodeLookupMap[code]?refCodeLookupMap[code]:code}});
app.filter("preferencesFilter",function(copartUser){return function(input,prefCode){var result=[];if(!Array.isArray(input))return result;angular.forEach(input,function(value){if(copartUser.hasAccessSitePref(prefCode,value))result.push(value)});return result}});app.filter("phoneNum_format",function(){return(new NumberFormatterUtils).formatPhoneNumber});
app.filter("format_datetime_by_pref",["userService",function(userService){return function(UTCEpochTime){if(UTCEpochTime){var utcDate=moment.utc(UTCEpochTime);utcDate.tz(userService.userConfig.selectedTimezone);var dateTimeFormat=userService.userConfig.dateFormat+" "+userService.userConfig.timeFormat;return utcDate.format(dateTimeFormat)}return null}}]);
app.filter("redactFilter",["userService",function(userService){return function(input,prefType,replaceWith){if(input===undefined||input==null)return"";if(userService.userConfig.defaultDisplayPref[prefType]==null)return input.trim();var limit=userService.userConfig.defaultDisplayPref[prefType];var formattedValue=input.trim();if(limit!=null&&input.toString().length>limit)if(replaceWith)formattedValue=formattedValue.substring(0,limit)+formattedValue.substring(limit,formattedValue.length).replace(/./g,
replaceWith);else formattedValue=formattedValue.substring(0,limit);return formattedValue}}]);app.filter("searchTextDisplayFilter",function(){return function(searchText){var displayText=searchText||"";if(searchText.trim().toUpperCase()==="FARMERS")displayText="Farmers";return displayText}});app.filter("saleNameFilter",function(){return function(name,isVirtual){if(isVirtual&&isVirtual=="Y"&&!name.startsWith("*"))name="*"+name;return name}});
app.filter("formatVin",function(){return function(vinText,k){if(_.isUndefined(vinText))return"";return vinText.trim().length<k?vinText.trim():vinText.trim().substring(0,k)+(new Array(vinText.trim().length-k+1)).join("*")}});app.filter("sanitizeUrl",function(){return function(urlName){if(urlName)urlName=urlName.replace(/\/$/,"");return urlName}});app.filter("isValidDate",function(){return function(inputDate){if(!inputDate)return false;var date=new Date(inputDate);return angular.isDate(date)}});
app.filter("countryDesc",["appConfigService",function(appConfigService){return function(countryCode){if(!countryCode)return"";var countries=appConfigService.getAppConfig().countries||{};var countryObj=_.find(countries,{code:countryCode})||{};return countryObj.description||""}}]);app.filter("convertMiscellaneousText",function(){return function(value,locale){if(value==="Miscellaneous Invoices")value=locale.messages["payments.misc.invoice"];return value}});"use strict";
function AccountInfo(params){ModelBase(this);var self=this;if(params==null)params={};self.email=params.email;self.oldPassword=params.oldPassword;self.password=params.password;self.confirmPassword=params.confirmPassword;self.dealerID=params.dealerID}"use strict";
function FinanceVO(params){ModelBase(this);var self=this;if(params==null)params={};self.providerCode=params.providerCode;self.providerLocation=params.providerLocation;self.contactPhoneAreaCode=params.contactPhoneAreaCode;self.contactPhoneNumber=params.contactPhoneNumber;self.providerPhoneExt=params.providerPhoneExt;self.verifyAccount=params.verifyAccount;self.accountStatusCode=params.accountStatusCode;self.accountStatus=params.accountStatus;self.dealerID=params.dealerID;self.providerURL=params.providerURL;
self.availableCredit=params.availableCredit}"use strict";
function QuickPicks(params,pageId){var constants={VEHICLE_MAKES:"MAKE",FEATURED_ITEMS:"FETI",VEHICLE_TYPES:"VEHT",CATEGORY:"ABI"};var self=this;var columnize=function(arr,size){var newArr=[];for(var i=0;arr&&i<arr.length;i+=size)newArr.push(arr.slice(i,i+size));return newArr};self.updateList=function(params){self.makes=columnize(params.Makes,7);self.vehicleTypes=columnize(params[constants.VEHICLE_TYPES],5);self.categories=columnize(params[constants.FEATURED_ITEMS],7);self.category=params[constants.CATEGORY]};
self.updateVehicleFinderList=function(params){for(var title in params)params[title]=columnize(params[title],4);self.paramMap=params};if(params==null)self.paramMap={};else{self.quickPicksByUri={};self.displayNameByUri={};self.categoryNameByUri={};for(var title in params)for(var item in params[title]){self.quickPicksByUri[params[title][item].uri]=params[title][item].searchQuery;self.displayNameByUri[params[title][item].uri]=params[title][item].itemName;self.categoryNameByUri[params[title][item].uri]=
title}if(pageId==="HOME")self.updateList(params);else self.updateVehicleFinderList(params)}}"use strict";var ModelBase=function(view){var self=view;self.errors={};self.addError=function(key,message){if(!self.errors)self.errors={};self.errors[key]=message};self.hasErrors=function(){return self.errors&&Object.keys(self.errors).length>0?true:false};self.validate=function(){return true}};"use strict";
app.service("appConfigService",["$q","dataServiceG2","$filter","$http",function($q,dataServiceG2,$filter,$http){var self=this;self.appConfig=new AppConfig(dataServiceG2,$filter);self.isLoaded=null;self.appConfig.update(referenceDataLess);if(self.isLoaded!=null&&typeof self.isLoaded!==undefined&&typeof self.isLoaded!=="boolean")self.isLoaded.resolve(true);else self.isLoaded=true;self.getAppConfig=function(){return self.appConfig};self.setEnvConfigProps=function(envConfigProps){self.envConfigProps=
envConfigProps;self.appConfig.evnConfigProperties=envConfigProps};self.getEnvConfigProps=function(){return self.envConfigProps};self.getLocationsListBySite=function(callBack){if(self.appConfig.yardLocations==null)$http.get("/public/data/locations/retrieveLocationsListBySite").success(function(response){self.appConfig.yardLocations=response;if(callBack)callBack(response)}).error(function(response){log.error("Error returned"+response)});else if(callBack)callBack(self.appConfig.yardLocations)};var filterList=
function(list,filterObj){return _.where(list,filterObj)};var distinctList=function(list,property){return _.uniq(_.filter(list,function(value){return value[property]!=""}),function(x){return x[property]})};var getVehTypeFilterObj=function(vehicleType,filterByVehType){var vehTypeObj={};if(filterByVehType){vehTypeObj={type:vehicleType.code};if(vehicleType.category)vehTypeObj.category=vehicleType.category}return vehTypeObj};self.getVehicleMakes=function(vehicleType,filterByVehType){if(!vehicleType)return;
var filteredList=filterList(self.appConfig.vehicleMakes,getVehTypeFilterObj(vehicleType,filterByVehType));return distinctList(filteredList,"code")};self.getVehicleModels=function(vehicleType,vehicleMake,filterByVehType){if(!vehicleMake||!vehicleType)return;var filterObj=getVehTypeFilterObj(vehicleType,filterByVehType);filterObj.group=vehicleMake.code;var filteredList=filterList(self.appConfig.vehicleMakeandModels,filterObj);return distinctList(filteredList,"description")};self.distinctDocCategories=
function(){var uniqueCategories=_.uniq(_.filter(self.appConfig.getDocumentCategories(),function(documentCategory){return documentCategory.documentCategoryCode!="UNKWN"}),"documentCategoryCode");var objIndex=_.findIndex(uniqueCategories,function(category){return category.documentCategoryCode=="MISC"});var removeOtherCategoryObject;if(objIndex>-1)removeOtherCategoryObject=uniqueCategories.splice(objIndex,1);uniqueCategories=_.sortBy(uniqueCategories,function(documentCategory){return documentCategory.documentCategoryName});
if(removeOtherCategoryObject&&removeOtherCategoryObject[0])uniqueCategories.push(removeOtherCategoryObject[0]);return uniqueCategories}}]);
function AppConfig(dataServiceG2,$filter){ModelBase(this);var self=this;self.defaultMemberChoices={};var loadDynamicReferenceData=function(methodName,fieldName,filter,callback){if(!callback)return;if(self[fieldName]&&self[fieldName][filter])callback(self[fieldName][filter]);else dataServiceG2[methodName](filter,function(response){if(response.returnCode==1){if(!self[fieldName])self[fieldName]={};self[fieldName][filter]=response.data[fieldName];callback(response.data[fieldName])}})};self.vehicleModels=
function(make,callback){loadDynamicReferenceData("getVehicleModels","vehicleMakeandModels",make,callback)};self.getVehicleMakes=function(vehicleType,callback){loadDynamicReferenceData("getVehicleMakes","vehicleMakes",vehicleType,callback)};self.getStatesOfCountry=function(country,callback){loadDynamicReferenceData("getStates","statesOfCountry",country,callback)};self.update=function(params){if(params==null)return;if(params.vehicleTypes)self.vehicleTypes=params.vehicleTypes;if(params.percentageMaximums)self.percentageMaximums=
params.percentageMaximums;if(params.vehicleMakeandModels)self.vehicleMakeandModels=params.vehicleMakeandModels;if(params.searchYears)self.searchYears=params.searchYears;if(params.vehicleMakes)self.vehicleMakes=params.vehicleMakes;if(params.countries)self.countries=params.countries;if(params.states)self.states=params.states;if(params.colors)self.colors=params.colors;self.categories=params.vehicleCategories;if(params.zipMiles)self.zipMiles=params.zipMiles;if(params.languages)self.languages=params.languages;
if(params.defaultLotResultsFields)self.defaultLotResultsFields=params.defaultLotResultsFields;if(params.securityQuestions)self.securityQuestions=_.chain(params.securityQuestions).map(function(value1,key1){return{questionId:value1.code,questionDesc:value1.description}}).value();if(params.countryStates)self.countryStates=params.countryStates;if(params.shippingServices)self.shippingServices=params.shippingServices;if(params.bidIncrements)self.bidIncrements=params.bidIncrements;if(params.highlightIcons)self.highlightIcons=
params.highlightIcons;if(params.validHighlightIcons)self.validHighlightIcons=params.validHighlightIcons;if(params.ccMaxLimit)self.ccMaxLimit=params.ccMaxLimit;if(params.titleLongDescription)self.titleLongDescription=params.titleLongDescription;if(params.yardLocations){self.yardLocations=params.yardLocations;self.yardsMap=_.indexBy(params.yardLocations,"yardNumber")}if(params.yards)self.yards=params.yards;if(params.defaultMemberChoices)self.defaultMemberChoices=params.defaultMemberChoices};self.getDefaultMemberChoices=
function(){return self.defaultMemberChoices};self.refData={HIGHLIGHTICONS:"highlightIcons",COUNTRIES:"countries",YARDS:"yards",TITLELONGDESCRIPTION:"titleLongDescription",CCMAXKIMIT:"ccMaxLimit",BIDINCREMENTS:"bidIncrements",SHIPPINGSERVICES:"shippingServices",COUNTRYSTATES:"countryStates",SECURITYQUESTATIONS:"securityQuestions",LANGUAGES:"languages",COLORS:"colors",REGISTRATIONSOURCE:"registrationSource",DOCUMENTCATEGORIES:"documentCategories",PRODUCTSITES:"productSites",PAYMENTMETHODS:"paymentMethods",
SUBSCRIPTIONPREFERENCES:"availableSubscriptionPreferences"};self.getHighlightIcons=function(){return self.loadReferenceDataByObject(self.refData.HIGHLIGHTICONS)};self.getYards=function(){return self.loadReferenceDataByObject(self.refData.YARDS)};self.getTitleLongDescription=function(){return self.loadReferenceDataByObject(self.refData.TITLELONGDESCRIPTION)};self.getCcMaxLimit=function(){return self.loadReferenceDataByObject(self.refData.CCMAXKIMIT)};self.getBidIncrements=function(){return self.loadReferenceDataByObject(self.refData.BIDINCREMENTS)};
self.getShippingServices=function(){return self.loadReferenceDataByObject(self.refData.SHIPPINGSERVICES)};self.getCountryStates=function(){return self.loadReferenceDataByObject(self.refData.COUNTRYSTATES)};self.getSecurityQuestions=function(){return self.loadReferenceDataByObject(self.refData.SECURITYQUESTATIONS)};self.getLanguages=function(){return self.loadReferenceDataByObject(self.refData.LANGUAGES)};self.getColors=function(){return self.loadReferenceDataByObject(self.refData.COLORS)};self.getRegistrationSource=
function(){return self.loadReferenceDataByObject(self.refData.REGISTRATIONSOURCE)};self.getDocumentCategories=function(){return self.loadReferenceDataByObject(self.refData.DOCUMENTCATEGORIES)};self.getProductSites=function(){return self.loadReferenceDataByObject(self.refData.PRODUCTSITES)};self.getPaymentMethods=function(){return self.loadReferenceDataByObject(self.refData.PAYMENTMETHODS)};self.getSubscriptionPreferences=function(){return self.loadReferenceDataByObject(self.refData.SUBSCRIPTIONPREFERENCES)};
self.loadReferenceDataByObject=function(object){if(self[object])return self[object];var result;$.ajax({type:"GET",url:"/public/data/referenceDataByObject/"+object,success:function(response){result=response},error:function(){},async:false});if(object==self.refData.SECURITYQUESTATIONS)result=_.chain(result).map(function(value1,key1){return{questionId:value1.code,questionDesc:value1.description}}).value();self[object]=result;return result};self.immutableCountriesList=[];self.prepareCountriesList=function(){var preferredCountryCodes=
["USA","CAN"];var countriesRefData=self.loadReferenceDataByObject(self.refData.COUNTRIES);var preferredCountryObjs=[];var excludedCountryObjs=[];_.each(countriesRefData,function(countryRefObj){var priorityCountryIndex=preferredCountryCodes.indexOf(countryRefObj.code);if(priorityCountryIndex>-1){var tempCountryRefObj=_.clone(countryRefObj);tempCountryRefObj.priorityIndex=priorityCountryIndex;preferredCountryObjs.push(tempCountryRefObj)}excludedCountryObjs.push(countryRefObj)});excludedCountryObjs=
_.sortBy(excludedCountryObjs,"description");preferredCountryObjs=_.sortBy(preferredCountryObjs,"priorityIndex");var finalList=[];finalList=finalList.concat(preferredCountryObjs);finalList.push({code:"ignore",description:"---------"});finalList=finalList.concat(excludedCountryObjs);return finalList};self.getCountries=function(){if(self.immutableCountriesList&&self.immutableCountriesList.length===0)self.immutableCountriesList=self.prepareCountriesList();return self.immutableCountriesList}}"use strict";
function EnvConfigProps(params){ModelBase(this);if(params==null)params={};return params}var submitForm=function(action,form){var hash=decodeURIComponent(self.document.location.hash);if(hash&&hash.indexOf("#")===-1)hash="#"+hash;form.action=action+hash;return true};
function emailPassword(){jQuery("#statusMsg").hide();var email_address=jQuery("#email").val();if(!email_address||!validateEmail(email_address)){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.invalidEmail).show();return}jQuery.ajax({url:"rest/public/data/seller/emailPassword/"+email_address+"/",data:{},type:"GET",cache:false,dataType:"json",success:function(json,status,xhr){if(json.returnCode==-1)jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(json.returnCodeDesc).show();
else jQuery("#statusMsg").addClass("alert-success").removeClass("alert-danger").html(message.passwordConfirmation+" "+email_address).show()},error:function(xhtml,status,xhr){alert(" error: "+status+xhr+xhtml)}})}
function updatePassword(){jQuery("#statusMsg").hide();var email_address=jQuery("#email").val();if(!email_address||!validateEmail(email_address)){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.invalidEmail).show();return}var password=jQuery("#password").val();var cnfrmPassword=jQuery("#confirmPassword").val();if(!password){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.passwordEmpty).show();jQuery("#password").focus();
return}if(!cnfrmPassword){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.passwordEmpty).show();jQuery("#confirmPassword").focus();return}if(password.length<8||password.length>12){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.invalidPasswordLength).show();jQuery("#password").focus();return}if(cnfrmPassword.length<8||cnfrmPassword.length>12){jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(message.invalidPasswordLength).show();
jQuery("#confirmPassword").focus();return}jQuery.ajax({url:"rest/public/data/seller/accountInformation/createPassword",data:{"email":email_address,"password":password,"confirmPassword":cnfrmPassword},type:"POST",cache:false,dataType:"json",success:function(json,status,xhr){if(json.returnCode==-1)jQuery("#statusMsg").addClass("alert-danger").removeClass("alert-success").html(json.returnCodeDesc).show();else location.href="memberhome.html"},error:function(xhtml,status,xhr){alert(" error: "+status+xhr+
xhtml)}})}function validateEmail(email){var emailReg=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(!emailReg.test(email))return false;else return true}
function show(){var account=document.getElementById("opt").value;console.log("from",account);if(account==0){document.getElementById("sel_access").style.display="none";document.getElementById("show").style.display="block"}if(account==1){document.getElementById("sel_access").style.display="block";document.getElementById("show").style.display="none"}if(account==2){document.getElementById("sel_access").style.display="none";document.getElementById("show").style.display="block"}}
function showAccountType(account){if(account==0){document.getElementById("sel_access").style.display="none";document.getElementById("show").style.display="block";document.getElementById("opt").value=account}if(account==1){document.getElementById("sel_access").style.display="block";document.getElementById("show").style.display="none";document.getElementById("opt").value=account}if(account==2){document.getElementById("sel_access").style.display="none";document.getElementById("show").style.display="block";
document.getElementById("opt").value=account}}
$(document).ready(function(){$(".tab-wrapper li:first").addClass("active");$(".tab-body \x3e div").hide();$(".tab-body \x3e div:first").show();$(".menu-content li").on("click",function(e){e.preventDefault();var shData=$(this).find("a").attr("href");console.log("this",shData,$(".account_table").find(shData));$(".tab-body \x3e div:visible").hide();$(".account_table").find(shData).show();if(shData=="#tab5"||shData=="#tab6")$("#member_div").hide();else $("#member_div").show();if($(window).width()<=767)$(".main_navtoggle").click()});
$(".print").show();$(".mail").hide();$(".menu_license").click(function(){$(".print").show();$(".mail").hide()});$(".menu_change").click(function(){$(".print, .mail").hide()});$(".menu_info").click(function(){$("#member_div").show()});$(".menu_forms").click(function(){$(".print").show();$(".mail").hide()});$(".menu_finance").click(function(){$(".print,.mail").show()});$(".menu_contact, .menu_preferences").click(function(){$(".print").show();$(".mail").hide()});$(".edit_table").hide();$(".edit_contactinfo").click(function(){$(".edit_table").show();
$(".editcontact_table").hide()});$(".edit_mypreferences").hide();$(".edit_preferences").click(function(){$(".edit_mypreferences").show();$(".edit_mypreferencesinfo").hide();$(".mainedit_preferences").css({"border":"1px solid #dedede"})});$("li:first").removeClass("active");$(".tab-wrapper li").removeClass("active");$(this).parent().addClass("active")});"use strict";
function VehicleFinderQuickPicks(params){var self=this;if(params==null)params={};var columnize=function(arr,size){var newArr=[];for(var i=0;i<arr.length;i+=size)newArr.push(arr.slice(i,i+size));return newArr};self.updateVehicleFinderList=function(params){for(var title in params)params[title]=columnize(params[title],4);self.paramMap=params}}"use strict";
function VehicleAlertVO(params){ModelBase(this);var self=this;if(params==null)params={};if(params.typeOfVehicleObj&&params.typeOfVehicleObj.code)self.typeOfVehicle=params.typeOfVehicleObj.code;else self.typeOfVehicle=params.typeOfVehicle;if(params.makeOfVehicleObj&&params.makeOfVehicleObj.code)self.makeOfVehicle=params.makeOfVehicleObj.code;else self.makeOfVehicle=params.makeOfVehicle;if(params.modelOfVehicleObj&&params.modelOfVehicleObj.description)self.modelOfVehicle=params.modelOfVehicleObj.description;
else self.modelOfVehicle=params.modelOfVehicle;self.frequency=params.frequency;self.firstName=params.firstName;self.lastName=params.lastName;self.email=params.email;self.yearFrom=params.yearFrom;self.yearTo=params.yearTo;self.mobileNum=params.mobileNum;self.alertType=params.alertType;self.gdprConcent=params.gdprConcent}
app.factory("vehicleFactory",function(){var vehicleFactory={};vehicleFactory.getModels=function(appConfig,vehicleMake){var models=[];appConfig.vehicleModels(vehicleMake,function(models){models=models});return models};return vehicleFactory});"use strict";
function RegistrationVO(params){ModelBase(this);var self=this;if(params==null)params={};self.firstName=params.firstName;self.lastName=params.lastName;self.email=params.email;self.confirmEmail=params.confirmEmail;self.companyName=params.companyName;self.address=params.address;self.addressLine2=params.addressLine2;self.country=params.country;self.StateOrProvince=params.StateOrProvince;self.city=params.city;self.ZipOrPostalCode=params.ZipOrPostalCode;self.phoneNumber=params.phoneNumber;self.phoneExtension=
params.phoneExtension}var smallDomain=window.location.host.toLowerCase();var rsid="";if(smallDomain.indexOf("copart")>-1)rsid="copart-g2-us-qa";else if(smallDomain.indexOf("crashedtoys")>-1)rsid="copart-crashedtoys-g2-qa";
if(smallDomain.indexOf("ww2.copart.com")>-1||smallDomain.indexOf("www.copart.com")>-1)rsid="copart-g2-us-prod";else if(smallDomain.indexOf("www.crashedtoys.com")>-1||smallDomain.indexOf("g2-member-stg1.crashedtoys.com")>-1)rsid="copart-crashedtoys-g2-prod";else if(smallDomain.indexOf("g2-member-qa4.copart.com")>-1||smallDomain.indexOf("g2-member-qa2.copart.com")>-1)rsid="copart-g2-us-qa";else if(smallDomain.indexOf("g2-member-qa4.crashedtoys.com")>-1||smallDomain.indexOf("g2-member-qa2.crashedtoys.com")>
-1)rsid="copart-crashedtoys-g2-qa";else if(smallDomain.indexOf("ww2.copart.ca")>-1||smallDomain.indexOf("www.copart.ca")>-1)rsid="copart-canada-g2-prod";else if(smallDomain.indexOf("g2-member-qa4.copart.ca")>-1||smallDomain.indexOf("g2-member-qa2.copart.ca")>-1)rsid="copart-canada-g2-qa";else if(smallDomain.indexOf("ww2.copart.co.uk")>-1||smallDomain.indexOf("www.copart.co.uk")>-1)rsid="copart-g2-uk-prod";else if(smallDomain.indexOf("g2-member-qa4.copart.co.uk")>-1||smallDomain.indexOf("g2-member-qa2.copart.co.uk")>
-1)rsid="copart-g2-uk-qa";else if(smallDomain.indexOf("g2-member-qa4.copart.ie")>-1||smallDomain.indexOf("g2-member-qa2.copart.ie")>-1)rsid=" copart-g2-Ireland-QA";else if(smallDomain.indexOf("g2-member-qa4.copartmea.com")>-1||smallDomain.indexOf("g2-member-qa2.copartmea.com")>-1)rsid=" copart-g2-middleeast-qa";else if(smallDomain.indexOf("ww2.copart.ie")>-1||smallDomain.indexOf("www.copart.ie")>-1)rsid="copart-g2-Ireland-Prod";else if(smallDomain.indexOf("ww2.copartmea.com")>-1||smallDomain.indexOf("www.copartmea.com")>
-1)rsid="copart-g2-middleeast-prod";else if(smallDomain.indexOf("www.copart.de")>-1)rsid="copart-g2-member-germany-prod";else if(smallDomain.indexOf("www.copart.es")>-1)rsid="copart-g2-member-spain-prod";else if(smallDomain.indexOf("www.copart.fi")>-1)rsid="copart-g2-Finland-Prod";else if(smallDomain.indexOf("g2-member-qa6.copart.de")>-1||smallDomain.indexOf("g2-member-qa5.copart.de")>-1||smallDomain.indexOf("g2-member-qa4.copart.de")>-1||smallDomain.indexOf("g2-member-stg1.copart.de")>-1)rsid="copart-g2-member-germany-qa";
else if(smallDomain.indexOf("g2-member-qa6.copart.es")>-1||smallDomain.indexOf("g2-member-qa5.copart.es")>-1||smallDomain.indexOf("g2-member-qa4.copart.es")>-1||smallDomain.indexOf("g2-member-stg1.copart.es")>-1)rsid="copart-g2-member-spain-qa";else if(smallDomain.indexOf("g2-member-dev6.copart.fi")>-1||smallDomain.indexOf("g2-member-qa6.copart.fi")>-1||smallDomain.indexOf("g2-member-qa5.copart.fi")>-1||smallDomain.indexOf("g2-member-qa4.copart.fi")>-1||smallDomain.indexOf("g2-member-stg1.copart.fi")>
-1)rsid="copart-g2-Finland-Qa";else if(smallDomain.indexOf("www.driveautoauctions.com")>-1)rsid="copart-g2-driveautoauctions-us-prod";else if(smallDomain.indexOf("g2-member-qa4.driveautoauctions.com")>-1||smallDomain.indexOf("g2-member-dev4.driveautoauctions.com")>-1)rsid="copart-g2-driveautoauctions-us-qa";if(appInit.rsid)rsid=appInit.rsid;var s_account=rsid;var s=s_gi(s_account);s.fpCookieDomainPeriods="2";var d=window.location.hostname;if(d.indexOf(".co.uk")>-1)s.fpCookieDomainPeriods="3";
s.trackDownloadLinks=true;s.trackExternalLinks=true;s.trackInlineStats=true;s.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx";s.linkLeaveQueryString=false;s.linkTrackVars="None";s.linkTrackEvents="None";s.ActionDepthTest=true;s.usePlugins=true;
function s_doPlugins(s){s.prop50="JS-2.7.0";s.events=s.apl(s.events,"event18",",",2);s.events=s.apl(s.events,"event86",",",2);var selectedlanguage="English";var languageId=appInit.localeString;switch(languageId){case "en":selectedlanguage="English";break;case "es":selectedlanguage="Spanish";break;case "ar":selectedlanguage="Arabic";break;case "de":selectedlanguage="Dutch";break;case "es-ES":selectedlanguage="Spanish";break;case "fr-CA":selectedlanguage="French Canadian";break;case "ru":selectedlanguage=
"Russian";break;case "pl":selectedlanguage="Polski";break;case "zh-HANT":selectedlanguage="Chinese";break;case "ro":selectedlanguage="Romanian";break;case "fi-FL":selectedlanguage="Finland";break;default:selectedlanguage="English"}s.eVar28=selectedlanguage;var memLicenseCategory=globalLicenceCategory;if(memLicenseCategory!=null&&!AppUtils.isUndefined(memLicenseCategory)){s.eVar26=memLicenseCategory;if(!AppUtils.isUndefined(s.linkTrackVars))s.linkTrackVars+=",eVar26";else s.linkTrackVars="eVar26"}if(!s.campaign){s.campaign=
s.Util.getQueryParam("uid,cid");s.linkTrackVars+=",campaign"}s.campaign=s.Util.getQueryParam("cid");s.campaign=s.getValOnce(s.campaign,"s_campaign",0);if(!s.eVar75){s.eVar75=s.Util.getQueryParam("eid");s.linkTrackVars+=",eVar75"}s.eVar75=s.getValOnce(s.eVar75,"s_ev75",0);if(!s.eVar1){s.eVar1=s.Util.getQueryParam("intcmp");s.linkTrackVars+=",eVar1"}s.eVar1=s.getValOnce(s.eVar1,"s_ev1",0);if(s.ActionDepthTest){s.pdvalue=s.getActionDepth("s_depth");if(s.pdvalue==1)s.events=s.apl(s.events,"event19",",",
2);if(s.pdvalue==2)s.events=s.apl(s.events,"event20",",",2)}s.ActionDepthTest=false;s.prop45=s.getPreviousValue(s.pageName,"s_pv");if(s.prop45)s.prop46=s.getPercentPageViewed();if(s.eVar34!=null||s.eVar34!=undefined);s.prop47=s.eVar47=s.getNewRepeat(30,"s_nr");s.prop48=s.eVar48=s.getVisitNum();s.prop49=s.eVar49=s.getDaysSinceLastVisit("s_lv");s.prop30=s.eVar30=s.getTimeParting("h","-8");s.prop31=s.eVar31=s.getTimeParting("d");s.prop32=s.eVar32=s.getTimeParting("w");if(!s.prop18)s.prop18=s.Util.getQueryParam("slyear");
if(!s.prop19)s.prop19=s.Util.getQueryParam("slmake");if(!s.prop20)s.prop20=s.Util.getQueryParam("slmodel");if(!s.prop21)s.prop21=s.Util.getQueryParam("slzip");if(!s.prop22)s.prop22=s.Util.getQueryParam("slmiles");if(!s.prop23)s.prop23=s.Util.getQueryParam("slref");if(!s.prop42)s.prop42=s.Util.getQueryParam("slloan");if(!s.prop43)s.prop43=s.Util.getQueryParam("slworth");if(s.prop5)s.eVar5="D\x3dc5";if(s.prop6)s.eVar6="D\x3dc6";if(s.prop7)s.eVar7="D\x3dc7";if(s.prop8)s.eVar8="D\x3dc8";if(s.prop9)s.eVar9=
"D\x3dc9";if(s.prop10)s.eVar10="D\x3dc10";if(s.prop11)s.eVar11="D\x3dc11";if(s.prop12)s.eVar12="D\x3dc12";if(s.prop13)s.eVar13="D\x3dc13";if(s.prop14)s.eVar14="D\x3dc14";if(s.prop15)s.eVar15="D\x3dc15";if(s.prop16)s.eVar16="D\x3dc16";if(s.prop17)s.eVar17="D\x3dc17";if(s.prop18)s.eVar18="D\x3dc18";if(s.prop19)s.eVar19="D\x3dc19";if(s.prop20)s.eVar20="D\x3dc20";if(s.prop21)s.eVar21="D\x3dc21";if(s.prop22)s.eVar22="D\x3dc22";if(s.prop23)s.eVar23="D\x3dc23";if(s.prop42)s.eVar42="D\x3dc42";if(s.prop43)s.eVar43=
"D\x3dc43"}s.doPlugins=s_doPlugins;function get_cookie(cookie_name){var results=document.cookie.match("(^|;) ?"+cookie_name+"\x3d([^;]*)(;|$)");if(results)return unescape(results[2]);else return null}
s.getQueryParam=new Function("p","d","u",""+"var s\x3dthis,v\x3d'',i,t;d\x3dd?d:'';u\x3du?u:(s.pageURL?s.pageURL:s.wd.locati"+"on);if(u\x3d\x3d'f')u\x3ds.gtfs().location;while(p){i\x3dp.indexOf(',');i\x3di\x3c0?p"+".length:i;t\x3ds.p_gpv(p.substring(0,i),u+'');if(t){t\x3dt.indexOf('#')\x3e-"+"1?t.substring(0,t.indexOf('#')):t;}if(t)v+\x3dv?d+t:t;p\x3dp.substring(i\x3d"+"\x3dp.length?i:i+1)}return v");
s.p_gpv=new Function("k","u",""+"var s\x3dthis,v\x3d'',i\x3du.indexOf('?'),q;if(k\x26\x26i\x3e-1){q\x3du.substring(i+1);v"+"\x3ds.pt(q,'\x26','p_gvf',k)}return v");s.p_gvf=new Function("t","k",""+"if(t){var s\x3dthis,i\x3dt.indexOf('\x3d'),p\x3di\x3c0?t:t.substring(0,i),v\x3di\x3c0?'T"+"rue':t.substring(i+1);if(p.toLowerCase()\x3d\x3dk.toLowerCase())return s."+"epa(v)}return ''");
s.setCookieParam=new Function("c","v","x","t",""+"var s\x3dthis,cr,d;cr\x3ds.Util.cookieRead(c);if(cr\x26\x26!x){s.Util.cookieWrite(c,cr);return cr};"+"if(!t){d\x3d'';}else{d\x3dnew Date;d.setTime(d.getTime()+(t*24*60*60"+"*1000));};if(v){s.Util.cookieWrite(c,v,d)};return v;");
s.getValOnce=new Function("v","c","e",""+"var s\x3dthis,a\x3dnew Date,v\x3dv?v:v\x3d'',c\x3dc?c:c\x3d's_gvo',e\x3de?e:0,k\x3ds.Util.cookieRead(c"+");if(v){a.setTime(a.getTime()+e*86400000);s.Util.cookieWrite(c,v,e?a:0);}return"+" v\x3d\x3dk?'':v");s.getActionDepth=new Function("c",""+"var s\x3dthis,v\x3d1,t\x3dnew Date;t.setTime(t.getTime()+1800000);"+"if(!s.Util.cookieRead(c)){v\x3d1}if(s.Util.cookieRead(c)){v\x3ds.Util.cookieRead(c);v++}"+"if(!s.Util.cookieWrite(c,v,t)){s.Util.cookieWrite(c,v,0)}return v;");
s.getAndPersistValue=new Function("v","c","e",""+"var s\x3dthis,a\x3dnew Date;e\x3de?e:0;a.setTime(a.getTime()+e*86400000);if("+"v)s.Util.cookieWrite(c,v,e?a:0);return s.Util.cookieRead(c);");
s.getDaysSinceLastVisit=new Function("c",""+"var s\x3dthis,e\x3dnew Date(),es\x3dnew Date(),cval,cval_s,cval_ss,ct\x3de.getT"+"ime(),day\x3d24*60*60*1000,f1,f2,f3,f4,f5;e.setTime(ct+3*365*day);es.s"+"etTime(ct+30*60*1000);f0\x3d'Cookies Not Supported';f1\x3d'First Visit';f"+"2\x3d'More than 30 days';f3\x3d'More than 7 days';f4\x3d'Less than 7 days';f"+"5\x3d'Less than 1 day';cval\x3ds.Util.cookieRead(c);if(cval.length\x3d\x3d0){s.Util.cookieWrite(c,ct,e);"+"s.Util.cookieWrite(c+'_s',f1,es);}else{var d\x3dct-cval;if(d\x3e30*60*1000){if(d\x3e30*da"+
"y){s.Util.cookieWrite(c,ct,e);s.Util.cookieWrite(c+'_s',f2,es);}else if(d\x3c30*day+1 \x26\x26 d\x3e7*day"+"){s.Util.cookieWrite(c,ct,e);s.Util.cookieWrite(c+'_s',f3,es);}else if(d\x3c7*day+1 \x26\x26 d\x3eday){"+"s.Util.cookieWrite(c,ct,e);s.Util.cookieWrite(c+'_s',f4,es);}else if(d\x3cday+1){s.Util.cookieWrite(c,ct,e);s.c"+"_w(c+'_s',f5,es);}}else{s.Util.cookieWrite(c,ct,e);cval_ss\x3ds.Util.cookieRead(c+'_s');s.Util.cookieWrite(c"+"+'_s',cval_ss,es);}}cval_s\x3ds.Util.cookieRead(c+'_s');if(cval_s.length\x3d\x3d0) retur"+
"n f0;else if(cval_s!\x3df1\x26\x26cval_s!\x3df2\x26\x26cval_s!\x3df3\x26\x26cval_s!\x3df4\x26\x26cval_s"+"!\x3df5) return '';else return cval_s;");
s.getVisitNum=new Function(""+"var s\x3dthis,e\x3dnew Date(),cval,cvisit,ct\x3de.getTime(),c\x3d's_vnum',c2\x3d's"+"_invisit';e.setTime(ct+30*24*60*60*1000);cval\x3ds.Util.cookieRead(c);if(cval){var"+" i\x3dcval.indexOf('\x26vn\x3d'),str\x3dcval.substring(i+4,cval.length),k;}cvis"+"it\x3ds.Util.cookieRead(c2);if(cvisit){if(str){e.setTime(ct+30*60*1000);s.Util.cookieWrite(c2,'"+"true',e);return str;}else return 'unknown visit number';}else{if(st"+"r){str++;k\x3dcval.substring(0,i);e.setTime(k);s.Util.cookieWrite(c,k+'\x26vn\x3d'+str,e)"+
";e.setTime(ct+30*60*1000);s.Util.cookieWrite(c2,'true',e);return str;}else{s.Util.cookieWrite"+"(c,ct+30*24*60*60*1000+'\x26vn\x3d1',e);e.setTime(ct+30*60*1000);s.Util.cookieWrite(c2"+",'true',e);return 1;}}");
s.getNewRepeat=new Function("d","cn",""+"var s\x3dthis,e\x3dnew Date(),cval,sval,ct\x3de.getTime();d\x3dd?d:30;cn\x3dcn?cn:"+"'s_nr';e.setTime(ct+d*24*60*60*1000);cval\x3ds.Util.cookieRead(cn);if(cval.length\x3d"+"\x3d0){s.Util.cookieWrite(cn,ct+'-New',e);return'New';}sval\x3ds.split(cval,'-');if(ct"+"-sval[0]\x3c30*60*1000\x26\x26sval[1]\x3d\x3d'New'){s.Util.cookieWrite(cn,ct+'-New',e);return'N"+"ew';}else{s.Util.cookieWrite(cn,ct+'-Repeat',e);return'Repeat';}");
s.split=new Function("l","d",""+"var i,x\x3d0,a\x3dnew Array;while(l){i\x3dl.indexOf(d);i\x3di\x3e-1?i:l.length;a[x"+"++]\x3dl.substring(0,i);l\x3dl.substring(i+d.length);}return a");s.apl=new Function("L","v","d","u",""+"var s\x3dthis,m\x3d0;if(!L)L\x3d'';if(u){var i,n,a\x3ds.split(L,d);for(i\x3d0;i\x3ca."+"length;i++){n\x3da[i];m\x3dm||(u\x3d\x3d1?(n\x3d\x3dv):(n.toLowerCase()\x3d\x3dv.toLowerCas"+"e()));}}if(!m)L\x3dL?L+d+v:v;return L");
s.getPercentPageViewed=new Function("n",""+"var s\x3dthis,W\x3dwindow,EL\x3dW.addEventListener,AE\x3dW.attachEvent,E\x3d['load"+"','unload','scroll','resize','zoom','keyup','mouseup','touchend','o"+"rientationchange','pan'];W.s_Obj\x3ds;s_PPVid\x3d(n\x3d\x3d'-'?s.pageName:n)||s"+".pageName||location.href;if(!W.s_PPVevent){s.s_PPVg\x3dfunction(n,r){v"+"ar k\x3d's_ppv',p\x3dk+'l',c\x3ds.Util.cookieRead(n||r?k:p),a\x3dc.indexOf(',')\x3e-1?c.split("+"',',10):[''],l\x3da.length,i;a[0]\x3dunescape(a[0]);r\x3dr||(n\x26\x26n!\x3da[0])||0;"+
"a.length\x3d10;if(typeof a[0]!\x3d'string')a[0]\x3d'';for(i\x3d1;i\x3c10;i++)a[i]\x3d"+"!r\x26\x26i\x3cl?parseInt(a[i])||0:0;if(l\x3c10||typeof a[9]!\x3d'string')a[9]\x3d'';"+"if(r){s.c_w(p,c);s.c_w(k,'?')}return a};W.s_PPVevent\x3dfunction(e){va"+"r W\x3dwindow,D\x3ddocument,B\x3dD.body,E\x3dD.documentElement,S\x3dwindow.screen|"+"|0,Ho\x3d'offsetHeight',Hs\x3d'scrollHeight',Ts\x3d'scrollTop',Wc\x3d'clientWid"+"th',Hc\x3d'clientHeight',C\x3d100,M\x3dMath,J\x3d'object',N\x3d'number',s\x3dW.s_Obj|"+
"|W.s||0;e\x3de\x26\x26typeof e\x3d\x3dJ?e.type||'':'';if(!e.indexOf('on'))e\x3de.subs"+"tring(2);s_PPVi\x3dW.s_PPVi||0;if(W.s_PPVt\x26\x26!e){clearTimeout(s_PPVt);s"+"_PPVt\x3d0;if(s_PPVi\x3c2)s_PPVi++}if(typeof s\x3d\x3dJ){var h\x3dM.max(B[Hs]||E[H"+"s],B[Ho]||E[Ho],B[Hc]||E[Hc]),X\x3dW.innerWidth||E[Wc]||B[Wc]||0,Y\x3dW.i"+"nnerHeight||E[Hc]||B[Hc]||0,x\x3dS?S.width:0,y\x3dS?S.height:0,r\x3dM.round("+"C*(W.devicePixelRatio||1))/C,b\x3d(D.pageYOffset||E[Ts]||B[Ts]||0)+Y,p"+"\x3dh\x3e0\x26\x26b\x3e0?M.round(C*b/h):0,O\x3dW.orientation,o\x3d!isNaN(O)?M.abs(o)%180"+
":Y\x3eX?0:90,L\x3de\x3d\x3d'load'||s_PPVi\x3c1,a\x3ds.s_PPVg(s_PPVid,L),V\x3dfunction(i,"+"v,f,n){i\x3dparseInt(typeof a\x3d\x3dJ\x26\x26a.length\x3ei?a[i]:'0')||0;v\x3dtypeof v!\x3d"+"N?i:v;v\x3df||v\x3ei?v:i;return n?v:v\x3eC?C:v\x3c0?0:v};if(new RegExp('(iPod|i"+"Pad|iPhone)').exec(navigator.userAgent||'')\x26\x26o){o\x3dx;x\x3dy;y\x3do}o\x3do?'P'"+":'L';a[9]\x3dL?'':a[9].substring(0,1);s.c_w('s_ppv',escape(W.s_PPVid)+"+"','+V(1,p,L)+','+(L||!V(2)?p:V(2))+','+V(3,b,L,1)+','+X+','+Y+','+x"+"+','+y+','+r+','+a[9]+(a[9]\x3d\x3do?'':o))}if(!W.s_PPVt\x26\x26e!\x3d'unload')W.s"+
"_PPVt\x3dsetTimeout(W.s_PPVevent,333)};for(var f\x3dW.s_PPVevent,i\x3d0;i\x3cE."+"length;i++)if(EL)EL(E[i],f,false);else if(AE)AE('on'+E[i],f);f()};v"+"ar a\x3ds.s_PPVg();return!n||n\x3d\x3d'-'?a[1]:a");
s.getPPVCalc=new Function("",""+"var s\x3ds_c_il["+s._in+"],dh\x3dMath.max(Math.max(s.d.body.scrollHeight,"+"s.d.documentElement.scrollHeight),Math.max(s.d.body.offsetHeight,s."+"d.documentElement.offsetHeight),Math.max(s.d.body.clientHeight,s.d."+"documentElement.clientHeight)),vph\x3ds.w.innerHeight||(s.d.documentE"+"lement.clientHeight||s.d.body.clientHeight),st\x3ds.w.pageYOffset||(s"+".w.document.documentElement.scrollTop||s.w.document.body.scrollTo"+"p),vh\x3dst+vph,pv\x3dMath.round(vh/dh*100),cp\x3ds.Util.cookieRead('s_ppv');if(pv\x3e100){"+
"s.Util.cookieWrite('s_ppv','');}else if(pv\x3ecp){s.Util.cookieWrite('s_ppv',pv);}");s.getPPVSetup=new Function("",""+"var s\x3dthis;if(s.d.addEventListener){s.d.addEventListener('load',s"+".getPPVCalc,false);s.d.addEventListener('scroll',s.getPPVCalc,fals"+"e);s.d.addEventListener('resize',s.getPPVCalc,false);}else if(s.b"+".attachEvent){s.b.attachEvent('onload',s.getPPVCalc);s.w.attachEv"+"ent('onscroll',s.getPPVCalc);s.b.attachEvent('onresize',s.getPPVCa"+"lc);}");s.getPPVSetup();
s.getPreviousValue=new Function("v","c","el",""+"var s\x3dthis,t\x3dnew Date,i,j,r\x3d'';t.setTime(t.getTime()+1800000);if(el"+"){if(s.events){i\x3ds.split(el,',');j\x3ds.split(s.events,',');for(x in i"+"){for(y in j){if(i[x]\x3d\x3dj[y]){if(s.Util.cookieRead(c)) r\x3ds.Util.cookieRead(c);v?s.Util.cookieWrite(c,v,t)"+":s.Util.cookieWrite(c,'no value',t);return r}}}}}else{if(s.Util.cookieRead(c)) r\x3ds.Util.cookieRead(c);v?"+"s.Util.cookieWrite(c,v,t):s.Util.cookieWrite(c,'no value',t);return r}");
s.join=new Function("v","p",""+"var s \x3d this;var f,b,d,w;if(p){f\x3dp.front?p.front:'';b\x3dp.back?p.back"+":'';d\x3dp.delim?p.delim:'';w\x3dp.wrap?p.wrap:'';}var str\x3d'';for(var x\x3d0"+";x\x3cv.length;x++){if(typeof(v[x])\x3d\x3d'object' )str+\x3ds.join( v[x],p);el"+"se str+\x3dw+v[x]+w;if(x\x3cv.length-1)str+\x3dd;}return f+str+b;");s.repl=new Function("x","o","n",""+"var i\x3dx.indexOf(o),l\x3dn.length;while(x\x26\x26i\x3e\x3d0){x\x3dx.substring(0,i)+n+x."+"substring(i+o.length);i\x3dx.indexOf(o,i+l)}return x");
s.inList=new Function("v","l","d",""+"var s\x3dthis,ar\x3dArray(),i\x3d0,d\x3d(d)?d:',';if(typeof(l)\x3d\x3d'string'){if(s."+"split)ar\x3ds.split(l,d);else if(l.split)ar\x3dl.split(d);else return-1}e"+"lse ar\x3dl;while(i\x3car.length){if(v\x3d\x3dar[i])return true;i++}return fals"+"e;");
s.getTimeParting=new Function("t","z","y","l",""+"var s\x3dthis,d,A,U,X,Z,W,B,C,D,Y;d\x3dnew Date();A\x3dd.getFullYear();Y\x3dU\x3dS"+"tring(A);if(s.dstStart\x26\x26s.dstEnd){B\x3ds.dstStart;C\x3ds.dstEnd}else{;U\x3dU"+".substring(2,4);X\x3d'090801|101407|111306|121104|131003|140902|150801"+"|161306|171205|181104|191003';X\x3ds.split(X,'|');for(W\x3d0;W\x3c\x3d10;W++){Z"+"\x3dX[W].substring(0,2);if(U\x3d\x3dZ){B\x3dX[W].substring(2,4);C\x3dX[W].substrin"+"g(4,6)}}if(!B||!C){B\x3d'08';C\x3d'01'}B\x3d'03/'+B+'/'+A;C\x3d'11/'+C+'/'+A;}D"+
"\x3dnew Date('1/1/2000');if(D.getDay()!\x3d6||D.getMonth()!\x3d0){return'Dat"+"a Not Available'}else{z\x3dz?z:'0';z\x3dparseFloat(z);B\x3dnew Date(B);C\x3dnew"+" Date(C);W\x3dnew Date();if(W\x3eB\x26\x26W\x3cC\x26\x26l!\x3d'0'){z\x3dz+1}W\x3dW.getTime()+(W.g"+"etTimezoneOffset()*60000);W\x3dnew Date(W+(3600000*z));X\x3d['Sunday','Mo"+"nday','Tuesday','Wednesday','Thursday','Friday','Saturday'];B\x3dW.get"+"Hours();C\x3dW.getMinutes();D\x3dW.getDay();Z\x3dX[D];U\x3d'AM';A\x3d'Weekday';X\x3d'"+"00';if(C\x3e30){X\x3d'30'}if(B\x3e\x3d12){U\x3d'PM';B\x3dB-12};if(B\x3d\x3d0){B\x3d12};if(D\x3d\x3d6"+
"||D\x3d\x3d0){A\x3d'Weekend'}W\x3dB+':'+X+U;if(y\x26\x26y!\x3dY){return'Data Not Availab"+"le'}else{if(t){if(t\x3d\x3d'h'){return W}if(t\x3d\x3d'd'){return Z}if(t\x3d\x3d'w'){r"+"eturn A}}else{return Z+', '+W}}}");s.visitorNamespace="copart";s.trackingServer="metrics.copart.com";s.trackingServerSecure="smetrics.copart.com";
function AppMeasurement_Module_ActivityMap(f){function g(a,d){var b,c,n;if(a&&d&&(b=e.c[d]||(e.c[d]=d.split(","))))for(n=0;n<b.length&&(c=b[n++]);)if(-1<a.indexOf(c))return null;p=1;return a}function q(a,d,b,c,e){var g,h;if(a.dataset&&(h=a.dataset[d]))g=h;else if(a.getAttribute)if(h=a.getAttribute("data-"+b))g=h;else if(h=a.getAttribute(b))g=h;if(!g&&f.useForcedLinkTracking&&e&&(g="",d=a.onclick?""+a.onclick:"")){b=d.indexOf(c);var l,k;if(0<=b){for(b+=10;b<d.length&&0<="\x3d \t\r\n".indexOf(d.charAt(b));)b++;
if(b<d.length){h=b;for(l=k=0;h<d.length&&(";"!=d.charAt(h)||l);)l?d.charAt(h)!=l||k?k="\\"==d.charAt(h)?!k:0:l=0:(l=d.charAt(h),'"'!=l&&"'"!=l&&(l=0)),h++;if(d=d.substring(b,h))a.e=new Function("s","var e;try{s.w."+c+"\x3d"+d+"}catch(e){}"),a.e(f)}}}return g||e&&f.w[c]}function r(a,d,b){var c;return(c=e[d](a,b))&&(p?(p=0,c):g(k(c),e[d+"Exclusions"]))}function s(a,d,b){var c;if(a&&!(1===(c=a.nodeType)&&(c=a.nodeName)&&(c=c.toUpperCase())&&t[c])&&(1===a.nodeType&&(c=a.nodeValue)&&(d[d.length]=c),b.a||
b.t||b.s||!a.getAttribute||((c=a.getAttribute("alt"))?b.a=c:(c=a.getAttribute("title"))?b.t=c:"IMG"==(""+a.nodeName).toUpperCase()&&(c=a.getAttribute("src")||a.src)&&(b.s=c)),(c=a.childNodes)&&c.length))for(a=0;a<c.length;a++)s(c[a],d,b)}function k(a){if(null==a||void 0==a)return a;try{return a.replace(RegExp("^[\\s\\n\\f\\r\\t\t-\r -\u2028\u2029]+","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r -\u2028\u2029]+$","mg"),"").replace(RegExp("[\\s\\n\\f\\r\\t\t-\r -\u2028\u2029]{1,}",
"mg")," ").substring(0,254)}catch(d){}}var e=this;e.s=f;var m=window;m.s_c_in||(m.s_c_il=[],m.s_c_in=0);e._il=m.s_c_il;e._in=m.s_c_in;e._il[e._in]=e;m.s_c_in++;e._c="s_m";e.c={};var p=0,t={SCRIPT:1,STYLE:1,LINK:1,CANVAS:1};e._g=function(){var a,d,b,c=f.contextData,e=f.linkObject;(a=f.pageName||f.pageURL)&&(d=r(e,"link",f.linkName))&&(b=r(e,"region"))&&(c["a.activitymap.page"]=a.substring(0,255),c["a.activitymap.link"]=128<d.length?d.substring(0,128):d,c["a.activitymap.region"]=127<b.length?b.substring(0,
127):b,c["a.activitymap.pageIDType"]=f.pageName?1:0)};e.link=function(a,d){var b;if(d)b=g(k(d),e.linkExclusions);else if((b=a)&&!(b=q(a,"sObjectId","s-object-id","s_objectID",1))){var c,f;(f=g(k(a.innerText||a.textContent),e.linkExclusions))||(s(a,c=[],b={a:void 0,t:void 0,s:void 0}),(f=g(k(c.join(""))))||(f=g(k(b.a?b.a:b.t?b.t:b.s?b.s:void 0)))||!(c=(c=a.tagName)&&c.toUpperCase?c.toUpperCase():"")||("INPUT"==c||"SUBMIT"==c&&a.value?f=g(k(a.value)):"IMAGE"==c&&a.src&&(f=g(k(a.src)))));b=f}return b};
e.region=function(a){for(var d,b=e.regionIDAttribute||"id";a&&(a=a.parentNode);){if(d=q(a,b,b,b))return d;if("BODY"==a.nodeName)return"BODY"}}}
function AppMeasurement(r){var a=this;a.version="2.7.0";var k=window;k.s_c_in||(k.s_c_il=[],k.s_c_in=0);a._il=k.s_c_il;a._in=k.s_c_in;a._il[a._in]=a;k.s_c_in++;a._c="s_c";var p=k.AppMeasurement.Rb;p||(p=null);var n=k,m,s;try{for(m=n.parent,s=n.location;m&&m.location&&s&&""+m.location!=""+s&&n.location&&""+m.location!=""+n.location&&m.location.host==s.host;)n=m,m=n.parent}catch(u){}a.F=function(a){try{console.log(a)}catch(b){}};a.Ma=function(a){return""+parseInt(a)==""+a};a.replace=function(a,b,d){return!a||
0>a.indexOf(b)?a:a.split(b).join(d)};a.escape=function(c){var b,d;if(!c)return c;c=encodeURIComponent(c);for(b=0;7>b;b++)d="+~!*()'".substring(b,b+1),0<=c.indexOf(d)&&(c=a.replace(c,d,"%"+d.charCodeAt(0).toString(16).toUpperCase()));return c};a.unescape=function(c){if(!c)return c;c=0<=c.indexOf("+")?a.replace(c,"+"," "):c;try{return decodeURIComponent(c)}catch(b){}return unescape(c)};a.yb=function(){var c=k.location.hostname,b=a.fpCookieDomainPeriods,d;b||(b=a.cookieDomainPeriods);if(c&&!a.Ea&&!/^[0-9.]+$/.test(c)&&
(b=b?parseInt(b):2,b=2<b?b:2,d=c.lastIndexOf("."),0<=d)){for(;0<=d&&1<b;)d=c.lastIndexOf(".",d-1),b--;a.Ea=0<d?c.substring(d):c}return a.Ea};a.c_r=a.cookieRead=function(c){c=a.escape(c);var b=" "+a.d.cookie,d=b.indexOf(" "+c+"\x3d"),f=0>d?d:b.indexOf(";",d);c=0>d?"":a.unescape(b.substring(d+2+c.length,0>f?b.length:f));return"[[B]]"!=c?c:""};a.c_w=a.cookieWrite=function(c,b,d){var f=a.yb(),e=a.cookieLifetime,g;b=""+b;e=e?(""+e).toUpperCase():"";d&&"SESSION"!=e&&"NONE"!=e&&((g=""!=b?parseInt(e?e:0):
-60)?(d=new Date,d.setTime(d.getTime()+1E3*g)):1==d&&(d=new Date,g=d.getYear(),d.setYear(g+5+(1900>g?1900:0))));return c&&"NONE"!=e?(a.d.cookie=a.escape(c)+"\x3d"+a.escape(""!=b?b:"[[B]]")+"; path\x3d/;"+(d&&"SESSION"!=e?" expires\x3d"+d.toUTCString()+";":"")+(f?" domain\x3d"+f+";":""),a.cookieRead(c)==b):0};a.ub=function(){var c=a.Util.getIeVersion();"number"===typeof c&&10>c&&(a.unsupportedBrowser=!0,a.jb(a,function(){}))};a.jb=function(a,b){for(var d in a)a.hasOwnProperty(d)&&"function"===typeof a[d]&&
(a[d]=b)};a.L=[];a.ia=function(c,b,d){if(a.Fa)return 0;a.maxDelay||(a.maxDelay=250);var f=0,e=(new Date).getTime()+a.maxDelay,g=a.d.visibilityState,h=["webkitvisibilitychange","visibilitychange"];g||(g=a.d.webkitVisibilityState);if(g&&"prerender"==g){if(!a.ja)for(a.ja=1,d=0;d<h.length;d++)a.d.addEventListener(h[d],function(){var c=a.d.visibilityState;c||(c=a.d.webkitVisibilityState);"visible"==c&&(a.ja=0,a.delayReady())});f=1;e=0}else d||a.p("_d")&&(f=1);f&&(a.L.push({m:c,a:b,t:e}),a.ja||setTimeout(a.delayReady,
a.maxDelay));return f};a.delayReady=function(){var c=(new Date).getTime(),b=0,d;for(a.p("_d")?b=1:a.xa();0<a.L.length;){d=a.L.shift();if(b&&!d.t&&d.t>c){a.L.unshift(d);setTimeout(a.delayReady,parseInt(a.maxDelay/2));break}a.Fa=1;a[d.m].apply(a,d.a);a.Fa=0}};a.setAccount=a.sa=function(c){var b,d;if(!a.ia("setAccount",arguments))if(a.account=c,a.allAccounts)for(b=a.allAccounts.concat(c.split(",")),a.allAccounts=[],b.sort(),d=0;d<b.length;d++)0!=d&&b[d-1]==b[d]||a.allAccounts.push(b[d]);else a.allAccounts=
c.split(",")};a.foreachVar=function(c,b){var d,f,e,g,h="";e=f="";if(a.lightProfileID)d=a.P,(h=a.lightTrackVars)&&(h=","+h+","+a.na.join(",")+",");else{d=a.g;if(a.pe||a.linkType)h=a.linkTrackVars,f=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(h=a[e].Pb,f=a[e].Ob));h&&(h=","+h+","+a.H.join(",")+",");f&&h&&(h+=",events,")}b&&(b=","+b+",");for(f=0;f<d.length;f++)e=d[f],(g=a[e])&&(!h||0<=h.indexOf(","+e+","))&&(!b||0<=b.indexOf(","+e+","))&&c(e,g)};a.r=function(c,
b,d,f,e){var g="",h,l,k,q,m=0;"contextData"==c&&(c="c");if(b){for(h in b)if(!(Object.prototype[h]||e&&h.substring(0,e.length)!=e)&&b[h]&&(!d||0<=d.indexOf(","+(f?f+".":"")+h+","))){k=!1;if(m)for(l=0;l<m.length;l++)h.substring(0,m[l].length)==m[l]&&(k=!0);if(!k&&(""==g&&(g+="\x26"+c+"."),l=b[h],e&&(h=h.substring(e.length)),0<h.length))if(k=h.indexOf("."),0<k)l=h.substring(0,k),k=(e?e:"")+l+".",m||(m=[]),m.push(k),g+=a.r(l,b,d,f,k);else if("boolean"==typeof l&&(l=l?"true":"false"),l){if("retrieveLightData"==
f&&0>e.indexOf(".contextData."))switch(k=h.substring(0,4),q=h.substring(4),h){case "transactionID":h="xact";break;case "channel":h="ch";break;case "campaign":h="v0";break;default:a.Ma(q)&&("prop"==k?h="c"+q:"eVar"==k?h="v"+q:"list"==k?h="l"+q:"hier"==k&&(h="h"+q,l=l.substring(0,255)))}g+="\x26"+a.escape(h)+"\x3d"+a.escape(l)}}""!=g&&(g+="\x26."+c)}return g};a.usePostbacks=0;a.Bb=function(){var c="",b,d,f,e,g,h,l,k,q="",m="",n=e="";if(a.lightProfileID)b=a.P,(q=a.lightTrackVars)&&(q=","+q+","+a.na.join(",")+
",");else{b=a.g;if(a.pe||a.linkType)q=a.linkTrackVars,m=a.linkTrackEvents,a.pe&&(e=a.pe.substring(0,1).toUpperCase()+a.pe.substring(1),a[e]&&(q=a[e].Pb,m=a[e].Ob));q&&(q=","+q+","+a.H.join(",")+",");m&&(m=","+m+",",q&&(q+=",events,"));a.events2&&(n+=(""!=n?",":"")+a.events2)}if(a.visitor&&a.visitor.getCustomerIDs){e=p;if(g=a.visitor.getCustomerIDs())for(d in g)Object.prototype[d]||(f=g[d],"object"==typeof f&&(e||(e={}),f.id&&(e[d+".id"]=f.id),f.authState&&(e[d+".as"]=f.authState)));e&&(c+=a.r("cid",
e))}a.AudienceManagement&&a.AudienceManagement.isReady()&&(c+=a.r("d",a.AudienceManagement.getEventCallConfigParams()));for(d=0;d<b.length;d++){e=b[d];g=a[e];f=e.substring(0,4);h=e.substring(4);g||("events"==e&&n?(g=n,n=""):"marketingCloudOrgID"==e&&a.visitor&&(g=a.visitor.marketingCloudOrgID));if(g&&(!q||0<=q.indexOf(","+e+","))){switch(e){case "customerPerspective":e="cp";break;case "marketingCloudOrgID":e="mcorgid";break;case "supplementalDataID":e="sdid";break;case "timestamp":e="ts";break;case "dynamicVariablePrefix":e=
"D";break;case "visitorID":e="vid";break;case "marketingCloudVisitorID":e="mid";break;case "analyticsVisitorID":e="aid";break;case "audienceManagerLocationHint":e="aamlh";break;case "audienceManagerBlob":e="aamb";break;case "authState":e="as";break;case "pageURL":e="g";255<g.length&&(a.pageURLRest=g.substring(255),g=g.substring(0,255));break;case "pageURLRest":e="-g";break;case "referrer":e="r";break;case "vmk":case "visitorMigrationKey":e="vmt";break;case "visitorMigrationServer":e="vmf";a.ssl&&
a.visitorMigrationServerSecure&&(g="");break;case "visitorMigrationServerSecure":e="vmf";!a.ssl&&a.visitorMigrationServer&&(g="");break;case "charSet":e="ce";break;case "visitorNamespace":e="ns";break;case "cookieDomainPeriods":e="cdp";break;case "cookieLifetime":e="cl";break;case "variableProvider":e="vvp";break;case "currencyCode":e="cc";break;case "channel":e="ch";break;case "transactionID":e="xact";break;case "campaign":e="v0";break;case "latitude":e="lat";break;case "longitude":e="lon";break;
case "resolution":e="s";break;case "colorDepth":e="c";break;case "javascriptVersion":e="j";break;case "javaEnabled":e="v";break;case "cookiesEnabled":e="k";break;case "browserWidth":e="bw";break;case "browserHeight":e="bh";break;case "connectionType":e="ct";break;case "homepage":e="hp";break;case "events":n&&(g+=(""!=g?",":"")+n);if(m)for(h=g.split(","),g="",f=0;f<h.length;f++)l=h[f],k=l.indexOf("\x3d"),0<=k&&(l=l.substring(0,k)),k=l.indexOf(":"),0<=k&&(l=l.substring(0,k)),0<=m.indexOf(","+l+",")&&
(g+=(g?",":"")+h[f]);break;case "events2":g="";break;case "contextData":c+=a.r("c",a[e],q,e);g="";break;case "lightProfileID":e="mtp";break;case "lightStoreForSeconds":e="mtss";a.lightProfileID||(g="");break;case "lightIncrementBy":e="mti";a.lightProfileID||(g="");break;case "retrieveLightProfiles":e="mtsr";break;case "deleteLightProfiles":e="mtsd";break;case "retrieveLightData":a.retrieveLightProfiles&&(c+=a.r("mts",a[e],q,e));g="";break;default:a.Ma(h)&&("prop"==f?e="c"+h:"eVar"==f?e="v"+h:"list"==
f?e="l"+h:"hier"==f&&(e="h"+h,g=g.substring(0,255)))}g&&(c+="\x26"+e+"\x3d"+("pev"!=e.substring(0,3)?a.escape(g):g))}"pev3"==e&&a.e&&(c+=a.e)}return c};a.D=function(a){var b=a.tagName;if("undefined"!=""+a.Ub||"undefined"!=""+a.Kb&&"HTML"!=(""+a.Kb).toUpperCase())return"";b=b&&b.toUpperCase?b.toUpperCase():"";"SHAPE"==b&&(b="");b&&(("INPUT"==b||"BUTTON"==b)&&a.type&&a.type.toUpperCase?b=a.type.toUpperCase():!b&&a.href&&(b="A"));return b};a.Ia=function(a){var b=k.location,d=a.href?a.href:"",f,e,g;f=
d.indexOf(":");e=d.indexOf("?");g=d.indexOf("/");d&&(0>f||0<=e&&f>e||0<=g&&f>g)&&(e=a.protocol&&1<a.protocol.length?a.protocol:b.protocol?b.protocol:"",f=b.pathname.lastIndexOf("/"),d=(e?e+"//":"")+(a.host?a.host:b.host?b.host:"")+("/"!=d.substring(0,1)?b.pathname.substring(0,0>f?0:f)+"/":"")+d);return d};a.M=function(c){var b=a.D(c),d,f,e="",g=0;return b&&(d=c.protocol,f=c.onclick,!c.href||"A"!=b&&"AREA"!=b||f&&d&&!(0>d.toLowerCase().indexOf("javascript"))?f?(e=a.replace(a.replace(a.replace(a.replace(""+
f,"\r",""),"\n",""),"\t","")," ",""),g=2):"INPUT"==b||"SUBMIT"==b?(c.value?e=c.value:c.innerText?e=c.innerText:c.textContent&&(e=c.textContent),g=3):"IMAGE"==b&&c.src&&(e=c.src):e=a.Ia(c),e)?{id:e.substring(0,100),type:g}:0};a.Sb=function(c){for(var b=a.D(c),d=a.M(c);c&&!d&&"BODY"!=b;)if(c=c.parentElement?c.parentElement:c.parentNode)b=a.D(c),d=a.M(c);d&&"BODY"!=b||(c=0);c&&(b=c.onclick?""+c.onclick:"",0<=b.indexOf(".tl(")||0<=b.indexOf(".trackLink("))&&(c=0);return c};a.Jb=function(){var c,b,d=a.linkObject,
f=a.linkType,e=a.linkURL,g,h;a.oa=1;d||(a.oa=0,d=a.clickObject);if(d){c=a.D(d);for(b=a.M(d);d&&!b&&"BODY"!=c;)if(d=d.parentElement?d.parentElement:d.parentNode)c=a.D(d),b=a.M(d);b&&"BODY"!=c||(d=0);if(d&&!a.linkObject){var l=d.onclick?""+d.onclick:"";if(0<=l.indexOf(".tl(")||0<=l.indexOf(".trackLink("))d=0}}else a.oa=1;!e&&d&&(e=a.Ia(d));e&&!a.linkLeaveQueryString&&(g=e.indexOf("?"),0<=g&&(e=e.substring(0,g)));if(!f&&e){var m=0,q=0,n;if(a.trackDownloadLinks&&a.linkDownloadFileTypes)for(l=e.toLowerCase(),
g=l.indexOf("?"),h=l.indexOf("#"),0<=g?0<=h&&h<g&&(g=h):g=h,0<=g&&(l=l.substring(0,g)),g=a.linkDownloadFileTypes.toLowerCase().split(","),h=0;h<g.length;h++)(n=g[h])&&l.substring(l.length-(n.length+1))=="."+n&&(f="d");if(a.trackExternalLinks&&!f&&(l=e.toLowerCase(),a.La(l)&&(a.linkInternalFilters||(a.linkInternalFilters=k.location.hostname),g=0,a.linkExternalFilters?(g=a.linkExternalFilters.toLowerCase().split(","),m=1):a.linkInternalFilters&&(g=a.linkInternalFilters.toLowerCase().split(",")),g))){for(h=
0;h<g.length;h++)n=g[h],0<=l.indexOf(n)&&(q=1);q?m&&(f="e"):m||(f="e")}}a.linkObject=d;a.linkURL=e;a.linkType=f;if(a.trackClickMap||a.trackInlineStats)a.e="",d&&(f=a.pageName,e=1,d=d.sourceIndex,f||(f=a.pageURL,e=0),k.s_objectID&&(b.id=k.s_objectID,d=b.type=1),f&&b&&b.id&&c&&(a.e="\x26pid\x3d"+a.escape(f.substring(0,255))+(e?"\x26pidt\x3d"+e:"")+"\x26oid\x3d"+a.escape(b.id.substring(0,100))+(b.type?"\x26oidt\x3d"+b.type:"")+"\x26ot\x3d"+c+(d?"\x26oi\x3d"+d:"")))};a.Cb=function(){var c=a.oa,b=a.linkType,
d=a.linkURL,f=a.linkName;b&&(d||f)&&(b=b.toLowerCase(),"d"!=b&&"e"!=b&&(b="o"),a.pe="lnk_"+b,a.pev1=d?a.escape(d):"",a.pev2=f?a.escape(f):"",c=1);a.abort&&(c=0);if(a.trackClickMap||a.trackInlineStats||a.ActivityMap){var b={},d=0,e=a.cookieRead("s_sq"),g=e?e.split("\x26"):0,h,l,k,e=0;if(g)for(h=0;h<g.length;h++)l=g[h].split("\x3d"),f=a.unescape(l[0]).split(","),l=a.unescape(l[1]),b[l]=f;f=a.account.split(",");h={};for(k in a.contextData)k&&!Object.prototype[k]&&"a.activitymap."==k.substring(0,14)&&
(h[k]=a.contextData[k],a.contextData[k]="");a.e=a.r("c",h)+(a.e?a.e:"");if(c||a.e){c&&!a.e&&(e=1);for(l in b)if(!Object.prototype[l])for(k=0;k<f.length;k++)for(e&&(g=b[l].join(","),g==a.account&&(a.e+=("\x26"!=l.charAt(0)?"\x26":"")+l,b[l]=[],d=1)),h=0;h<b[l].length;h++)g=b[l][h],g==f[k]&&(e&&(a.e+="\x26u\x3d"+a.escape(g)+("\x26"!=l.charAt(0)?"\x26":"")+l+"\x26u\x3d0"),b[l].splice(h,1),d=1);c||(d=1);if(d){e="";h=2;!c&&a.e&&(e=a.escape(f.join(","))+"\x3d"+a.escape(a.e),h=1);for(l in b)!Object.prototype[l]&&
0<h&&0<b[l].length&&(e+=(e?"\x26":"")+a.escape(b[l].join(","))+"\x3d"+a.escape(l),h--);a.cookieWrite("s_sq",e)}}}return c};a.Db=function(){if(!a.Nb){var c=new Date,b=n.location,d,f,e=f=d="",g="",h="",l="1.2",k=a.cookieWrite("s_cc","true",0)?"Y":"N",m="",p="";if(c.setUTCDate&&(l="1.3",(0).toPrecision&&(l="1.5",c=[],c.forEach))){l="1.6";f=0;d={};try{f=new Iterator(d),f.next&&(l="1.7",c.reduce&&(l="1.8",l.trim&&(l="1.8.1",Date.parse&&(l="1.8.2",Object.create&&(l="1.8.5")))))}catch(r){}}d=screen.width+
"x"+screen.height;e=navigator.javaEnabled()?"Y":"N";f=screen.pixelDepth?screen.pixelDepth:screen.colorDepth;g=a.w.innerWidth?a.w.innerWidth:a.d.documentElement.offsetWidth;h=a.w.innerHeight?a.w.innerHeight:a.d.documentElement.offsetHeight;try{a.b.addBehavior("#default#homePage"),m=a.b.Tb(b)?"Y":"N"}catch(s){}try{a.b.addBehavior("#default#clientCaps"),p=a.b.connectionType}catch(t){}a.resolution=d;a.colorDepth=f;a.javascriptVersion=l;a.javaEnabled=e;a.cookiesEnabled=k;a.browserWidth=g;a.browserHeight=
h;a.connectionType=p;a.homepage=m;a.Nb=1}};a.Q={};a.loadModule=function(c,b){var d=a.Q[c];if(!d){d=k["AppMeasurement_Module_"+c]?new k["AppMeasurement_Module_"+c](a):{};a.Q[c]=a[c]=d;d.eb=function(){return d.ib};d.kb=function(b){if(d.ib=b)a[c+"_onLoad"]=b,a.ia(c+"_onLoad",[a,d],1)||b(a,d)};try{Object.defineProperty?Object.defineProperty(d,"onLoad",{get:d.eb,set:d.kb}):d._olc=1}catch(f){d._olc=1}}b&&(a[c+"_onLoad"]=b,a.ia(c+"_onLoad",[a,d],1)||b(a,d))};a.p=function(c){var b,d;for(b in a.Q)if(!Object.prototype[b]&&
(d=a.Q[b])&&(d._olc&&d.onLoad&&(d._olc=0,d.onLoad(a,d)),d[c]&&d[c]()))return 1;return 0};a.Fb=function(){var c=Math.floor(1E13*Math.random()),b=a.visitorSampling,d=a.visitorSamplingGroup,d="s_vsn_"+(a.visitorNamespace?a.visitorNamespace:a.account)+(d?"_"+d:""),f=a.cookieRead(d);if(b){b*=100;f&&(f=parseInt(f));if(!f){if(!a.cookieWrite(d,c))return 0;f=c}if(f%1E4>b)return 0}return 1};a.R=function(c,b){var d,f,e,g,h,l;for(d=0;2>d;d++)for(f=0<d?a.Aa:a.g,e=0;e<f.length;e++)if(g=f[e],(h=c[g])||c["!"+g]){if(!b&&
("contextData"==g||"retrieveLightData"==g)&&a[g])for(l in a[g])h[l]||(h[l]=a[g][l]);a[g]=h}};a.Va=function(c,b){var d,f,e,g;for(d=0;2>d;d++)for(f=0<d?a.Aa:a.g,e=0;e<f.length;e++)g=f[e],c[g]=a[g],b||c[g]||(c["!"+g]=1)};a.xb=function(a){var b,d,f,e,g,h=0,l,k="",m="";if(a&&255<a.length&&(b=""+a,d=b.indexOf("?"),0<d&&(l=b.substring(d+1),b=b.substring(0,d),e=b.toLowerCase(),f=0,"http://"==e.substring(0,7)?f+=7:"https://"==e.substring(0,8)&&(f+=8),d=e.indexOf("/",f),0<d&&(e=e.substring(f,d),g=b.substring(d),
b=b.substring(0,d),0<=e.indexOf("google")?h=",q,ie,start,search_key,word,kw,cd,":0<=e.indexOf("yahoo.co")&&(h=",p,ei,"),h&&l)))){if((a=l.split("\x26"))&&1<a.length){for(f=0;f<a.length;f++)e=a[f],d=e.indexOf("\x3d"),0<d&&0<=h.indexOf(","+e.substring(0,d)+",")?k+=(k?"\x26":"")+e:m+=(m?"\x26":"")+e;k&&m?l=k+"\x26"+m:m=""}d=253-(l.length-m.length)-b.length;a=b+(0<d?g.substring(0,d):"")+"?"+l}return a};a.ab=function(c){var b=a.d.visibilityState,d=["webkitvisibilitychange","visibilitychange"];b||(b=a.d.webkitVisibilityState);
if(b&&"prerender"==b){if(c)for(b=0;b<d.length;b++)a.d.addEventListener(d[b],function(){var b=a.d.visibilityState;b||(b=a.d.webkitVisibilityState);"visible"==b&&c()});return!1}return!0};a.ea=!1;a.J=!1;a.mb=function(){a.J=!0;a.j()};a.ca=!1;a.V=!1;a.hb=function(c){a.marketingCloudVisitorID=c;a.V=!0;a.j()};a.fa=!1;a.W=!1;a.nb=function(c){a.visitorOptedOut=c;a.W=!0;a.j()};a.Z=!1;a.S=!1;a.Xa=function(c){a.analyticsVisitorID=c;a.S=!0;a.j()};a.ba=!1;a.U=!1;a.Za=function(c){a.audienceManagerLocationHint=c;
a.U=!0;a.j()};a.aa=!1;a.T=!1;a.Ya=function(c){a.audienceManagerBlob=c;a.T=!0;a.j()};a.$a=function(c){a.maxDelay||(a.maxDelay=250);return a.p("_d")?(c&&setTimeout(function(){c()},a.maxDelay),!1):!0};a.da=!1;a.I=!1;a.xa=function(){a.I=!0;a.j()};a.isReadyToTrack=function(){var c=!0,b=a.visitor,d,f,e;a.ea||a.J||(a.ab(a.mb)?a.J=!0:a.ea=!0);if(a.ea&&!a.J)return!1;b&&b.isAllowed()&&(a.ca||a.marketingCloudVisitorID||!b.getMarketingCloudVisitorID||(a.ca=!0,a.marketingCloudVisitorID=b.getMarketingCloudVisitorID([a,
a.hb]),a.marketingCloudVisitorID&&(a.V=!0)),a.fa||a.visitorOptedOut||!b.isOptedOut||(a.fa=!0,a.visitorOptedOut=b.isOptedOut([a,a.nb]),a.visitorOptedOut!=p&&(a.W=!0)),a.Z||a.analyticsVisitorID||!b.getAnalyticsVisitorID||(a.Z=!0,a.analyticsVisitorID=b.getAnalyticsVisitorID([a,a.Xa]),a.analyticsVisitorID&&(a.S=!0)),a.ba||a.audienceManagerLocationHint||!b.getAudienceManagerLocationHint||(a.ba=!0,a.audienceManagerLocationHint=b.getAudienceManagerLocationHint([a,a.Za]),a.audienceManagerLocationHint&&(a.U=
!0)),a.aa||a.audienceManagerBlob||!b.getAudienceManagerBlob||(a.aa=!0,a.audienceManagerBlob=b.getAudienceManagerBlob([a,a.Ya]),a.audienceManagerBlob&&(a.T=!0)),c=a.ca&&!a.V&&!a.marketingCloudVisitorID,b=a.Z&&!a.S&&!a.analyticsVisitorID,d=a.ba&&!a.U&&!a.audienceManagerLocationHint,f=a.aa&&!a.T&&!a.audienceManagerBlob,e=a.fa&&!a.W,c=c||b||d||f||e?!1:!0);a.da||a.I||(a.$a(a.xa)?a.I=!0:a.da=!0);a.da&&!a.I&&(c=!1);return c};a.o=p;a.u=0;a.callbackWhenReadyToTrack=function(c,b,d){var f;f={};f.rb=c;f.qb=b;
f.ob=d;a.o==p&&(a.o=[]);a.o.push(f);0==a.u&&(a.u=setInterval(a.j,100))};a.j=function(){var c;if(a.isReadyToTrack()&&(a.lb(),a.o!=p))for(;0<a.o.length;)c=a.o.shift(),c.qb.apply(c.rb,c.ob)};a.lb=function(){a.u&&(clearInterval(a.u),a.u=0)};a.fb=function(c){var b,d,f=p,e=p;if(!a.isReadyToTrack()){b=[];if(c!=p)for(d in f={},c)f[d]=c[d];e={};a.Va(e,!0);b.push(f);b.push(e);a.callbackWhenReadyToTrack(a,a.track,b);return!0}return!1};a.zb=function(){var c=a.cookieRead("s_fid"),b="",d="",f;f=8;var e=4;if(!c||
0>c.indexOf("-")){for(c=0;16>c;c++)f=Math.floor(Math.random()*f),b+="0123456789ABCDEF".substring(f,f+1),f=Math.floor(Math.random()*e),d+="0123456789ABCDEF".substring(f,f+1),f=e=16;c=b+"-"+d}a.cookieWrite("s_fid",c,1)||(c=0);return c};a.t=a.track=function(c,b){var d,f=new Date,e="s"+Math.floor(f.getTime()/108E5)%10+Math.floor(1E13*Math.random()),g=f.getYear(),g="t\x3d"+a.escape(f.getDate()+"/"+f.getMonth()+"/"+(1900>g?g+1900:g)+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()+" "+f.getDay()+
" "+f.getTimezoneOffset());a.visitor&&a.visitor.getAuthState&&(a.authState=a.visitor.getAuthState());a.p("_s");a.fb(c)||(b&&a.R(b),c&&(d={},a.Va(d,0),a.R(c)),a.Fb()&&!a.visitorOptedOut&&(a.analyticsVisitorID||a.marketingCloudVisitorID||(a.fid=a.zb()),a.Jb(),a.usePlugins&&a.doPlugins&&a.doPlugins(a),a.account&&(a.abort||(a.trackOffline&&!a.timestamp&&(a.timestamp=Math.floor(f.getTime()/1E3)),f=k.location,a.pageURL||(a.pageURL=f.href?f.href:f),a.referrer||a.Wa||(f=a.Util.getQueryParam("adobe_mc_ref",
null,null,!0),a.referrer=f||void 0===f?void 0===f?"":f:n.document.referrer),a.Wa=1,a.referrer=a.xb(a.referrer),a.p("_g")),a.Cb()&&!a.abort&&(a.visitor&&!a.supplementalDataID&&a.visitor.getSupplementalDataID&&(a.supplementalDataID=a.visitor.getSupplementalDataID("AppMeasurement:"+a._in,a.expectSupplementalData?!1:!0)),a.Db(),g+=a.Bb(),a.Ib(e,g),a.p("_t"),a.referrer=""))),c&&a.R(d,1));a.abort=a.supplementalDataID=a.timestamp=a.pageURLRest=a.linkObject=a.clickObject=a.linkURL=a.linkName=a.linkType=k.s_objectID=
a.pe=a.pev1=a.pev2=a.pev3=a.e=a.lightProfileID=0};a.za=[];a.registerPreTrackCallback=function(c){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);"function"==typeof c?a.za.push([c,b]):a.debugTracking&&a.F("DEBUG: Non function type passed to registerPreTrackCallback")};a.cb=function(c){a.wa(a.za,c)};a.ya=[];a.registerPostTrackCallback=function(c){for(var b=[],d=1;d<arguments.length;d++)b.push(arguments[d]);"function"==typeof c?a.ya.push([c,b]):a.debugTracking&&a.F("DEBUG: Non function type passed to registerPostTrackCallback")};
a.bb=function(c){a.wa(a.ya,c)};a.wa=function(c,b){if("object"==typeof c)for(var d=0;d<c.length;d++){var f=c[d][0],e=c[d][1];e.unshift(b);if("function"==typeof f)try{f.apply(null,e)}catch(g){a.debugTracking&&a.F(g.message)}}};a.tl=a.trackLink=function(c,b,d,f,e){a.linkObject=c;a.linkType=b;a.linkName=d;e&&(a.l=c,a.A=e);return a.track(f)};a.trackLight=function(c,b,d,f){a.lightProfileID=c;a.lightStoreForSeconds=b;a.lightIncrementBy=d;return a.track(f)};a.clearVars=function(){var c,b;for(c=0;c<a.g.length;c++)if(b=
a.g[c],"prop"==b.substring(0,4)||"eVar"==b.substring(0,4)||"hier"==b.substring(0,4)||"list"==b.substring(0,4)||"channel"==b||"events"==b||"eventList"==b||"products"==b||"productList"==b||"purchaseID"==b||"transactionID"==b||"state"==b||"zip"==b||"campaign"==b)a[b]=void 0};a.tagContainerMarker="";a.Ib=function(c,b){var d,f=a.trackingServer;d="";var e=a.dc,g="sc.",h=a.visitorNamespace;f?a.trackingServerSecure&&a.ssl&&(f=a.trackingServerSecure):(h||(h=a.account,f=h.indexOf(","),0<=f&&(h=h.substring(0,
f)),h=h.replace(/[^A-Za-z0-9]/g,"")),d||(d="2o7.net"),e=e?(""+e).toLowerCase():"d1","2o7.net"==d&&("d1"==e?e="112":"d2"==e&&(e="122"),g=""),f=h+"."+e+"."+g+d);d=a.ssl?"https://":"http://";e=a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks;d+=f+"/b/ss/"+a.account+"/"+(a.mobile?"5.":"")+(e?"10":"1")+"/JS-"+a.version+(a.Mb?"T":"")+(a.tagContainerMarker?"-"+a.tagContainerMarker:"")+"/"+c+"?AQB\x3d1\x26ndh\x3d1\x26pf\x3d1\x26"+(e?"callback\x3ds_c_il["+a._in+"].doPostbacks\x26et\x3d1\x26":
"")+b+"\x26AQE\x3d1";a.cb(d);a.vb(d);a.ka()};a.Ua=/{(%?)(.*?)(%?)}/;a.Qb=RegExp(a.Ua.source,"g");a.wb=function(c){if("object"==typeof c.dests)for(var b=0;b<c.dests.length;++b){var d=c.dests[b];if("string"==typeof d.c&&"aa."==d.id.substr(0,3))for(var f=d.c.match(a.Qb),e=0;e<f.length;++e){var g=f[e],h=g.match(a.Ua),k="";"%"==h[1]&&"timezone_offset"==h[2]?k=(new Date).getTimezoneOffset():"%"==h[1]&&"timestampz"==h[2]&&(k=a.Ab());d.c=d.c.replace(g,a.escape(k))}}};a.Ab=function(){var c=new Date,b=new Date(6E4*
Math.abs(c.getTimezoneOffset()));return a.k(4,c.getFullYear())+"-"+a.k(2,c.getMonth()+1)+"-"+a.k(2,c.getDate())+"T"+a.k(2,c.getHours())+":"+a.k(2,c.getMinutes())+":"+a.k(2,c.getSeconds())+(0<c.getTimezoneOffset()?"-":"+")+a.k(2,b.getUTCHours())+":"+a.k(2,b.getUTCMinutes())};a.k=function(a,b){return(Array(a+1).join(0)+b).slice(-a)};a.ta={};a.doPostbacks=function(c){if("object"==typeof c)if(a.wb(c),"object"==typeof a.AudienceManagement&&"function"==typeof a.AudienceManagement.isReady&&a.AudienceManagement.isReady()&&
"function"==typeof a.AudienceManagement.passData)a.AudienceManagement.passData(c);else if("object"==typeof c&&"object"==typeof c.dests)for(var b=0;b<c.dests.length;++b){var d=c.dests[b];"object"==typeof d&&"string"==typeof d.c&&"string"==typeof d.id&&"aa."==d.id.substr(0,3)&&(a.ta[d.id]=new Image,a.ta[d.id].alt="",a.ta[d.id].src=d.c)}};a.vb=function(c){a.i||a.Eb();a.i.push(c);a.ma=a.C();a.Sa()};a.Eb=function(){a.i=a.Gb();a.i||(a.i=[])};a.Gb=function(){var c,b;if(a.ra()){try{(b=k.localStorage.getItem(a.pa()))&&
(c=k.JSON.parse(b))}catch(d){}return c}};a.ra=function(){var c=!0;a.trackOffline&&a.offlineFilename&&k.localStorage&&k.JSON||(c=!1);return c};a.Ja=function(){var c=0;a.i&&(c=a.i.length);a.q&&c++;return c};a.ka=function(){if(a.q&&(a.B&&a.B.complete&&a.B.G&&a.B.va(),a.q))return;a.Ka=p;if(a.qa)a.ma>a.O&&a.Qa(a.i),a.ua(500);else{var c=a.pb();if(0<c)a.ua(c);else if(c=a.Ga())a.q=1,a.Hb(c),a.Lb(c)}};a.ua=function(c){a.Ka||(c||(c=0),a.Ka=setTimeout(a.ka,c))};a.pb=function(){var c;if(!a.trackOffline||0>=a.offlineThrottleDelay)return 0;
c=a.C()-a.Pa;return a.offlineThrottleDelay<c?0:a.offlineThrottleDelay-c};a.Ga=function(){if(0<a.i.length)return a.i.shift()};a.Hb=function(c){if(a.debugTracking){var b="AppMeasurement Debug: "+c;c=c.split("\x26");var d;for(d=0;d<c.length;d++)b+="\n\t"+a.unescape(c[d]);a.F(b)}};a.gb=function(){return a.marketingCloudVisitorID||a.analyticsVisitorID};a.Y=!1;var t;try{t=JSON.parse('{"x":"y"}')}catch(w){t=null}t&&"y"==t.x?(a.Y=!0,a.X=function(a){return JSON.parse(a)}):k.$&&k.$.parseJSON?(a.X=function(a){return k.$.parseJSON(a)},
a.Y=!0):a.X=function(){return null};a.Lb=function(c){var b,d,f;a.gb()&&2047<c.length&&("undefined"!=typeof XMLHttpRequest&&(b=new XMLHttpRequest,"withCredentials"in b?d=1:b=0),b||"undefined"==typeof XDomainRequest||(b=new XDomainRequest,d=2),b&&(a.AudienceManagement&&a.AudienceManagement.isReady()||0!=a.usePostbacks)&&(a.Y?b.Ba=!0:b=0));!b&&a.Ta&&(c=c.substring(0,2047));!b&&a.d.createElement&&(0!=a.usePostbacks||a.AudienceManagement&&a.AudienceManagement.isReady())&&(b=a.d.createElement("SCRIPT"))&&
"async"in b&&((f=(f=a.d.getElementsByTagName("HEAD"))&&f[0]?f[0]:a.d.body)?(b.type="text/javascript",b.setAttribute("async","async"),d=3):b=0);b||(b=new Image,b.alt="",b.abort||"undefined"===typeof k.InstallTrigger||(b.abort=function(){b.src=p}));b.Da=function(){try{b.G&&(clearTimeout(b.G),b.G=0)}catch(a){}};b.onload=b.va=function(){a.bb(c);b.Da();a.tb();a.ga();a.q=0;a.ka();if(b.Ba){b.Ba=!1;try{a.doPostbacks(a.X(b.responseText))}catch(d){}}};b.onabort=b.onerror=b.Ha=function(){b.Da();(a.trackOffline||
a.qa)&&a.q&&a.i.unshift(a.sb);a.q=0;a.ma>a.O&&a.Qa(a.i);a.ga();a.ua(500)};b.onreadystatechange=function(){4==b.readyState&&(200==b.status?b.va():b.Ha())};a.Pa=a.C();if(1==d||2==d){var e=c.indexOf("?");f=c.substring(0,e);e=c.substring(e+1);e=e.replace(/&callback=[a-zA-Z0-9_.\[\]]+/,"");1==d?(b.open("POST",f,!0),b.send(e)):2==d&&(b.open("POST",f),b.send(e))}else if(b.src=c,3==d){if(a.Na)try{f.removeChild(a.Na)}catch(g){}f.firstChild?f.insertBefore(b,f.firstChild):f.appendChild(b);a.Na=a.B}b.G=setTimeout(function(){b.G&&
(b.complete?b.va():(a.trackOffline&&b.abort&&b.abort(),b.Ha()))},5E3);a.sb=c;a.B=k["s_i_"+a.replace(a.account,",","_")]=b;if(a.useForcedLinkTracking&&a.K||a.A)a.forcedLinkTrackingTimeout||(a.forcedLinkTrackingTimeout=250),a.ha=setTimeout(a.ga,a.forcedLinkTrackingTimeout)};a.tb=function(){if(a.ra()&&!(a.Oa>a.O))try{k.localStorage.removeItem(a.pa()),a.Oa=a.C()}catch(c){}};a.Qa=function(c){if(a.ra()){a.Sa();try{k.localStorage.setItem(a.pa(),k.JSON.stringify(c)),a.O=a.C()}catch(b){}}};a.Sa=function(){if(a.trackOffline){if(!a.offlineLimit||
0>=a.offlineLimit)a.offlineLimit=10;for(;a.i.length>a.offlineLimit;)a.Ga()}};a.forceOffline=function(){a.qa=!0};a.forceOnline=function(){a.qa=!1};a.pa=function(){return a.offlineFilename+"-"+a.visitorNamespace+a.account};a.C=function(){return(new Date).getTime()};a.La=function(a){a=a.toLowerCase();return 0!=a.indexOf("#")&&0!=a.indexOf("about:")&&0!=a.indexOf("opera:")&&0!=a.indexOf("javascript:")?!0:!1};a.setTagContainer=function(c){var b,d,f;a.Mb=c;for(b=0;b<a._il.length;b++)if((d=a._il[b])&&"s_l"==
d._c&&d.tagContainerName==c){a.R(d);if(d.lmq)for(b=0;b<d.lmq.length;b++)f=d.lmq[b],a.loadModule(f.n);if(d.ml)for(f in d.ml)if(a[f])for(b in c=a[f],f=d.ml[f],f)!Object.prototype[b]&&("function"!=typeof f[b]||0>(""+f[b]).indexOf("s_c_il"))&&(c[b]=f[b]);if(d.mmq)for(b=0;b<d.mmq.length;b++)f=d.mmq[b],a[f.m]&&(c=a[f.m],c[f.f]&&"function"==typeof c[f.f]&&(f.a?c[f.f].apply(c,f.a):c[f.f].apply(c)));if(d.tq)for(b=0;b<d.tq.length;b++)a.track(d.tq[b]);d.s=a;break}};a.Util={urlEncode:a.escape,urlDecode:a.unescape,
cookieRead:a.cookieRead,cookieWrite:a.cookieWrite,getQueryParam:function(c,b,d,f){var e,g="";b||(b=a.pageURL?a.pageURL:k.location);d=d?d:"\x26";if(!c||!b)return g;b=""+b;e=b.indexOf("?");if(0>e)return g;b=d+b.substring(e+1)+d;if(!f||!(0<=b.indexOf(d+c+d)||0<=b.indexOf(d+c+"\x3d"+d))){e=b.indexOf("#");0<=e&&(b=b.substr(0,e)+d);e=b.indexOf(d+c+"\x3d");if(0>e)return g;b=b.substring(e+d.length+c.length+1);e=b.indexOf(d);0<=e&&(b=b.substring(0,e));0<b.length&&(g=a.unescape(b));return g}},getIeVersion:function(){if(document.documentMode)return document.documentMode;
for(var a=7;4<a;a--){var b=document.createElement("div");b.innerHTML="\x3c!--[if IE "+a+"]\x3e\x3cspan\x3e\x3c/span\x3e\x3c![endif]--\x3e";if(b.getElementsByTagName("span").length)return a}return null}};a.H="supplementalDataID timestamp dynamicVariablePrefix visitorID marketingCloudVisitorID analyticsVisitorID audienceManagerLocationHint authState fid vmk visitorMigrationKey visitorMigrationServer visitorMigrationServerSecure charSet visitorNamespace cookieDomainPeriods fpCookieDomainPeriods cookieLifetime pageName pageURL customerPerspective referrer contextData currencyCode lightProfileID lightStoreForSeconds lightIncrementBy retrieveLightProfiles deleteLightProfiles retrieveLightData".split(" ");
a.g=a.H.concat("purchaseID variableProvider channel server pageType transactionID campaign state zip events events2 products audienceManagerBlob tnt".split(" "));a.na="timestamp charSet visitorNamespace cookieDomainPeriods cookieLifetime contextData lightProfileID lightStoreForSeconds lightIncrementBy".split(" ");a.P=a.na.slice(0);a.Aa="account allAccounts debugTracking visitor visitorOptedOut trackOffline offlineLimit offlineThrottleDelay offlineFilename usePlugins doPlugins configURL visitorSampling visitorSamplingGroup linkObject clickObject linkURL linkName linkType trackDownloadLinks trackExternalLinks trackClickMap trackInlineStats linkLeaveQueryString linkTrackVars linkTrackEvents linkDownloadFileTypes linkExternalFilters linkInternalFilters useForcedLinkTracking forcedLinkTrackingTimeout trackingServer trackingServerSecure ssl abort mobile dc lightTrackVars maxDelay expectSupplementalData usePostbacks registerPreTrackCallback registerPostTrackCallback AudienceManagement".split(" ");
for(m=0;250>=m;m++)76>m&&(a.g.push("prop"+m),a.P.push("prop"+m)),a.g.push("eVar"+m),a.P.push("eVar"+m),6>m&&a.g.push("hier"+m),4>m&&a.g.push("list"+m);m="pe pev1 pev2 pev3 latitude longitude resolution colorDepth javascriptVersion javaEnabled cookiesEnabled browserWidth browserHeight connectionType homepage pageURLRest marketingCloudOrgID".split(" ");a.g=a.g.concat(m);a.H=a.H.concat(m);a.ssl=0<=k.location.protocol.toLowerCase().indexOf("https");a.charSet="UTF-8";a.contextData={};a.offlineThrottleDelay=
0;a.offlineFilename="AppMeasurement.offline";a.Pa=0;a.ma=0;a.O=0;a.Oa=0;a.linkDownloadFileTypes="exe,zip,wav,mp3,mov,mpg,avi,wmv,pdf,doc,docx,xls,xlsx,ppt,pptx";a.w=k;a.d=k.document;try{if(a.Ta=!1,navigator){var v=navigator.userAgent;if("Microsoft Internet Explorer"==navigator.appName||0<=v.indexOf("MSIE ")||0<=v.indexOf("Trident/")&&0<=v.indexOf("Windows NT 6"))a.Ta=!0}}catch(x){}a.ga=function(){a.ha&&(k.clearTimeout(a.ha),a.ha=p);a.l&&a.K&&a.l.dispatchEvent(a.K);a.A&&("function"==typeof a.A?a.A():
a.l&&a.l.href&&(a.d.location=a.l.href));a.l=a.K=a.A=0};a.Ra=function(){a.b=a.d.body;a.b?(a.v=function(c){var b,d,f,e,g;if(!(a.d&&a.d.getElementById("cppXYctnr")||c&&c["s_fe_"+a._in])){if(a.Ca)if(a.useForcedLinkTracking)a.b.removeEventListener("click",a.v,!1);else{a.b.removeEventListener("click",a.v,!0);a.Ca=a.useForcedLinkTracking=0;return}else a.useForcedLinkTracking=0;a.clickObject=c.srcElement?c.srcElement:c.target;try{if(!a.clickObject||a.N&&a.N==a.clickObject||!(a.clickObject.tagName||a.clickObject.parentElement||
a.clickObject.parentNode))a.clickObject=0;else{var h=a.N=a.clickObject;a.la&&(clearTimeout(a.la),a.la=0);a.la=setTimeout(function(){a.N==h&&(a.N=0)},1E4);f=a.Ja();a.track();if(f<a.Ja()&&a.useForcedLinkTracking&&c.target){for(e=c.target;e&&e!=a.b&&"A"!=e.tagName.toUpperCase()&&"AREA"!=e.tagName.toUpperCase();)e=e.parentNode;if(e&&(g=e.href,a.La(g)||(g=0),d=e.target,c.target.dispatchEvent&&g&&(!d||"_self"==d||"_top"==d||"_parent"==d||k.name&&d==k.name))){try{b=a.d.createEvent("MouseEvents")}catch(l){b=
new k.MouseEvent}if(b){try{b.initMouseEvent("click",c.bubbles,c.cancelable,c.view,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)}catch(m){b=0}b&&(b["s_fe_"+a._in]=b.s_fe=1,c.stopPropagation(),c.stopImmediatePropagation&&c.stopImmediatePropagation(),c.preventDefault(),a.l=c.target,a.K=b)}}}}}catch(n){a.clickObject=0}}},a.b&&a.b.attachEvent?a.b.attachEvent("onclick",a.v):a.b&&a.b.addEventListener&&(navigator&&(0<=navigator.userAgent.indexOf("WebKit")&&
a.d.createEvent||0<=navigator.userAgent.indexOf("Firefox/2")&&k.MouseEvent)&&(a.Ca=1,a.useForcedLinkTracking=1,a.b.addEventListener("click",a.v,!0)),a.b.addEventListener("click",a.v,!1))):setTimeout(a.Ra,30)};a.ub();a.Vb||(r?a.setAccount(r):a.F("Error, missing Report Suite ID in AppMeasurement initialization"),a.Ra(),a.loadModule("ActivityMap"))}
function s_gi(r){var a,k=window.s_c_il,p,n,m=r.split(","),s,u,t=0;if(k)for(p=0;!t&&p<k.length;){a=k[p];if("s_c"==a._c&&(a.account||a.oun))if(a.account&&a.account==r)t=1;else for(n=a.account?a.account:a.oun,n=a.allAccounts?a.allAccounts:n.split(","),s=0;s<m.length;s++)for(u=0;u<n.length;u++)m[s]==n[u]&&(t=1);p++}t?a.setAccount&&a.setAccount(r):a=new AppMeasurement(r);return a}AppMeasurement.getInstance=s_gi;window.s_objectID||(window.s_objectID=0);
function s_pgicq(){var r=window,a=r.s_giq,k,p,n;if(a)for(k=0;k<a.length;k++)p=a[k],n=s_gi(p.oun),n.setAccount(p.un),n.setTagContainer(p.tagContainerName);r.s_giq=0}s_pgicq();
(function(window,undefined){var _lm=window.lm;var $=window.jQuery;var lm={viewModels:{ctors:{},instances:{},initialData:{}},urls:{},utility:{selectMenuItem:function(){var lastTab=localStorage.getItem("lastTab");if(lastTab){$(".nav li").removeClass("active");$("#"+lastTab).addClass("active")}}},noConflict:function(){if(window.lm===lm)window.lm=_lm;return lm},SuccessMessage:function(msg){var self=this;self.message=lm.HasValue(msg)?msg:""},ErrorMessage:function(responseText,textStatus,errorThrown){var self=
this;self.responseText=responseText;self.textStatus=lm.HasValue(textStatus)?textStatus:"";self.errorThrown=lm.HasValue(errorThrown)?errorThrown:""},HasValue:function(val){if(typeof val!=="unknown"&&typeof val!=="undefined"&&val!=="undefined"&&val!==null&&val!==""&&val!=="null")return true;else return false},HasNumericValue:function(val){if(HasValue(val)&&!isNaN(parseInt(val)))return true;else return false},Omniture:{doTagImageView:function(lotId,memNumber,linkName,download,addremove,channel,pageName,
server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){},doTagSearchDL:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar50";s.linkTrackEvents=
"None";s.eVar50="search download";s.tl(this,"o","search download");lm.Omniture.ClearVars()},doTagSubmit:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,prop10,eVar10,events";s.linkTrackEvents="event31";s.events=
"event31";s.prop10=memNumber;s.eVar10="D\x3dc10";s.pageName="memeber:Licenses";s.tl(this,"o","Submitconfirm");lm.Omniture.ClearVars()},doTagLiveChat:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.prop1="Live Chat";s.prop10=memNumber;s.linkTrackEvents="event99,event18,event86";s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop1,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.events="event99";s.pageName="Live Chat";s.tl(this,"o","Live Chat");lm.Omniture.ClearVars()},doTagSelectedForPayment:function(lotId,memNumber,totalAmount){s.prop1="Submit Payment";s.prop10=memNumber;s.products=";"+lotId;s.linkTrackEvents="event36,event100,event18,event86";s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop1,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar41,eVar47,eVar48,eVar49,events,products";s.events="event36,event100";s.eVar10=memNumber;
s.eVar41=totalAmount;s.pageName="Submit Payment";s.tl(this,"o","Submit Payment");lm.Omniture.ClearVars()},doTagDownload:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.products=";"+lotId;s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar64,events,products";
s.linkTrackEvents="event62";s.events="event62";s.eVar64=linkName;if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o",linkName);lm.Omniture.ClearVars()},doTagDownloadCustomLinks:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";var downloadTl="o";if(!lm.HasValue(download)&&download!=null&&download!="")downloadTl=
download;if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.products=";";if(lm.HasValue(lotId)&&lotId>0)s.products=s.products+lotId;s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar64,events,products";s.linkTrackEvents="event62";s.events="event62";s.eVar64=linkName;if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,downloadTl,linkName);lm.Omniture.ClearVars()},
doTagMakeOffer:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.products=";"+lotId.toString();s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.linkTrackEvents="event50";s.events="event50";s.prop10=memNumber;s.eVar10="D\x3dc10";
s.pageName="memeber:makeoffer_confirm";s.tl(this,"o","makeoffer_confirm");lm.Omniture.ClearVars()},doTagTransportation:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.products=";"+lotId;s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar65,events,products";
s.linkTrackEvents="event63";s.events="event63";s.eVar65=zipcode;if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","Domestic Shipping Estimate");lm.Omniture.ClearVars()},doTagInternationalShippingEstimate:function(lotId,memNumber,desinationCountry,portName){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.products=";"+lotId;s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar65,eVar91,eVar78,events,products";
s.linkTrackEvents="event173";s.events="event173";if(lm.HasValue(desinationCountry))s.eVar78=desinationCountry;if(lm.HasValue(portName))s.eVar91=portName;if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","International Shipping Estimate");lm.Omniture.ClearVars()},doTagInternationalShippingOrderNow:function(lotId,memNumber,providerName){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.products=";"+lotId;s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar65,eVar92,events,products";
s.linkTrackEvents="event174";s.events="event174";if(lm.HasValue(providerName))s.eVar92=providerName;if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","International Shipping Order Now");lm.Omniture.ClearVars()},doTagInternationalShippingComplete:function(lotId,memNumber){var memberProps="";if(lm.HasValue(memNumber)&&lm.HasValue(lotId)&&memNumber>1){if(lm.HasValue(memNumber)&&memNumber>1)memberProps="prop10,eVar10,";s.products=";"+lotId;s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar65,eVar91,eVar78,events,products";
s.linkTrackEvents="event186";s.events="event186";if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","International Shipping Complete");lm.Omniture.ClearVars()}else return false},doTagWatchList:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){if(!lm.HasValue(memNumber))return;else if(memNumber==0)return;var eventNumber="66";
if(addremove=="add")eventNumber="11";s.products=";"+lotId;s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.linkTrackEvents="event"+eventNumber;s.events="event"+eventNumber;s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","watchlist "+addremove);lm.Omniture.ClearVars()},doTagPasswordSuccess:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,
country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="None";s.linkTrackEvents="event61";s.events="event61";s.tl(this,"o","forgot password");lm.Omniture.ClearVars()},doTagAddCalendar:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&
memNumber>0)memberProps="prop10,eVar10,";s.products=";"+lotId.toString();s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.linkTrackEvents="event64";s.events="event64";if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","add to calendar");lm.Omniture.ClearVars()},doTagLoginSuccess:function(memNumber){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.linkTrackEvents="event33";s.events="event33";s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","login successful");lm.Omniture.ClearVars()},doTagSwitchbackC2:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="None";s.linkTrackEvents="event76";s.events="event76";s.tl(this,"o","User Switched Back to C2");lm.Omniture.ClearVars()},
doTagSellerLogin:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="None";s.linkTrackEvents="event84";s.events="event84";s.tl(this,"o","User Sign in from G2 Member to C3 Seller");lm.Omniture.ClearVars()},doTagViewMap:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,
yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="None";s.linkTrackEvents="event87";s.events="event87";s.tl(this,"o","ViewMap link in lotdetails");lm.Omniture.ClearVars()},doTagClassicView:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="None";s.linkTrackEvents="event88";
s.events="event88";s.tl(this,"o","Classic View");lm.Omniture.ClearVars()},doTagNormalView:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="None";s.linkTrackEvents="event89";s.events="event89";s.tl(this,"o","Normal View");lm.Omniture.ClearVars()},doTagInstaVin:function(lotId,memNumber,linkName,download,addremove,channel,pageName,
server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.products=";"+lotId;s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.linkTrackEvents="event54";s.events="event54";if(memberProps!=""){s.prop10=memNumber;s.eVar10=
"D\x3dc10"}s.tl(this,"o","Epic VIN click");lm.Omniture.ClearVars()},doTagSaveSearch:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event22";s.events="event22";s.pageName=
"savesearch";s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","member save search");lm.Omniture.ClearVars()},doTagCPPageName:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,eVar29";s.linkTrackVars=memberProps+",prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49";
s.pageName=pageName;s.server=server;s.channel=channel;s.pageType="";if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10";s.eVar29=ipaddress}var s_code=s.t();if(s_code)document.write(s_code);lm.Omniture.ClearVars()},doTagRegistrationThankYouPage:function(newBuyerNumber,state,zipCode,country,city,crmId){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar90,prop14,prop15,prop16,prop17,events";
s.linkTrackEvents="event2";s.events="event2";s.pageName="registration";s.prop10=newBuyerNumber;s.evar10=newBuyerNumber;s.prop14=country;s.prop15=state;s.prop16=city;s.prop17=zipCode;s.eVar90=crmId;s.tl(this,"0","registration success");lm.Omniture.ClearVars()},doTagMistypedbidSuccess:function(memNumber,lotId){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event35";s.products=";"+lotId;s.events="event35";s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","member mistyped bid success");
lm.Omniture.ClearVars()},doTagLocationDetails:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="None";s.linkTrackEvents="None";s.tl(this,"o","location_"+yardName);lm.Omniture.ClearVars()},doTagShareTypes:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,
doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){if(pageName==null)pageName=doctitle;var memberProps="";var event="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";if(!lm.HasValue(pageName))pageName=lm.Omniture.PageName;switch(type){case "print":memberProps+="eVar51,";event="event58";s.eVar51=pageName;break;case "email":memberProps+="eVar52,";event="event59";s.eVar52=pageName;break;default:memberProps+="eVar53,";event="event60";s.eVar53=pageName;break}s.linkTrackVars=
memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.linkTrackEvents=event;s.events=event;if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o",type);lm.Omniture.ClearVars()},doTagError500or404:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,
tag){s.linkTrackVars="";s.linkTrackEvents="";s.events="";s.pageName=pageName;var s_code=s.t();if(s_code)document.write(s_code);lm.Omniture.ClearVars()},doCounterMan:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="";s.linkTrackEvents="";s.events="";s.pageName=pageName;s.tl(this,"o","counterman");lm.Omniture.ClearVars()},doTagMemberWidgets:function(lotId,
memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="";s.linkTrackEvents="";s.events="";s.pageName=channel+":"+widgetName;s.server=server;s.channel=channel;s.prop10=memID;s.tl(this,"o","member widgets");lm.Omniture.ClearVars()},doTagSelectedLanguage:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,
city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10";switch(selectedLanguage){case "en_us_EN":selectedLanguage="English";break;case "es_us_ES":selectedLanguage="Spanish";break;case "ar_us_AR":selectedLanguage="Arabic";break;case "de_us_DE":selectedLanguage="Dutch";break;case "fr_ca_FR":selectedLanguage="French Canadian";break;default:selectedLanguage="English";break}s.linkTrackVars=
memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,prop33";s.prop33=selectedLanguage;if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","language selected:"+selectedLanguage);lm.Omniture.ClearVars()},doTagTimeZone:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,
imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.products="";s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.linkTrackEvents="event70";s.events="event70";if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","time zone selection");lm.Omniture.ClearVars()},doTagNearestLocationSelect:function(lotId,memNumber,
linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){if(memNumber>0){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49;events";s.linkTrackEvents="event71";s.events="event71";s.prop10=memNumber;s.eVar10=memNumber}else{s.linkTrackVars="events";s.linkTrackEvents="event71";s.events=
"event71"}s.tl(this,"o","nearest location select");lm.Omniture.ClearVars()},doTagDownloadsaleData:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="events,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49";s.prop10=memNumber;s.eVar10=memNumber;
s.eVar50="saledata";s.linkTrackEvents="event16";s.events="event16";s.tl(this,"d","CSV Sale Data Download");lm.Omniture.ClearVars()},doTagCopartVideoPlay:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){if(memNumber>0){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.prop10=memNumber;s.eVar10=memNumber;s.linkTrackEvents="event72";s.events="event72"}else{s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event72";s.events="event72"}s.tl(this,"o","Copart Video Tracking");lm.Omniture.ClearVars()},doTagConditionReportView:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,
widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){if(memNumber>0){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.prop10=memNumber;s.eVar10=memNumber;s.linkTrackEvents="event29";s.events="event29";s.products=lotId;s.linkTrackEvents="event29";s.tl(this,"o","View Condition Report")}lm.Omniture.ClearVars()},doTagLotImages:function(lotId,memNumber,linkName,download,
addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){},doTagWebHalfBannerSiteDetection:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.linkTrackVars=
memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar29,eVar28,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event83";s.events="event83";if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","WebHalfBannerSiteDetection");lm.Omniture.ClearVars()},doTagConditionReportOrder:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,
memNum,videoUrl,imageNumber,tag){if(memNumber>0){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.prop10=memNumber;s.eVar10=memNumber;s.linkTrackEvents="event77";s.events="event77";s.products=lotId;s.tl(this,"o","Order Condition Report")}lm.Omniture.ClearVars()},doTagMultiLotBidClick:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,
city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10,";s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar29,eVar28,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event92";s.events="event92";if(memberProps!=""){s.prop10=memNumber;s.eVar10=memNumber}s.tl(this,"o","Multi Lot bid click");lm.Omniture.ClearVars()},
doTagMultiLotBidSubmit:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10";s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event93";s.events=
"event93";if(memberProps!=""){s.prop10=memNumber;s.eVar10=memNumber}s.tl(this,"o","Multi Lot bid submit");lm.Omniture.ClearVars()},doTagViewAllLaneSalelist:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10";s.linkTrackVars=memberProps+"prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.linkTrackEvents="event85";s.events="event85";if(memberProps!=""){s.prop10=memNumber;s.eVar10="D\x3dc10"}s.tl(this,"o","view lanes saleslist");lm.Omniture.ClearVars()},doTagDownloadAllImages:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10";s.linkTrackVars=memberProps+
"events,products";s.linkTrackEvents="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,event94";s.events="event94";if(memberProps!=""){s.prop10=memNumber;s.eVar10=memNumber}if(lm.HasValue(lotId)&&lotId>0)s.products=lotId;s.tl(this,"d","Download All Images");lm.Omniture.ClearVars()},doTag:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,
memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="None";s.linkTrackEvents="None";s.tl(this,"o",tag);lm.Omniture.ClearVars()},doTagSearchInventory:function(memNumber,query,total_results,zipcode){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10";if(memberProps!=""){s.prop10=memNumber;s.eVar10=memNumber;s.pageName="member:searchResults";s.prop1="member:search"}else{s.prop1="public:search";s.pageName="public:searchResults"}var eventNum=19;memberProps+=
",prop5";if(query=="*"||AppUtils.isUndefined(query))s.prop5="vehicle_finder";else{eventNum=20;s.prop5="keyword_search";s.prop6=query;memberProps+=",prop6"}if(!AppUtils.isUndefined(zipcode)){s.prop5="sort_search_by_zipcode";s.prop9=zipcode;memberProps+=",prop9"}memberProps+=",prop1,prop8";s.prop8=total_results;s.linkTrackEvents="event6,event18,event86,event"+eventNum;s.events="event6,event"+eventNum;s.eVar5="D\x3dc5";s.eVar6="D\x3dc6";s.eVar8="D\x3dc8";memberProps+=",prop1";s.linkTrackVars=memberProps+
",prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar5,eVar6,eVar8,eVar67,events";var s_code=s.t();if(s_code)document.write(s_code);lm.Omniture.ClearVars()},doTagBeginRegistration:function(){s.prop1="public:registration";s.linkTrackEvents="event1,event18,event86";s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop1,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.events="event1";
s.pageName="public:registration";s.tl(this,"o","Begin Registration");lm.Omniture.ClearVars()},doTagPrelimBid:function(memNumber,lotId,maxBid,currentBid){var memberProps="";if(lm.HasValue(memNumber)&&memNumber>0)memberProps="prop10,eVar10";if(memberProps!=""){s.prop10=memNumber;s.eVar10=memNumber}var events="";if(!AppUtils.isUndefined(maxBid)){s.event9=maxBid;events+="event9,"}if(!AppUtils.isUndefined(currentBid)){s.event55=currentBid;events+="event55"}var products="";if(lm.HasValue(lotId)&&lotId>
0){s.products=";"+lotId.toString();if(s.event9)products+="Event9 \x3d "+maxBid+" | ";if(s.event55)products+="Event55 \x3d "+currentBid;s.products+=";;;"+products}s.evar10="Dc\x3d10";s.events="event7,"+events;s.linkTrackEvents=s.events;s.linkTrackVars=memberProps+",prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events,products";s.pageName="Prelim Bidding";s.tl(this,"o","Prelim Bidding");lm.Omniture.ClearVars()},doTagPSGLogin:function(memNumber){s.linkTrackVars=
"prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event37";s.events="event37";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","PSG login successful");lm.Omniture.ClearVars()},doTagUseAnotherPayment:function(memNumber){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.linkTrackEvents="event38";s.events="event38";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Use another payment method");lm.Omniture.ClearVars()},doTagPaymentCancelClick:function(memNumber){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event39";s.events="event39";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Payment Cancel");lm.Omniture.ClearVars()},
doTagBuyItNowConfirm:function(memNumber,lotId,amount){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event44,event45";s.events="event44,event45";s.prop10=memNumber;s.eVar10=memNumber;s.products=";"+lotId+";;;event45\x3d"+amount;s.tl(this,"o","Buy It Now Submission");lm.Omniture.ClearVars()},doTagBuyItNowClick:function(lotId,memNumber,linkName,download,addremove,
channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event49";s.events="event49";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Buy It Now Click");lm.Omniture.ClearVars()},doTagViewConditionReport:function(){s.linkTrackVars=
"prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event23";s.events="event23";s.tl(this,"o","View Condition Report");lm.Omniture.ClearVars()},doTagIndividualFormSubmitRegistration:function(pairedWithBroker){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar79,events";s.linkTrackEvents=
"event107";s.events="event107";s.eVar79=pairedWithBroker;s.tl(this,"o","Registration Individual Form Submit");lm.Omniture.ClearVars()},doTagBusinessFormSubmitRegistration:function(){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event108";s.events="event108";s.tl(this,"o","Registration Business Form Submit");lm.Omniture.ClearVars()},doTagIndividualFormSuccessRegistration:function(memNumber,
pairedWithBroker,crmId){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar79,eVar90,events";s.linkTrackEvents="event109";s.events="event109";s.prop10=memNumber;s.eVar10=memNumber;s.eVar79=pairedWithBroker;s.eVar90=crmId;s.tl(this,"o","Registration Individual Complete");lm.Omniture.ClearVars()},doTagBusinessFormSuccessRegistration:function(memNumber,crmId){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar90,events";
s.linkTrackEvents="event110";s.events="event110";s.prop10=memNumber;s.eVar10=memNumber;s.eVar90=crmId;s.tl(this,"o","Registration Business Complete");lm.Omniture.ClearVars()},doTagPaymentSelectedWU:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.linkTrackEvents="event4";s.events="event4";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","WU Payment Selection");lm.Omniture.ClearVars()},doTagPaymentStartedWU:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.linkTrackEvents="event5";s.events="event5";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","WU Payment Started");lm.Omniture.ClearVars()},doTagSubmitPaymentWU:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.linkTrackEvents="event24";s.events="event24";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","WU Payment Submitted");lm.Omniture.ClearVars()},doTagSaveEmailSubscription:function(memNumber){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event101";s.events="event101";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Message Settings Subscription Save");lm.Omniture.ClearVars()},
doTagSaveVehicleInterest:function(memNumber){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event102";s.events="event102";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Message Settings Vehicle Interest Save");lm.Omniture.ClearVars()},doTagSaveVehiclePurpose:function(memNumber){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.linkTrackEvents="event103";s.events="event103";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Message Settings Vehicle Purpose Save");lm.Omniture.ClearVars()},doTagSaveBuyerType:function(memNumber){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event104";s.events="event104";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Message Settings Buyer Type Save");
lm.Omniture.ClearVars()},doTagSavePreferredLocation:function(memNumber){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event105";s.events="event105";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Message Settings Pref Location Save");lm.Omniture.ClearVars()},doTagSaveEmailLanguage:function(memNumber){s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop10,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";
s.linkTrackEvents="event106";s.events="event106";s.prop10=memNumber;s.eVar10=memNumber;s.tl(this,"o","Message Settings  Save");lm.Omniture.ClearVars()},doTagBusinessRegistration:function(){s.prop1="Registration-Not a Business";s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop1,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";s.linkTrackEvents="event111";s.events="event111";s.prop1="public: registration-Not a Business";s.pageName="Registration-Not a Business";
s.tl(this,"o","Registration-Not a Business");lm.Omniture.ClearVars()},doTagConditionReport:function(conditionReportGrade){s.prop1="Lot Details Page: Condition Report";s.linkTrackEvents="event112";s.linkTrackVars="prop30,prop31,prop32,prop46,prop47,prop48,prop49,prop50,prop1,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar39,events";s.events="event112";s.eVar39=conditionReportGrade.toString();s.pageName="Condition Report";s.tl(this,"o","Condition Report");lm.Omniture.ClearVars()},doTagConditionReportNew:function(memNumber){s.prop1=
"Lot Details Page: Condition Report";s.linkTrackEvents="event112";s.linkTrackVars="prop10,eVar10,events";s.events="event112";if(memNumber)s.prop10=memNumber;else s.prop10=1;s.eVar10="D\x3dc10";s.pageName="Condition Report";s.tl(this,"o","Condition Report");lm.Omniture.ClearVars()},doTagConditionReportComplete:function(memNumber){s.prop1="Lot Details Page: Condition Report Complete";s.linkTrackEvents="event77";s.linkTrackVars="prop10,eVar10,events";s.events="event77";if(memNumber)s.prop10=memNumber;
else s.prop10=1;s.eVar10="D\x3dc10";s.pageName="Condition Report Complete";s.tl(this,"o","Condition Report Complete");lm.Omniture.ClearVars()},doTagBuyConditionReport:function(memNumber){s.prop1="Lot Details Page: Buy Condition Report";s.linkTrackEvents="event155";s.linkTrackVars="prop10,eVar10,events";s.events="event155";if(memNumber)s.prop10=memNumber;else s.prop10=1;s.eVar10="D\x3dc10";s.pageName="Buy Condition Report";s.tl(this,"o","Buy Condition Report");lm.Omniture.ClearVars()},doTagInspectionServicesHeader_Footer:function(lotId,
memNumber){s.prop1="Inspection Page - Header_Footer";s.linkTrackEvents="event151";s.linkTrackVars="prop10,eVar10,events";s.events="event151";if(memNumber)s.prop10=memNumber;else s.prop10=1;s.eVar10="D\x3dc10";s.pageName="Inspection Services Header_Footer";s.tl(this,"o","Inspection Services Header_Footer");lm.Omniture.ClearVars()},doTagInspectionServicesLotDetails:function(memNumber){s.prop1="Inspection Page - Lot Details";s.linkTrackEvents="event152";s.linkTrackVars="prop10,eVar10,events";s.events=
"event152";if(memNumber)s.prop10=memNumber;else s.prop10=1;s.eVar10="D\x3dc10";s.pageName="InspectionServices LotDetails";s.tl(this,"o","InspectionServices LotDetails");lm.Omniture.ClearVars()},doTagInspectionServicesAdvantage:function(memNumber){s.prop1="Inspection Page - Advantage";s.linkTrackEvents="event153";s.linkTrackVars="prop10,eVar10,events";if(memNumber)s.prop10=memNumber;else s.prop10=1;s.events="event153";s.pageName="Inspection Services Advantage";s.tl(this,"o","Inspection Services Advantage");
lm.Omniture.ClearVars()},doTagRunLights:function(runLights){s.prop1="Lot Details Page: Run Lights";s.linkTrackEvents="";s.linkTrackVars="eVar63,prop1,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,prop1,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48";s.eVar63=runLights.toString();s.pageName="Run Lights";s.tl(this,"o","Run Lights");lm.Omniture.ClearVars()},doTagRecEngine:function(recLotEngine){s.linkTrackVars="prop10,eVar10,eVar25,eVar38,eVar40,events";s.linkTrackEvents="event114";s.events=
"event114";s.prop10=recLotEngine.memNumber||"1";s.eVar10="D\x3dc10";if(recLotEngine.recEngineLotNumber)s.eVar25=recLotEngine.recEngineLotNumber;if(recLotEngine.parentLotNumber)s.eVar38=recLotEngine.parentLotNumber;s.eVar40=recLotEngine.clickedLotIndex;s.tl(this,"o","Search Recommendation");lm.Omniture.ClearVars()},doTagHomePageRec:function(recLotEngine){s.linkTrackVars="prop10,eVar10,eVar81,eVar82,events";s.linkTrackEvents="event128";s.events="event128";s.prop10=recLotEngine.memNumber||"1";s.eVar10=
"D\x3dc10";if(recLotEngine.recEngineLotNumber)s.eVar81=recLotEngine.recEngineLotNumber;s.eVar82=recLotEngine.clickedLotIndex;s.tl(this,"o","HomePage Recommendations");lm.Omniture.ClearVars()},doTagQuickPick:function(lotId,memNumber,linkName){s.linkTrackVars="prop10,eVar10,eVar80,events";s.linkTrackEvents="event122,event123,event124,event125";s.eVar10="D\x3dc10";if(memNumber)s.prop10=memNumber;switch(linkName){case "tabTrending":s.events="event122";s.tl(this,"o","Quick Pick Trending");break;case "tabFeatured":s.events=
"event123";s.tl(this,"o","Quick Pick Featured");break;case "tabMakes":s.events="event124";s.tl(this,"o","Quick Pick Makes");break;case "tabTypes":s.events="event125";s.tl(this,"o","Quick Pick Types");break;default:break}lm.Omniture.ClearVars()},doTagLocationInfo:function(locationTrack){s.linkTrackVars="prop10,eVar10,eVar80,events";s.linkTrackEvents="event127";s.events="event127";s.eVar80=locationTrack.locationInfo;if(locationTrack.memberId)s.prop10=locationTrack.memberId;s.eVar10="D\x3dc10";s.tl(this,
"o","HomePage Change Location");lm.Omniture.ClearVars()},doTagNeedHelp:function(lotId,memNumber){s.linkTrackVars="events";s.linkTrackEvents="event126";s.events="event126";if(lm.HasValue(memNumber)){s.prop10=memNumber;s.eVar10="D\x3dc10";s.linkTrackVars=s.linkTrackVars+",prop10,eVar10"}s.tl(this,"o","Need Help");lm.Omniture.ClearVars()},doTagHelpSearchInfo:function(helpSearchInfo){s.linkTrackVars="eVar83,events";s.linkTrackEvents="event129";s.events="event129";s.eVar83=helpSearchInfo.siteSearchText;
if(lm.HasValue(helpSearchInfo.memNumber)){s.prop10=helpSearchInfo.memNumber;s.eVar10="D\x3dc10";s.linkTrackVars=s.linkTrackVars+",prop10,eVar10"}s.tl(this,"o","Copart Help Center Search");lm.Omniture.ClearVars()},doTagHomePageBannerZoneId:function(bannerTrackingInfo){s.linkTrackVars="prop10,eVar10,eVar84,events";s.linkTrackEvents="event130";s.events="event130";s.eVar84=bannerTrackingInfo.zoneid;if(bannerTrackingInfo.memNumber)s.prop10=bannerTrackingInfo.memNumber;else s.prop10=1;s.eVar10="D\x3dc10";
s.tl(this,"o","HomePage banner zone id tracking");lm.Omniture.ClearVars()},doTagSelectBidIncrement:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event131";s.events="event131";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","SelectedBidIncrement");lm.Omniture.ClearVars()},doTagSendToTransporter:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event133";s.events="event133";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";
s.tl(this,"o","SendToTransporter");lm.Omniture.ClearVars()},doTagCancelTransporter:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event135";s.events="event135";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","CancelTransporter");lm.Omniture.ClearVars()},doTagLotDetailsMakeanOffer:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event136";s.events="event136";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o",
"Lot Details Make an Offer");lm.Omniture.ClearVars()},doTagLotDetailsIncreaseOffer:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event137";s.events="event137";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","Lot Details Increase Offer");lm.Omniture.ClearVars()},doTagLotDetailsAcceptOffer:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event138";s.events="event138";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,
"o","Lot Details Accept Offer");lm.Omniture.ClearVars()},doTagLotDetailsBuyitNow:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event139";s.events="event139";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","Lot Details Buy it Now");lm.Omniture.ClearVars()},doTagMyOffersIncreaseOffer:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event140";s.events="event140";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,
"o","My Offers Increase Offer");lm.Omniture.ClearVars()},doTagMyOffersAcceptOffer:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event141";s.events="event141";if(memNumber)s.prop10=memNumber;s.eVar10="D\x3dc10";s.tl(this,"o","My Offers Accept Offer");lm.Omniture.ClearVars()},doTagVehicleAlertsEmail:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event142";s.events="event142";if(memNumber)s.prop10=memNumber;else s.prop10="1";s.eVar10="D\x3dc10";
s.tl(this,"o","Vehicle Alerts Email Submit");lm.Omniture.ClearVars()},doTagVehicleAlertsSMS:function(memNumber){s.linkTrackVars="prop10,eVar10,events";s.linkTrackEvents="event143";s.events="event143";if(memNumber)s.prop10=memNumber;else s.prop10="1";s.eVar10="D\x3dc10";s.tl(this,"o","Vehicle Alerts SMS Submit");lm.Omniture.ClearVars()},doTopNavigationSignInMember:function(){s.linkTrackVars="events";s.linkTrackEvents="event146";s.events="event146";s.pageName="login";s.tl(this,"o","Top navigation Sign In Member");
lm.Omniture.ClearVars()},doTopNavigationRegister:function(){s.linkTrackVars="events";s.linkTrackEvents="event147";s.events="event147";s.pageName="registration";s.tl(this,"o","Top navigation Register");lm.Omniture.ClearVars()},doTagConditionReportInventory:function(){s.linkTrackVars="events";s.linkTrackEvents="event156";s.events="event156";s.tl(this,"o","ConditionReportInventoryClick");lm.Omniture.ClearVars()},doTagConditionReportLandingpage:function(){s.linkTrackVars="events";s.linkTrackEvents="event29";
s.events="event29";s.tl(this,"o","ConditionReportPageView");lm.Omniture.ClearVars()},doTagMoreInformation:function(){s.linkTrackVars="events";s.linkTrackEvents="event157";s.events="event157";s.tl(this,"o","More Information");lm.Omniture.ClearVars()},doVehicleFinderSearch:function(formDetails,memNumber){s.linkTrackVars="prop10,eVar10,eVar87,eVar88,eVar89,events";s.linkTrackEvents="event148";s.events="event148";if(memNumber)s.prop10=memNumber;else s.prop10="1";s.eVar10="D\x3dc10";s.eVar87=formDetails.yearRange;
s.eVar88=formDetails.vehicleMake;s.eVar89=formDetails.model;s.tl(this,"o","Vehicle Finder Search");lm.Omniture.ClearVars()},doTagRegistrationStep1Complete:function(crmId,regType){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,prop14,prop15,prop16,prop17,events";if(lm.HasValue(regType)&&regType==="indv"){s.linkTrackEvents="event107,event159";s.events="event107,event159"}else{s.linkTrackEvents="event108,event159";
s.events="event108,event159"}s.pageName="registration step1";if(lm.HasValue(crmId)){s.eVar90=crmId;s.linkTrackVars=s.linkTrackVars+",eVar90"}s.tl(this,"0","registration step1 complete");lm.Omniture.ClearVars()},doTagRegistrationStep3Complete:function(docUpload,crmId,regType){s.linkTrackVars="prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,prop14,prop15,prop16,prop17,events";if(lm.HasValue(docUpload)&&docUpload==="success"){s.linkTrackEvents=
"event2,event134";s.events="event2,event134"}else{s.linkTrackEvents="event2";s.events="event2"}s.pageName="registration step3";if(lm.HasValue(regType)&&regType==="indv"){s.linkTrackEvents=s.linkTrackEvents+",event109";s.events=s.events+",event109"}else if(lm.HasValue(regType)&&regType==="busi"){s.linkTrackEvents=s.linkTrackEvents+",event110";s.events=s.events+",event110"}if(lm.HasValue(crmId)){s.eVar90=crmId;s.linkTrackVars=s.linkTrackVars+",eVar90"}s.tl(this,"0","registration success");lm.Omniture.ClearVars()},
doTagRegistrationStep2Complete:function(memNumber,memShipType,promoCode,promoAmount,paymentType,savePayment,autoPay,crmId){var strEvents="";if(lm.HasValue(memShipType)&&memShipType==="BASIC365D")strEvents="event160,event161";else strEvents="event160,event162";switch(paymentType){case "CRDCARD":strEvents=strEvents+",event164";break;case "PAYPAL":strEvents=strEvents+",event165";break;case "GPAY":strEvents=strEvents+",event166";break;case "APLPAY":strEvents=strEvents+",event169";break;default:strEvents;
break}if(lm.HasValue(autoPay))strEvents=strEvents+",event167";if(lm.HasValue(savePayment))strEvents=strEvents+",event168";s.linkTrackEvents=strEvents;s.events=strEvents;s.pageName="registration step2 payment";if(memNumber)s.prop10=memNumber;else s.prop10="1";s.eVar10="D\x3dc10";if(lm.HasValue(promoCode)&&lm.HasValue(promoAmount)){s.eVar77=promoCode;s.eVar93=promoAmount;s.linkTrackVars="prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,eVar77,eVar93,events"}else s.linkTrackVars=
"prop10,prop30,prop31,prop32,prop45,prop46,prop47,prop48,prop49,prop50,eVar10,eVar28,eVar29,eVar30,eVar31,eVar32,eVar47,eVar48,eVar49,events";if(lm.HasValue(crmId)){s.eVar90=crmId;s.linkTrackVars=s.linkTrackVars+",eVar90"}s.tl(this,"0","registration step2 complete");lm.Omniture.ClearVars()},doTagVideoTrackingForIndividual:function(){s.linkTrackVars="events";s.linkTrackEvents="event188";s.events="event188";s.tl(this,"o","Registration-Video-Individual");lm.Omniture.ClearVars()},doTagVideoTrackingForBusiness:function(){s.linkTrackVars=
"events";s.linkTrackEvents="event189";s.events="event189";s.tl(this,"o","Registration-Video-Business");lm.Omniture.ClearVars()},ClearVars:function(lotId,memNumber,linkName,download,addremove,channel,pageName,server,ipaddress,country,state,city,zipcode,yardname,type,doctitle,widgetName,memId,selectedLanguage,memNum,videoUrl,imageNumber,tag){for(var i=0;i<200;i++){s["prop"+i]="";s["eVar"+i]=""}var svarArr=["pageName","channel","products","events","campaign","purchaseID","state","zip","server","linkName",
"pageURL"];for(var i=0;i<svarArr.length;i++)s[svarArr[i]]=""},PageName:""}};$(document).ready(function(){$(".nav li").click(function(){$(".nav li").removeClass("active");$(this).addClass("active");localStorage.setItem("lastclicked",$(this).attr("id"))})});window.copartOmnitureCallOne=function(functionName,parameter){try{lm.Omniture[functionName](parameter)}catch(error){console.log("Site catalyst function "+functionName+" returned an error: "+error)}};window.copartOmnitureCall=function(functionName,
parameter0,parameter1,parameter2,parameter3,parameter4,parameter5,parameter6,parameter7,parameter8,parameter9,parameter10,parameter11,parameter12,parameter13,parameter14,parameter15,parameter16,parameter17,parameter18,parameter19,parameter20,parameter21,parameter22,parameter23){try{lm.Omniture[functionName](parameter0,parameter1,parameter2,parameter3,parameter4,parameter5,parameter6,parameter7,parameter8,parameter9,parameter10,parameter11,parameter12,parameter13,parameter14,parameter15,parameter16,
parameter17,parameter18,parameter19,parameter20,parameter21,parameter22,parameter23)}catch(error){console.log("Site catalyst function "+functionName+" returned an error: "+error)}};window.copartOmnitureCallMulti=function(functionName,parameters){try{var finalParameters=[];parameters.forEach(function(param){param=param||"";finalParameters.push("'"+param+"'")});eval("lm.Omniture."+functionName+"("+finalParameters+")")}catch(error){console.log("Site catalyst function "+functionName+" returned an error: "+
error)}};window.lm=lm})(window);String.prototype.HasValue=function(){return window.lm.HasValue(this)};String.prototype.HasNumericValue=function(){return window.lm.HasNumericValue(this)};String.prototype.emptyIfNullOrEmpty=function(){var val=this;if(window.lm.HasValue(val))return val;else return""};String.prototype.format=function(){var args=arguments;return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!="undefined"?args[number]:match})};"use strict";
function SellVehicleVO(params){ModelBase(this);var self=this;if(params==null)params={};self.vehicleMake=params.vehicleMake;self.vehicleModel=params.vehicleModel;self.vehicleYear=params.vehicleYear;self.firstName=params.firstName;self.lastName=params.lastName;self.phoneNumber=params.phoneNumber;self.eMailID=params.eMailID;self.zipPostalCode=params.zipPostalCode;self.referralCode=params.referralCode;self.isLoaned=params.isLoaned;self.approxMilesRun=params.approxMilesRun;self.businessName=params.businessName;
self.streetAddress1=params.streetAddress1;self.streetAddress2=params.streetAddress2;self.city=params.city;self.state=params.state;self.vehicleRegistration=params.vehicleRegistration}
function COEModel(params){ModelBase(this);var self=this;params=params||{};self.coeStatus=params.coeStatus;self.coeSentDateUTC=params.coeSentDateUTC;self.coeReceivedDateUTC=params.coeReceivedDateUTC;self.coeReversedDateUTC=params.coeReversedDateUTC;self.coeSentDocumentUrl=params.coeSentDocumentUrl;self.coeReceivedDocumentUrl=params.coeReceivedDocumentUrl}
function PaymentsDueGlobal(params){ModelBase(this);params=params||{};var self=this;self.totalBillAmount=params.totalBillAmount;self.billDueAmount=params.billDueAmount;self.invoiceNumber=params.invoiceNumber;self.facilityId=params.facilityId;self.facilityName=params.facilityName;self.billDescription=params.billDescription;self.saleDateUtc=params.saleDateUtc;self.highBidAmount=params.highBidAmount;self.currencyCode=params.currencyCode;self.entity=params.entity;self.lastInvoicePaidDateUtc=params.lastInvoicePaidDateUtc;
self.lotLeftYardDateUtc=params.lotLeftYardDateUtc;self.billId=params.billId}"use strict";
function BuildSheetVO(params){ModelBase(this);var self=this;if(params==null)params={};self.year=params.year;self.vin=params.vin;self.make=params.make;self.model=params.model;self.trim=params.trim;self.color=params.color;self.vehicleType=params.vehicleType;self.bodyStyle=params.bodyStyle;self.fuel=params.fuel;self.cylinders=params.cylinders;self.modelYear=params.modelYear;self.engine=params.engine;self.transmission=params.transmission;self.yearOfManufacture=params.yearOfManufacture;self.co2Emission=
params.co2Emission;self.euroNorm=params.euroNorm;self.seats=params.seats;self.doors=params.doors;self.drive=params.drive;self.manufacturedCountry=params.manufacturedCountry;self.manufacturerName=params.manufacturerName;self.weight=params.weight;self.enginePower=params.enginePower;if(params.equipment&&params.equipment.seriesEquipment)self.seriesEquipment=params.equipment.seriesEquipment;if(params.equipment&&params.equipment.specialEquipment)self.specialEquipment=params.equipment.specialEquipment}
app.factory("searchCriteriaFactory",["$location","$filter",function($location,$filter){var self=this;var searchCriteriaMap={};function lotSearchCriteria(){var self=this;var MISC=[];var sortByZip=false;var buyerEnteredZip=null;var displayStr=null;var milesAway=null;var searchCriteriaObj=null;self.setSortByZip=function(sortByZipValue){sortByZip=sortByZipValue};self.getSortByZip=function(){return sortByZip};self.setBuyerEnteredZip=function(zipCode){buyerEnteredZip=zipCode};self.getBuyerEnteredZip=function(){return buyerEnteredZip};
self.setMiscFilter=function(miscFilter){MISC=miscFilter};self.getMiscFilter=function(){return MISC};self.getQuery=function(){return $filter("sanitize_html")($location.search().query||"")};self.setQuery=function(query){$location.search().query=query};self.isFreeForm=function(){return $location.search().free||false};self.setFreeForm=function(free){$location.search().free=free||false};self.setDisplayStr=function(msg){displayStr=msg};self.getDisplayStr=function(){return displayStr};self.setMilesAway=
function(miles){milesAway=miles};self.getMilesAway=function(){return milesAway};self.reInitialize=function(newSearchCriteria){MISC=newSearchCriteria.MISC;sortByZip=newSearchCriteria.sortByZip;buyerEnteredZip=newSearchCriteria.buyerEnteredZip;milesAway=newSearchCriteria.milesAway};self.setSearchCriteriaObj=function(searchCriteria){searchCriteriaObj=searchCriteria};self.getSearchCriteriaObj=function(){return searchCriteriaObj};self.reset=function(){MISC=[];sortByZip=false;buyerEnteredZip=null;displayStr=
null;milesAway=null;searchCriteriaObj=null}}self.getSearchCriteria=function(key){return searchCriteriaMap[key]};searchCriteriaMap.lotSearchCriteria=new lotSearchCriteria;searchCriteriaMap.myLotsCriteria=new lotSearchCriteria;searchCriteriaMap.myBidsCriteria=new lotSearchCriteria;searchCriteriaMap.myCounterBidsCriteria=new lotSearchCriteria;searchCriteriaMap.lotWonSearchCriteria=new lotSearchCriteria;searchCriteriaMap.paymentsDueSearchCriteria=new lotSearchCriteria;searchCriteriaMap.titleStatusSearchCriteria=
new lotSearchCriteria;searchCriteriaMap.toBePickedupLotsSearchCriteria=new lotSearchCriteria;searchCriteriaMap.lotsHistorySearchCriteria=new lotSearchCriteria;return self}]);app.constant("searchCriteriaConstants",{lotSearch:"lotSearchCriteria",mylots:"myLotsCriteria",mybids:"myBidsCriteria",mycounterbids:"myCounterBidsCriteria",lotswon:"lotWonSearchCriteria",paymentsdue:"paymentsDueSearchCriteria",titlestatus:"titleStatusSearchCriteria",tobepickeduplots:"toBePickedupLotsSearchCriteria",lotshistory:"lotsHistorySearchCriteria"});
app.directive("dateOfBirthComponent",[function(){return{restrict:"EA",replace:true,scope:{format:"@",dateOptions:"\x3d",dateOfBirth:"\x3d"},templateUrl:"/public/fetchDirective.html?directive\x3dregistration/dateOfBirthComponent\x26agent\x3d007",link:function($scope,element,attrs){var self=$scope;self.dateofBirthPopup={opened:false};self.dateFormat=self.format||"MM/dd/yyyy";self.dateOfBirth=self.dateOfBirth||"";self.dateFormat=self.dateFormat.toUpperCase();self.futureDateValidation=attrs.futureDateValidation||
true;self.validateDate=function(){self.dateOptions.invalidDob=false;if(_.isUndefined(self.dateOfBirth)){self.dateOptions.invalidDob=true;return}if(_.isDate(self.dateOfBirth)){if(!moment(self.dateOfBirth.format(self.dateFormat.toLocaleLowerCase()),self.dateFormat,true).isValid())self.dateOptions.invalidDob=true;if(self.futureDateValidation=="true"&&moment(self.dateOfBirth).isAfter(self.dateOptions.maxDate,"Date"))self.dateOptions.invalidDob=true}};self.open=function(){self.dateofBirthPopup.opened=
true}}}}]);app.directive("viewRadioButtons",["driverSeatService","localStorageService","$location",function(driverSeatService,localStorageService,$location){return{restrict:"AE",link:function(scope,elem,attrs){scope.views=driverSeatService.getdriverSeatViewMappings();scope.selectedView=attrs.view},template:'\x3cli class\x3d"radio" ng-repeat\x3d"view in views"\x3e\x3clabel\x3e\x3ca ng-href\x3d"./driverseat/{{view.label}}"\x3e\x3cinput type\x3d"radio" name\x3d"memberLotSearchSelectionGroup" ng-checked\x3d"selectedView\x3d\x3dview.label"/\x3e{{locale.messages["member.lotseacrh.page.header."+view.label]}}\x3c/label\x3e\x3c/li\x3e'}}]);
app.directive("lotStatusToolTip",["cmsContentService","$q","$http","deviceService",function(cmsContentService,$q,$http,deviceService){return{restrict:"AE",scope:{popoverid:"@"},link:function(scope,element,attrs){var parentFragmentId="Content/"+appInit.regionCode+"/"+appInit.localeString+"/_LotStatus/lotStatusToolTipList.html";var fragmentId=element.attr("fragment-id");var promise=cmsContentService.getFragmentContent(parentFragmentId);element.hover(function(){promise.then(function(fragmentCMSContent){fragmentCMSContent=
jQuery(fragmentCMSContent).filter("#"+fragmentId);var isMobile=window.matchMedia("only screen and (max-width: 760px)");var placement;if(isMobile.matches)placement="bottom";else placement="auto left";element.popover({content:fragmentCMSContent,html:true,placement:placement}).popover("toggle")})},function(){$(".popover").hide();element.popover("hide")})}}}]);
function AddressVO(params){ModelBase(this);var self=this;if(params==null)params={};self.line1=params.line1;self.line2=params.line2;self.city=params.city;self.state=params.state;self.country=params.country;self.postCode=params.postCode}
function PhoneVO(params){ModelBase(this);var self=this;if(params==null)params={};self.number=params.number;self.extension=params.extension;self.prefix=params.prefix;self.type=params.type;self.areaCode=params.areaCode;self.line=params.line;self.phoneNumber=params.phoneNumber;self.phoneType=params.phoneType;self.phoneExtension=params.phoneExtension;self.intlDialCode=params.intlDialCode;self.countryAreaCd=params.countryAreaCd;self.isoTwoCharCntryCode=params.isoTwoCharCntryCode}
function CreditCardVO(params){var self=this;if(params==null)params={};self.cardOwnerName=params.cardOwnerName;self.cardOwnerSurName=params.cardOwnerSurName;self.email=params.email;self.billingAddress=params.billingAddress||new AddressVO;self.cardPhoneNumber=params.cardPhoneNumber||new PhoneVO;self.physicalAddrSameAsBillingAddr=params.physicalAddrSameAsBillingAddr}"use strict";
function CreditCardNumberVO(constants,params){ModelBase(this);var self=this;if(params==null)params={};self.cardName="";self.cardImage="";self.cardNumberValid=false;self.minLength=constants.CREDIT_CARD_MIN_LENGTH;self.maxLength=constants.CREDIT_CARD_MAX_LENGTH;self.securityCodeLabel=constants.CREDIT_CARD_CVN_LABEL;self.securityCodeLength=constants.CREDIT_CARD_CVN_MIN_LENGTH;self.cardCvnValid=false;self.cardCvnEmpty=true;self.creditCardInvalidErrMsg="";self.creditCardCvnInvalidErrMsg="";self.cardType=
""}
app.constant("cyberSourceErrors",{"MicroformError":{"FIELD_UNLOAD_ERROR":{"code":"FIELD_UNLOAD_ERROR","description":"Occurs when you attempt to unload a field that is not currently loaded.","message":""},"FIELD_ALREADY_LOADED":{"code":"FIELD_ALREADY_LOADED","description":"Occurs when you attempt to load a field which is already loaded.","message":""},"FIELD_LOAD_CONTAINER_SELECTOR":{"code":"FIELD_LOAD_CONTAINER_SELECTOR","description":"Occurs when a DOM element cannot be located using the supplied CSS Selector string.","message":""},
"FIELD_LOAD_INVALID_CONTAINER":{"code":"FIELD_LOAD_INVALID_CONTAINER","description":"Occurs when an invalid container parameter has been supplied.","message":""},"FIELD_SUBSCRIBE_UNSUPPORTED_EVENT":{"code":"FIELD_SUBSCRIBE_UNSUPPORTED_EVENT","description":"Occurs when you attempt to subscribe to an unsupported event type.","message":""},"FIELD_SUBSCRIBE_INVALID_CALLBACK":{"code":"FIELD_SUBSCRIBE_INVALID_CALLBACK","description":"Occurs when you supply a callback that is not a function.","message":""},
"CREATE_FIELD_INVALID_FIELD_TYPE":{"code":"CREATE_FIELD_INVALID_FIELD_TYPE","description":"Occurs when you try to create a field with an unsupported type.","message":""},"CREATE_FIELD_DUPLICATE":{"code":"CREATE_FIELD_DUPLICATE","description":"Occurs when a field of the given type has already been added to your integration.","message":""},"CAPTURE_CONTEXT_INVALID":{"code":"CAPTURE_CONTEXT_INVALID","description":"Occurs when you pass an invalid JWT.","message":""},"CAPTURE_CONTEXT_EXPIRED":{"code":"CAPTURE_CONTEXT_EXPIRED",
"description":"Occurs when the JWT you pass has expired.","message":""},"IFRAME_JWT_VALIDATION_FAILED":{"code":"IFRAME_JWT_VALIDATION_FAILED","description":"Occurs when the iframe cannot validate the JWT passed.","message":""},"IFRAME_UNSUPPORTED_FIELD_TYPE":{"code":"IFRAME_UNSUPPORTED_FIELD_TYPE","description":"Occurs when the iframe is attempting to load with an invalid field type.","message":""},"CREATE_TOKEN_NO_FIELDS_LOADED":{"code":"CREATE_TOKEN_NO_FIELDS_LOADED","description":"Occurs when you try to request a token, but no fields have been loaded.",
"message":""},"CREATE_TOKEN_TIMEOUT":{"code":"CREATE_TOKEN_TIMEOUT","description":"Occurs when the createToken call was unable to proceed.","message":""},"CREATE_TOKEN_XHR_ERROR":{"code":"CREATE_TOKEN_XHR_ERROR","description":"Occurs when there is a network error when attempting to create a token.","message":""},"CREATE_TOKEN_NO_FIELDS":{"code":"CREATE_TOKEN_NO_FIELDS","description":"Occurs when the data fields are unavailable for collection.","message":""},"CREATE_TOKEN_VALIDATION_PARAMS":{"code":"CREATE_TOKEN_VALIDATION_PARAMS",
"description":"Occurs when there's an issue with parameters supplied to createToken.","message":""},"CREATE_TOKEN_VALIDATION_FIELDS":{"code":"CREATE_TOKEN_VALIDATION_FIELDS","description":"Occurs when there's a validation issue with data in your loaded fields.","message":""},"CREATE_TOKEN_VALIDATION_SERVERSIDE":{"code":"CREATE_TOKEN_VALIDATION_SERVERSIDE","description":"Occurs when server-side validation rejects the createToken request.","message":""},"CREATE_TOKEN_UNABLE_TO_START":{"code":"CREATE_TOKEN_UNABLE_TO_START",
"description":"Occurs when no loaded field was able to handle the createToken request.","message":""}}});
app.constant("constants",{"MAX_CREDIT_CARD_YEARS_INTO_FUTURE":20,"CREDIT_CARD_MIN_LENGTH":12,"CREDIT_CARD_MAX_LENGTH":19,"CREDIT_CARD_CVN_LABEL":"CVV","CREDIT_CARD_CVN_MIN_LENGTH":3,"CREDIT_CARD_INVALID_ERR_MSG":"Please enter a valid card number","CREDIT_CARD_CVN_INVALID_ERR_MSG":"Please enter a valid {0}","CARD_TYPES":[{"displayName":"VISA","code":"001"},{"displayName":"MASTERCARD","code":"002"}],"SUBSCRIBED":"SUBSCRIBED","NOT_SUBSCRIBED":"NOT_SUBSCRIBED","REGISTRATION_PREF_COL_STR":"registrationPreference.components",
"SUBSCRIPTIONS":"subscriptions","NO":"N","YES":"Y","THANK_YOU":"thankyou","DEFAULT_PAYMENT_METHOD":"CRDCARD","CARD_PAYMENT_METHOD_CODE":"CRDCARD","PAYPAL_PAY_METHOD_CODE":"PAYPAL","APPLE_PAY_METHOD_CODE":"APLPAY","GOOGLE_PAY_METHOD_CODE":"GPAY","APPLE_PAY_LABEL":"Copart Inc.","PAYMENT_METHOD_ORDER":["CRDCARD","PAYPAL","APLPAY","GPAY","WIRE"],"INDIVIDUAL":"individual","BUSINESS":"business","UNEXPECTED_ERROR":"Unexpected Error Occurred","BANNER":"BANNER","PASSWORD_MIN_LENGTH":5,"PASSWORD_MAX_LENGTH":25,
"PATTERN":"^(?\x3d.{5,10}$)(?\x3d.*[0-9])(?\x3d.*[A-Za-z]).*$","ALERT_TYPE_STATUS":{"pendingMemPayment":"MEMBERSHIP_PAYMENT","missingAccInfo":"ADD_ACCOUNT_INFO","noUploadDoc":"NEW_DOCUMENT_UPLOAD","noActiveDoc":"ID_DOCUMENT_PROCESS","unknown":"UNKNOWN"},"DEFAULT_CURRENCY_CODE":"USD","REGISTRATION_USER_ACTIVITY":"MEMBER_REGISTRATION","USER_ACTIONS":{"MEMBERSHIP_PAYMENT":{"redirectUrl":"accountInformation/complete-registration#paymentAccordion"},"ADD_ACCOUNT_INFO":{"redirectUrl":"accountInformation/complete-registration#addressForm"},
"NEW_DOCUMENT_UPLOAD":{"redirectUrl":"./accountInformation/accountSetting?showAcc\x3dY#licenses"},"ID_DOCUMENT_PROCESS":{"redirectUrl":"./accountInformation/accountSetting?showAcc\x3dY#licenses"}},"DEFAULT_COUNTY_FOR_SITE":{"CPRTUS":"USA","CPRTUK":"GBR","CPRTMEA":"ARE","CPRTIE":"IRL","CPRTCA":"CAN","CPRTDE":"DEU","CPRTIN":"IND","CPRTES":"ESP","CRTSUS":"USA","DEFAULT":"USA"},"ALERT_FILTER_ACTION_STATUS":"REMIND_ME_LATER","CITY_PATTERNS":{"CAN":"^[a-zA-Z.'-\\s-]*$",
"DEFAULT":"^[a-zA-Z\\s-]*$"},"ALERTS_REMIND_LATER_STATUS":"REMIND_ME_LATER","DOMESTIC_COUNTRIES":["USA","CAN"],"NAME_PATTERNS":{"CPRTCA":"^[a-zA-Z,.()\";'-*\\\x26\\s]*$","DEFAULT":"^[a-zA-Z\\s]*$"},"ADDRESS_LINE_PATTERNS":{"CAN":"^[a-zA-Z0-9,.#()\";'-*\\\x26\\s]*$","DEFAULT":"^[a-zA-Z0-9- ]*$"},"MAX_ACCEPTED_FILE_SIZE":"10485760","DOCUMENT_UPLOAD_WARNING_MODAL":"documentUploadModal","DOCUMENT_UPLOAD_FAILED_MODAL":"documentUploadFailedInfoModal","PHYSICAL_ADDRESS_REF":"Physical",
"SPACE":" ","FORWARD_SLASH":"/"});app.constant("memberChoicesConstants",{"memberType":"WBDY","businessType":"BUTP","vehicleType":"VHTP","vehiclePurpose":"VPRP","pairWithBroker":"PBRK","copartPrimaryUseCode":"PUCF","emailLanguage":"ELNG","individual":"INDL","business":"BSNS","businessUse":"BSNUSE","personalUse":"PRSLUSE","memberChoicesFilterIds":{"VHTP":"vehicleTypes","VPRP":"vehiclePurpose","DTYP":"dealershipTypes","VSRC":"vehicleSources","BRND":"brands","ELNG":"emailLanguage"}});
app.constant("registrationConstants",{"START_STEP":"STEP1","uk":{"STEP1":{"nextStep":"STEP2","description":"basicInfo"},"STEP2":{"nextStep":"STEP3","description":"addrAndPayment"},"STEP3":{"description":"docUpload"}},"us":{"STEP1":{"nextStep":"STEP2","description":"basicInfo"},"STEP2":{"nextStep":"STEP3","description":"addrAndDocUpload"},"STEP3":{"description":"payment"}},REGISTRATION_ORDER:["MEMBERSHIP_PAYMENT","ADD_ACCOUNT_INFO"],REGISTRATION_USER_ACTIVITY:"MEMBER_REGISTRATION"});
app.constant("navigationUrlConstants",{"ACCOUNT_UPGRADE_MEMBERSHIP":"accountInformation/accountSetting?accSettingUpgradeMem\x3dtrue","DOCUMENT_UPLOAD":"/accountInformation/accountSetting?showAcc\x3dY#licenses","COMPLETE_REGISTRATION":"complete-registration"});
app.factory("$exceptionHandler",["$log","cyberSourceErrors",function($log,cyberSourceErrors){return function myExceptionHandler(exception,cause){if(cyberSourceErrors[exception.name])if(cyberSourceErrors.MicroformError[exception.reason])$log.warn(exception.reason);else $log.warn(exception.reason,cause);else $log.error(exception)}}]);
app.factory("highVolPaymentDueCri",["copartUser",function(copartUser){var self=this;self.highVolPaymentCri=copartUser.getUserConfig().highVolPaymentCri||{};self.setHighVolPaymentCri=function(criteria){self.highVolPaymentCri=criteria};self.getHighVolPaymentCri=function(){return self.highVolPaymentCri};return self}]);
app.directive("paymentdueAdvancedSearch",["copartUser","highVolPaymentDueCri",function(copartUser,highVolPaymentDueCri){return{restrict:"EA",template:'\x3cdiv class\x3d"paymentdue-search" ng-class\x3d"disableModel ? \'dataTable-disable\':\'\'"\x3e\x3ch4\x3e\x3cstrong\x3eFilters Applied:\x3c/strong\x3e\x26nbsp;\x26nbsp;\x3cspan ng-bind-html\x3d"getSelectedCriteria()"\x3e\x3c/span\x3e\x26nbsp;\x26nbsp;\x3cbutton class\x3d"btn btn-primary" type\x3d"button" ng-click\x3d"holdPaymentDueModel()"\x3eUpdate Search\x3c/button\x3e\x3c/h4\x3e\x3c/div\x3e',link:function($scope,
element,attrs){var self=$scope;var defaultEndDate="29991230";var defaultStartDate="19801230";self.locale=$scope.$parent.locale;self.dateOptionsStartDate={invalidDob:false};self.dateOptionsEndDate={invalidDob:false};self.highVolPaymentCri=highVolPaymentDueCri.getHighVolPaymentCri();self.startDate=isNotValid(self.highVolPaymentCri.startDate)||self.highVolPaymentCri.startDate=="19801230"?null:covertToDate(self.highVolPaymentCri.startDate);self.endDate=isNotValid(self.highVolPaymentCri.endDate)||self.highVolPaymentCri.endDate==
"29991230"?null:covertToDate(self.highVolPaymentCri.endDate);self.bidderNumber=self.highVolPaymentCri.bidderNumber;self.isNoBalanceDue=self.highVolPaymentCri.isNoBalanceDue||"Y";self.getSelectedCriteria=function(){return"Invoice Start Date: \x3cstrong\x3e"+(!isNotValid(self.startDate)&&!self.dateOptionsStartDate.invalidDob?self.startDate.format("mm/dd/yyyy")+"\x3c/strong\x3e\x26nbsp;\x26nbsp;":"\x3c/strong\x3e\x26nbsp;\x26nbsp;")+"Invoice End Date: \x3cstrong\x3e"+(!isNotValid(self.endDate)&&!self.dateOptionsEndDate.invalidDob?
self.endDate.format("mm/dd/yyyy")+"\x3c/strong\x3e\x26nbsp;\x26nbsp;":"\x3c/strong\x3e\x26nbsp;\x26nbsp;")+"Bidder Id: \x3cstrong\x3e"+(!isNotValid(self.bidderNumber)?self.bidderNumber+"\x3c/strong\x3e\x26nbsp;\x26nbsp;":"\x3c/strong\x3e\x26nbsp;\x26nbsp;")+"Invoice Status: \x3cstrong\x3e"+self.locale.getMessage("payments.due.advanced.search.label.balance."+self.isNoBalanceDue)+"\x3c/strong\x3e"};function isNotValid(val){return val==null||val==undefined||val==""?true:false}self.getFilterCriteria=
function(){if(self.isHighVolumePayment)return{startDate:isNotValid(self.startDate)?defaultStartDate:typeof self.startDate==="string"?covertToString(self.startDate):self.startDate.format("yyyymmdd"),endDate:isNotValid(self.endDate)?defaultEndDate:typeof self.endDate==="string"?covertToString(self.endDate):self.endDate.format("yyyymmdd"),isNoBalanceDue:self.isNoBalanceDue,bidderNumber:isNotValid(self.bidderNumber)?0:self.bidderNumber};else return{}};self.disableModel=true;self.loadAfterInit=function(){if(self.isHighVolumePayment&&
_.isEmpty(self.highVolPaymentCri)){self.modelStartDate=angular.copy(self.startDate);self.modelEndDate=angular.copy(self.endDate);self.modelBidderNumber=angular.copy(self.bidderNumber);self.modelIsNoBalanceDue=angular.copy(self.isNoBalanceDue);self.firstTime=true;$("#holdPaymentDueModel").modal("show")}self.disableModel=false};self.extendFilterObj=function(data,filterJSONString){highVolPaymentDueCri.setHighVolPaymentCri(self.getFilterCriteria());_.extend(filterJSONString,self.getFilterCriteria())};
function covertToDate(dateVal){return dateVal.substring(4,6)+"/"+dateVal.substring(6,8)+"/"+dateVal.substring(0,4)}function covertToString(dateVal){return dateVal.substring(6,11)+dateVal.substring(0,2)+dateVal.substring(3,5)}self.holdPaymentDueModel=function(){$("#holdPaymentDueModel").modal("show");if(!isNotValid(self.startDate))self.modelStartDate=angular.copy(new Date(self.startDate));if(!isNotValid(self.endDate))self.modelEndDate=angular.copy(new Date(self.endDate));self.errorMessage=false;self.modelBidderNumber=
angular.copy(self.bidderNumber);self.modelIsNoBalanceDue=angular.copy(self.isNoBalanceDue)};self.errorMessage=false;self.reloadPaymentTableByCriteria=function(isValid){self.refineSelectAllFilterError=false;if(!isValid||self.dateOptionsStartDate.invalidDob||self.dateOptionsEndDate.invalidDob)return;if(!self.dateOptionsStartDate.invalidDob&&!self.dateOptionsEndDate.invalidDob&&moment(self.modelStartDate).isAfter(self.modelEndDate)){self.errorMessage=true;return}if(self.modelIsNoBalanceDue=="A")if(!self.modelBidderNumber&&
(!self.modelStartDate||self.modelStartDate==defaultStartDate)&&(!self.modelEndDate||self.modelEndDate==defaultEndDate)){self.refineSelectAllFilterError=true;return}$("#holdPaymentDueModel").modal("hide");if(self.firstTime)self.loadedFirstTime=false;self.firstTime=false;self.startDate=self.modelStartDate;self.endDate=self.modelEndDate;self.bidderNumber=self.modelBidderNumber;self.isNoBalanceDue=self.modelIsNoBalanceDue;self.reloadPaymentTable(self.selectedPaymentMethod)}}}}]);
app.directive("tabs",function(){return{restrict:"E",transclude:true,scope:{},controller:function($scope,$element){var panes=$scope.panes=[];$scope.select=function(pane){angular.forEach(panes,function(pane){pane.selected=false});if(pane.load!==undefined)pane.load();pane.selected=true};this.select=function(pane){$scope.select(pane)};this.addPane=function(pane){if(panes.length===0)$scope.select(pane);panes.push(pane)}},template:'\x3cdiv class\x3d"tabbable"\x3e'+"\x3cul\x3e"+'\x3cli ng-repeat\x3d"pane in panes" data-uName\x3d"{{pane.uname}}" ng-class\x3d"{active:pane.selected}"\x3e'+
'\x3ca href\x3d"" ng-click\x3d"select(pane)"\x3e{{pane.tabTitle}}\x3c/a\x3e'+"\x3c/li\x3e"+"\x3c/ul\x3e"+'\x3cdiv class\x3d"tab-content" ng-transclude\x3e\x3c/div\x3e'+"\x3c/div\x3e",replace:true}});
app.directive("pane",["$http","$templateCache","$controller","$compile",function($http,$templateCache,$controller,$compile){return{restrict:"E",require:"^tabs",transclude:true,scope:{tabTitle:"@",uname:"@"},link:function(scope,element,attrs,tabsCtrl){var templateCtrl,templateScope;if(attrs.template&&attrs.controller)scope.load=function(){$http.get(attrs.template,{cache:$templateCache}).then(function(response){templateScope=scope.$new(false,scope.$parent);templateScope.isTabbedPane=true;templateCtrl=
$controller(attrs.controller,{$scope:templateScope});element.html(response.data);element.children().data("$ngControllerController",templateCtrl);$compile(element.contents())(templateScope)})};tabsCtrl.addPane(scope);if(attrs.tabActive=="true")tabsCtrl.select(scope)},template:'\x3cdiv class\x3d"tab-pane" ng-class\x3d"{active: selected}" ng-transclude\x3e'+"\x3c/div\x3e",replace:true}}]);
app.directive("validPasswordC",function(){return{require:"ngModel",scope:{reference:"\x3dvalidPasswordC"},link:function(scope,elm,attrs,ctrl){ctrl.$parsers.unshift(function(viewValue,$scope){var noMatch=viewValue!=scope.reference;ctrl.$setValidity("noMatch",!noMatch);return noMatch?noMatch:undefined});scope.$watch("reference",function(value){ctrl.$setValidity("noMatch",value===ctrl.$viewValue)})}}});
app.directive("validateEmail",function(){var EMAIL_REGEXP=/^[A-Za-z0-9+_.-]+@(.+)$/;return{require:"ngModel",restrict:"",link:function(scope,elm,attrs,ctrl){if(ctrl&&ctrl.$validators.email)ctrl.$validators.email=function(modelValue){return ctrl.$isEmpty(modelValue)||EMAIL_REGEXP.test(modelValue)}}}});
app.directive("fileToUpload",[function(){return{scope:{fileToUpload:"\x3d"},link:function(scope,element,attributes){element.bind("change",function(changeEvent){scope.fileToUpload=changeEvent.target.files[0];scope.$apply()})}}}]);
app.directive("copartPrint",function(){return{restrict:"E",link:function(scope,element,attrs){element.bind("click",function(evt){evt.preventDefault();PrintElem(attrs.printDiv)});function PrintElem(elem){PrintWithIframe($(elem).html())}function PrintWithIframe(data){if($("iframe#printf").size()==0){$("html").append('\x3ciframe id\x3d"printf" name\x3d"printf"\x3e\x3c/iframe\x3e');var mywindow=window.frames["printf"];mywindow.document.write("\x3chtml\x3e\x3chead\x3e\x3ctitle\x3e\x3c/title\x3e\x3cstyle\x3e@page {margin: 25mm 0mm 25mm 5mm}\x3c/style\x3e"+
"\x3c/head\x3e\x3cbody\x3e\x3cdiv\x3e"+data+"\x3c/div\x3e\x3c/body\x3e\x3c/html\x3e");$(mywindow.document).ready(function(){mywindow.print();setTimeout(function(){$("iframe#printf").remove()},2E3)})}return true}},template:'\x3cdiv class\x3d"printemailshare right"\x3e\x3cul class\x3d"list-unstyled list-inline"\x3e\x3cli\x3e\x3ca href\x3d"#0" onclick\x3d"window.print(); return false;" class\x3d"ng-binding"\x3e\x3ci class\x3d"fa fa-print"\x3e\x3c/i\x3ePrint\x3c/a\x3e\x3c/li\x3e\x3cli id\x3d"email"\x3e\x3ca href\x3d"#noPage" class\x3d"emailpage"\x3e\x3ci class\x3d"fa fa-envelope"\x3e\x3c/i\x3e\x3cspan class\x3d"ng-binding"\x3eEmail\x3c/span\x3e\x3c/a\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e',
replace:true}});
app.directive("loadingIcon",[function(){return{restrict:"AE",scope:{showWhen:"\x3d"},template:'\x3cdiv ng-show\x3d"showWhen" class\x3d"ispinner ispinner--gray ispinner--animating"\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+
'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+'\x3cdiv class\x3d"ispinner__blade"\x3e\x3c/div\x3e'+"\x3c/div\x3e"}}]);
app.directive("ssoSignOn",["$sce","copartUtils","urlService","copartUser","singleSignOnService","localStorageService",function($sce,copartUtils,urlService,copartUser,singleSignOnService,localSSer){return{restrict:"AE",replace:true,link:function(scope,element,attrs){var hrefUrl=copartUtils.getUnFormattedUrl(attrs.url||"");var brand=attrs.brand||"";if(singleSignOnService.isEligibleForSingleSignOn(brand)){hrefUrl=singleSignOnService.getSingleSignOnUrl(hrefUrl,brand);element.attr("target","_blank");element.click(function(event){if(!localSSer.get("redirect-alert-info")){event.preventDefault();
$("#driveRedirectHref").attr("href",hrefUrl);$("#driveRedirectHref").click(function(){$("#driveRedirectInfo").modal("hide")});$("#driveRedirectInfo").modal("show")}$("#driveRedirectChk").change(function(){if($("#driveRedirectChk").is(":checked"))localSSer.set("redirect-alert-info",true);else localSSer.remove("redirect-alert-info")})})}else hrefUrl=copartUtils.getFormattedUrlForLocale(hrefUrl);attrs.$set("href",hrefUrl)}}}]);
app.directive("opencloseall",[function(){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){elem.bind("click",function(e){if(jQuery(elem).hasClass("openall"))jQuery('a[data-toggle\x3d"collapse"]').each(function(){var collapseID=jQuery(this).attr("href");jQuery(collapseID).collapse("show");jQuery(this).addClass("opened");jQuery(this).removeClass("closed");jQuery(this).find("i").removeClass("fa-plus-square");jQuery(this).find("i").addClass("fa-minus-square")});else jQuery('a[data-toggle\x3d"collapse"]').each(function(){var collapseID=
jQuery(this).attr("href");jQuery(collapseID).collapse("hide");jQuery(this).addClass("closed");jQuery(this).removeClass("opened");jQuery(this).find("i").addClass("fa-plus-square");jQuery(this).find("i").removeClass("fa-minus-square")});jQuery(elem).find("i").toggleClass("fa-plus-square fa-minus-square");jQuery(elem).toggleClass("openall closeall")})}}}]);
app.directive("charCheck",function(){return{restrict:"A",scope:{modelData:"\x3d"},link:function(scope,elem,attrs){elem.bind("keyup",function(event){var currentChar=event.which||event.keyCode;if(!(currentChar>=48&&currentChar<=57||currentChar>=96&&currentChar<=105))elem["context"].value=elem["context"].value.substring(0,elem["context"].value.length-1);scope.modelData=elem["context"].value})}}});
app.directive("numbersOnly",function(){return{require:"ngModel",link:function(scope,element,attrs,modelCtrl){modelCtrl.$parsers.push(function(inputValue){var transformedInput;transformedInput=inputValue.replace(/[^0-9,]/g,"");if(transformedInput!=inputValue){modelCtrl.$setViewValue(transformedInput);modelCtrl.$render()}return transformedInput})}}});
app.directive("searchplaceholder",function(){return{restrict:"A",link:function(scope,element,attrs){$(".my_textarea").each(function(){$(this).data("placeholder",$(this).attr("placeholder")).blur(function(){changePlaceholder()})});function changePlaceholder(){if($(window).width()<1200){var text=scope.$parent.locale.messages["app.label.search"];$(".my_textarea").attr("placeholder",text)}else $(".my_textarea").each(function(){$(this).attr("placeholder",attrs.placeText)})}$(window).resize(changePlaceholder).trigger("resize")}}});
app.directive("placeHolderText",function(){return{restrict:"A",link:function(scope,element,attrs){element.attr("placeholder",attrs.placeText);element.on("blur",function(){element.attr("placeholder",attrs.placeText)});element.on("focus",function(){element.attr("placeholder","")})}}});
app.directive("siteCatalyst",["userService","dataServiceG2","$q","siteCatalyst",function(userService,dataServiceG2,$q,siteCatalyst){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){elem.bind("click",function(){var val=scope.$eval("("+attrs.siteCatalyst+")");var memNumber=userService.userConfig.buyerNumber;var crmId=userService.userConfig.crmId;var selectedLanguage=userService.userConfig.selectedLang;if(attrs.selectedLang)appInit.localeString=attrs.selectedLang;var defer=!AppUtils.isUndefined(attrs.waitForSuccess);
if(val["lotId"]!=undefined&&val["lotId"].includes("#"))if(attrs.catalystModal)val["lotId"]=scope[attrs.catalystModal][val["lotId"].substr(1)];else val["lotId"]=scope[val["lotId"].substr(1)];if(val["linkName"]!=undefined&&val["linkName"].includes("#"))val["linkName"]=scope[attrs.catalystModal][val["linkName"].substr(1)];if(val["download"]!=undefined&&val["lotId"]!=undefined&&val["download"].includes("#"))val["download"]=scope[attrs.catalystModal][val["download"].substr(1)];if(val["addremove"]!=undefined&&
val["addremove"].includes("#"))val["addremove"]=scope[attrs.catalystModal][val["addremove"].substr(1)];if(val["channel"]!=undefined&&val["channel"].includes("#"))val["channel"]=scope[attrs.catalystModal][val["channel"].substr(1)];if(val["pagename"]!=undefined&&val["pagename"].includes("#"))val["pagename"]=scope[attrs.catalystModal][val["pagename"].substr(1)];if(val["server"]!=undefined&&val["server"].includes("#"))val["server"]=scope[attrs.catalystModal][val["server"].substr(1)];if(val["ipaddress"]!=
undefined&&val["ipaddress"].includes("#"))val["ipaddress"]=scope[attrs.catalystModal][val["ipaddress"].substr(1)];if(val["country"]!=undefined&&val["country"].includes("#"))val["country"]=scope[attrs.catalystModal][val["country"].substr(1)];if(val["state"]!=undefined&&val["state"].includes("#"))val["state"]=scope[attrs.catalystModal][val["state"].substr(1)];if(val["city"]!=undefined&&val["city"].includes("#"))val["city"]=scope[attrs.catalystModal][val["city"].substr(1)];if(val["zipcode"]!=undefined&&
val["zipcode"].includes("#"))val["zipcode"]=scope[attrs.catalystModal][val["zipcode"].substr(1)];if(val["yardname"]!=undefined&&val["yardname"].includes("#"))val["yardname"]=scope[attrs.catalystModal][val["yardname"].substr(1)];if(val["type"]!=undefined&&val["type"].includes("#"))val["type"]=scope[attrs.catalystModal][val["type"].substr(1)];if(val["doctitle"]!=undefined&&val["doctitle"].includes("#"))val["doctitle"]=scope[attrs.catalystModal][val["doctitle"].substr(1)];if(val["widgetName"]!=undefined&&
val["widgetName"].includes("#"))val["widgetName"]=scope[attrs.catalystModal][val["widgetName"].substr(1)];if(val["videoUrl"]!=undefined&&val["videoUrl"].includes("#"))val["videoUrl"]=scope[attrs.catalystModal][val["videoUrl"].substr(1)];if(val["imageNumber"]!=undefined&&val["imageNumber"].includes("#"))val["imageNumber"]=scope[attrs.catalystModal][val["imageNumber"].substr(1)];if(val["tag"]!=undefined&&val["tag"].includes("#"))val["tag"]=scope[attrs.catalystModal][val["tag"].substr(1)];if(defer)siteCatalyst.addToQueue(val["fname"],
val);else copartOmnitureCall(val["fname"],val["lotId"],memNumber,val["linkName"],val["download"],val["addremove"],val["channel"],val["pagename"],val["server"],val["ipaddress"],val["country"],val["state"],val["city"],val["zipcode"],val["yardname"],val["type"],val["doctitle"],val["widgetName"],memNumber,selectedLanguage,memNumber,val["videoUrl"],val["imageNumber"],val["tag"],crmId)})}}}]);
app.directive("openself",[function(){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){elem.bind("click",function(e){jQuery(elem).find("i").toggleClass("fa-plus-square fa-minus-square")})}}}]);
app.directive("slidetoggle",["localStorageService","$timeout",function(localStorageService,$timeout){return{restrict:"A",transclude:false,link:{pre:function(scope,elem,attrs){elem.bind("click",function(e){jQuery(elem).toggleClass("closed opened");if(jQuery(elem).hasClass("closed")){jQuery(elem).removeClass("opened");jQuery(".filters").hide();jQuery(".results-wrap").animate({"margin-left":jQuery(".results-wrap").css("margin-left")=="28px"?"0px":"28px"},0);jQuery(".results-wrap").addClass("extend");
localStorageService.set("filtersHidden",true)}else{jQuery(elem).removeClass("closed");jQuery(".filters").show();jQuery(".results-wrap").animate({"margin-left":jQuery(".results-wrap").css("margin-left")=="0px"},0);jQuery(".results-wrap").removeClass("extend");localStorageService.remove("filtersHidden")}})}}}}]);
app.directive("increasefont",["localStorageService",function(localStorageService){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){elem.bind("click",function(e){var mintext=11;var maxtext=14;var current_size=jQuery(".dataTable").css("font-size");var elem_iFrame=jQuery("#resultsFrame").contents().find("#saleListTable");var current_size_iFrame=elem_iFrame.css("font-size");var textsize=parseInt(current_size)||parseInt(current_size_iFrame);console.log(textsize);var table=jQuery("#serverSideDataTable").DataTable();
if(textsize<=maxtext){jQuery(".dataTable").css("font-size",parseInt(textsize)+2+"px");elem_iFrame.css("font-size",parseInt(textsize)+2+"px");localStorageService.cookie.set("datatable-font-size",parseInt(textsize)+2)}jQuery("#serverSideDataTable").css("display","table");table.responsive.recalc()})}}}]);
app.directive("decreasefont",["localStorageService",function(localStorageService){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){elem.bind("click",function(e){var mintext=11;var maxtext=14;var current_size=jQuery(".dataTable").css("font-size");var elem_iFrame=jQuery("#resultsFrame").contents().find("#saleListTable");var current_size_iFrame=elem_iFrame.css("font-size");var textsize=parseInt(current_size)||parseInt(current_size_iFrame);var table=jQuery("#serverSideDataTable").DataTable();
if(textsize>=mintext){jQuery(".dataTable").css("font-size",parseInt(textsize)-2+"px");elem_iFrame.css("font-size",parseInt(textsize)-2+"px");localStorageService.cookie.set("datatable-font-size",parseInt(textsize)-2)}jQuery("#serverSideDataTable").css("display","table");table.responsive.recalc()})}}}]);
app.directive("filterScroll",[function(){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){var locale=scope.$parent.$parent.locale;elem.bind("mousemove touchstart",function(e){jQuery(this).addClass("more");if(jQuery(elem).hasClass("more")){jQuery(this).find("ul").removeClass("scroll-out");jQuery(this).find("ul").addClass("scroll-in");var scrolldivmobile={};jQuery(this).find("ul").on("touchstart",scrolldivmobile,function(e){e.data.max=this.scrollHeight-this.offsetHeight;e.data.y=
e.originalEvent.pageY}).on("touchmove",scrolldivmobile,function(e){var dy=e.data.y-e.originalEvent.pageY;if(dy<0&&this.scrollTop<1||dy>0&&this.scrollTop>=e.data.max)e.preventDefault()});jQuery.fn.isolatedScroll=function(){this.bind("mousewheel DOMMouseScroll",function(e){var delta=e.wheelDelta||e.originalEvent&&e.originalEvent.wheelDelta||-e.detail,bottomOverflow=this.scrollTop+$(this).outerHeight()-this.scrollHeight>=0,topOverflow=this.scrollTop<=0;if(delta<0&&bottomOverflow||delta>0&&topOverflow)e.preventDefault()});
return this};jQuery(".scroll-in").isolatedScroll()}});elem.bind("mouseleave touchend",function(e){jQuery(this).removeClass("more");if(!jQuery(elem).hasClass("more")){jQuery(this).find("ul").removeClass("scroll-in");jQuery(this).find("ul").addClass("scroll-out")}})}}}]);
app.directive("more",["$http",function($http){return{restrict:"E",scope:{locale:"\x3d",rows:"\x3d",config:"\x3d",resultCount:"\x3d",sortOrderFlag:"\x3d",filterText:"\x3d"},transclude:true,controller:function($scope,$element,$attrs){var defaultPageSize=5;var self=$scope;var config=self.config;if(config.pagesize)defaultPageSize=config.pagesize;$scope.hasNoMoreRows=function(){if(self.rows.length>=self.resultCount)return true;else return false};$scope.getMoreRows=function(){var data={pageSize:defaultPageSize,
pageNumber:getLatestPage(),sortBy:$attrs.sortBy,sortOrder:self.sortOrderFlag,filterBy:$attrs.filterBy,filterText:self.filterText};config.dataSource(config.params,data,function(response){self.rows=self.rows.concat(response.list)})};var getLatestPage=function(){var tempPage=Math.floor(self.rows.length/defaultPageSize);return tempPage+1}},template:'\x3cdiv\x3e\x3cdiv ng-transclude\x3e\x3c/div\x3e\x3cdiv class\x3d"col-sm-12 right text-right" \x3e\x3ca href\x3d"" ng-hide\x3d"hasNoMoreRows()" ng-click\x3d"getMoreRows()"\x3e{{locale.messages["app.label.lotdisplay.label.more"]}}\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e',
replace:true}}]);app.directive("onFinishRender",function($timeout){return{restrict:"A",link:function(scope,element,attr){var event=attr.onFinishRender;if(!event)event="ngRepeatFinished";if(scope.$last===true)$timeout(function(){scope.$emit(event)})}}});
app.directive("progresspageloading",function($timeout){return{restrict:"A",link:function(scope,element,attr){jQuery(function(){var progressbar=$("#progressbar"),progressLabel=$(".progress-label");progressbar.progressbar({value:false,change:function(){progressLabel.text(progressbar.progressbar("value")+"%")},complete:function(){progressLabel.text("Loading Complete");setTimeout(function(){jQuery("#progressbar").hide();jQuery(".loadinginfo").hide()},3E3)}});function progress(){var val=progressbar.progressbar("value")||
0;progressbar.progressbar("value",val+2);if(val<99)setTimeout(progress,80)}setTimeout(progress,1E3)})}}});app.directive("watchList",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/watchListDirective\x26agent\x3d007",controller:"watchListPortletController"}});var region=appInit.appPlatform=="gbl"?"_GLOBAL":"";app.directive("registrationTemplate",function(){return{restrict:"EA",templateUrl:"/public/fetchDirective.html?directive\x3dregistration/basicRegistration"}});
app.directive("registrationTemplateWithChoices",function(){return{restrict:"EA",templateUrl:"/public/fetchDirective.html?directive\x3dregistration/basicRegistration-with-choices"}});app.directive("currentBids",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/currentBidsDirective\x26agent\x3d007",controller:"currentBidsPortletController"}});
app.directive("openItems",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/openItemsDirective\x26agent\x3d007",controller:"openItemsPortletController"}});app.directive("buyingPower",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/buyingPowerDirective\x26agent\x3d007",controller:"buyingPowerController"}});
app.directive("savedSearches",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/savedSearchesDirective\x26agent\x3d007",controller:"savedSearchesPortletController"}});app.directive("paymentsDue",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/paymentsDueDirective\x26agent\x3d007",controller:"paymentsDuePortletController"}});app.directive("memberNews",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/memberNewsDirectiveTemplate\x26agent\x3d007"}});
app.directive("bannerOne",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/dashboardBanner1Template\x26agent\x3d007"}});app.directive("bannerTwo",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dhome/dashboardBanner2Template\x26agent\x3d007"}});app.directive("upgradeMembership",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3daccountinfo/upgradeMembership",controller:"UpgradeMembershipController"}});
app.directive("searchInventoryByLotVin",function(){return{restrict:"EA",templateUrl:"/fetchDirective.html?directive\x3dcounterman/searchInventoryByLotVin\x26agent\x3d007",controller:"inventoryController"}});app.directive("searchInventoryByVehicleType",function(){return{restrict:"EA",scope:true,templateUrl:"/fetchDirective.html?directive\x3dcounterman/searchInventoryByVehicleType\x26agent\x3d007",controller:"inventoryController"}});
app.directive("vehicleFinder",["$rootScope",function($rootScope){return{restrict:"EA",templateUrl:"/public/fetchDirective.html?directive\x3dvehicleFinder/vehicleFinderDirective",scope:true,controller:function(){var region=appInit.appPlatform=="gbl"?"_GLOBAL":"";return"vehicleFinderDirectiveController"+region}(),link:function(scope,element,attr){angular.element(".ui-sortable-placeholder").css({"width":"100%","height":"500px","border":"1px dotted black"});if(attr.showLocation=="false"){scope.showLocation=
false;scope.defaultLocation=scope[attr.location]}var locationEvent=$rootScope.$on("location-fetched",function(event,data){scope.defaultLocation=data});scope.$on("$destroy",function(){locationEvent()})}}}]);
app.directive("checkForLoggedInUser",["userService","loginService","$location","$rootScope","localStorageService",function(userService,loginService,$location,$rootScope,localStorageService){var url=$location.path();return{restrict:"AE",transclude:false,link:function(scope,elem,attrs){elem.bind("click",function(e){$rootScope.storeUserURl=$location.url();if(userService.isAnonymous()){e.preventDefault();e.stopPropagation();$(".dropdown").removeClass("open");$("#loginRegister").modal("show");if(attrs.stateRestore==
"true")loginService.preLoginFunction=function(){localStorageService.set("restore-search-state",true);localStorageService.set("restore-search-state-from-anywhere",true)};scope.$apply(function(){loginService.resetLoginErrors();loginService.resetPwdForm.showEmailRequiredError=false})}})}}}]);
app.directive("menuclick",[function(){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){$(".navbar ul.nav .dropdown").hover(function(){$(this).find("\x3e.dropdown-menu").stop(true,true).delay(200).fadeIn()},function(){$(this).find("\x3e.dropdown-menu").stop(true,true).delay(200).fadeOut()});$(".navbar .dropdown-menu").hover(function(){$(this).stop(true,true)},function(){$(this).stop(true,true)});$(".navbar .dropdown-menu\x3eli\x3ea").on("click",function(event){$(this).closest(".mainmenudiv").removeClass("in");
$("a.active").removeClass("active");$(this).addClass("active")});$(".navbar .dropdown-menu\x3eli.dropdown-submenu\x3eul\x3eli\x3ea").on("click",function(event){$(this).closest(".dropdown-menu").parent().closest(".dropdown-menu").stop(true,true).delay(100).fadeOut()})}}}]);
app.directive("signinmenu",[function(){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){$(".search-filters .dropdown-menu").mouseleave(function(){$(this).parent("li").removeClass("open");$(this).parent("li").find("a").attr("aria-expanded","false")})}}}]);
app.directive("modalImageViewer",["$timeout","dataServiceG2","watchListService","auctionsCalendarService","userService","$rootScope","localStorageService","$location","paymentService",function($timeout,dataServiceG2,watchListService,auctionsCalendarService,userService,$rootScope,localStorageService,$location,paymentService){return{restrict:"A",scope:{images:"\x3d"},controller:function($scope,$element,$attrs){},link:function(scope,elem,attrs){var auctionLane,auctionDate,auctionId,yardNumber;var lotId=
attrs.lotId;var bidString=attrs.bidString;var currentBid=attrs.currentBid;var awardHighBid=attrs.awardHighBid;var resultIndex=attrs.resultIndex;var totalRecords=attrs.totalRecords;var bidString=attrs.bidString;var auctionDate=parseInt(attrs.auctionDate);var hideWatchBtn=attrs.hideWatchBtn;var fromSearch=attrs.fromSearch;var yardNumber=attrs.yardNumber;var checkYardExist=attrs.checkYardExist;if(checkYardExist&&(checkYardExist===true||checkYardExist==="true"))checkYardExist=true;else checkYardExist=
false;var thumbnailLength=5;scope.imageNumber=1;scope.images.isLive=false;elem.bind("click",function(){if(window.innerWidth<769)angular.element(document.querySelector("[href\x3d'./lot/"+lotId+"']")).trigger("click");else{var successCallBack=function(){if(yardNumber!="undefined"&&auctionLane!="undefined"&&auctionDate!="undefined")auctionsCalendarService.isAuctionLive(Number(yardNumber),auctionLane,Number(auctionDate),Number(auctionId)).then(function(flag){scope.images.isLive=flag});scope.images.auctionTimeLeft=
auctionsCalendarService.timeToAuction(auctionDate)};getImages(lotId,successCallBack)}});scope.images.imageURL="http://images.copart.com";scope.locale=scope.$parent.locale;scope.isAlreadyAdded=watchListService.isAlreadyAdded;scope.addToWatchList=watchListService.addToWatchList;scope.removeFromWatchList=watchListService.removeFromWatchList;scope.images.resultIndex=resultIndex;scope.images.totalRecords=totalRecords;scope.images.bidString=bidString;scope.images.checkYardExist=checkYardExist;scope.setImageNumber=
function(variation){if(scope.images.length>0&&scope.imageNumber<scope.images.length&&scope.imageNumber>=0)scope.imageNumber=scope.imageNumber+variation};var setLotParams=function(lotDetails){auctionLane=lotDetails.al;auctionDate=lotDetails.ad;auctionId=lotDetails.acId;yardNumber=lotDetails.ynumb;scope.images.isFuture=lotDetails.ifs;scope.images.lotDesc=lotDetails.ld;scope.images.currentBid=awardHighBid||lotDetails.hb;scope.images.lotId=lotId;scope.images.sealedBid=lotDetails.sbf;scope.images.brand=
lotDetails.brand;scope.images.currencyCode=lotDetails.cuc};var getImages=function(lotId,callBack){if(hideWatchBtn)scope.images.hideWatchBtn=true;else scope.images.hideWatchBtn=false;function storeNavigationInfo(){var info={};info.backTo="."+$location.url();if(scope.images.resultIndex||scope.images.resultIndex==0)info.resultIndex=scope.images.resultIndex;if(scope.images.totalRecords)info.totalRecords=scope.images.totalRecords;if(fromSearch&&(fromSearch===true||fromSearch==="true"))info.fromSearch=
true;localStorageService.set("lot-navigation-info",info)}function doCheckYardExist(){paymentService.checkYardBySiteCode(yardNumber).then(function(){storeNavigationInfo();$location.url("lot/"+lotId)},function(){jQuery("#lotImage").modal("hide");paymentService.showYardNotExistModal()})}scope.images.storeNavigationInfo=function(){if(checkYardExist)doCheckYardExist();else storeNavigationInfo()};dataServiceG2.getLotImages(lotId,function(response){if(response!=null){var lotDetails=response.data.data.lotDetails||
{};var imagesList=response.data.data.imagesList||{};setLotParams(lotDetails);var index=0;scope.images.fullSizeImages=imagesList.FULL_IMAGE;scope.images.thumbNailImages=imagesList.THUMBNAIL_IMAGE;var highResImagesAry=imagesList.HIGH_RESOLUTION_IMAGE;_.each(scope.images.fullSizeImages,function(obj){if(obj.highRes)obj.hdUrl=highResImagesAry[index++].url});var errorImage={url:"/images/testImages/no_photo.jpg"};if(scope.images.thumbNailImages.length==0){scope.images.fullSizeImages=[errorImage];scope.images.thumbNailImages=
[errorImage];thumbnailLength=1}else if(scope.images.thumbNailImages.length>10){scope.images.thumbnailLength=10;thumbnailLength=10}else{scope.images.thumbnailLength=5;thumbnailLength=5}if(callBack)callBack();$timeout(loadImageViewer,0)}})};var loadImageViewer=function(){var lotImage=jQuery("#lotImage");carousel4=new ImageCarousel("#carousel4",{errorImage:"/images/testImages/no_photo.jpg",lazyInit:true,buyerNumber:userService.userConfig.buyerNumber,lotId:scope.images.lotId,thumbnailLength:thumbnailLength});
carousel4.initImageViewer();lotImage.modal("show");lotImage.modal({backdrop:true,keyboard:true});jQuery(".lotImageViewerModal").draggable({handle:".modal-header"});jQuery(function(){var image={};image=carousel4.showStripImage(0)});carousel4.showImage=function(element){var sequence=jQuery(element).attr("data-sequence");image=carousel4.showStripImage(sequence-1)};carousel4.showHD=function(element){var imgElement=jQuery(element);var parent=imgElement.parent();var url=imgElement.attr("data-hd-img-url");
parent.html("");OpenSeadragon({element:parent[0],prefixUrl:"/images/openSeaDragon/",autoResize:true,showFullPageControl:false,defaultZoomLevel:1,minZoomLevel:1,visibilityRatio:1,tileSources:{type:"image",url:url}});imgElement.hide();parent.siblings().remove()};jQuery(".image-viewer-modal").unbind("keydown");jQuery(".image-viewer-modal").keydown(function(e){if(e.keyCode==37)carousel4.stripLeft();else if(e.keyCode==39)carousel4.stripRight()})}}}}]);
app.directive("imageViewer",["$timeout","dataServiceG2","siteCatalyst",function($timeout,dataServiceG2,siteCatalyst){return{restrict:"A",link:function(scope,elem,attrs){var lazyLoadAndAddZoom=function(imageComponent){var $load=imageComponent.attr("lazy-url");var title=imageComponent.attr("lazy-title");var alt=imageComponent.attr("lazy-alt");imageComponent.attr("src",$load).removeClass("lazy");imageComponent.attr("title",title);imageComponent.attr("alt",alt);if($(window).width()<765)imageComponent.wrap('\x3cdiv style\x3d"display:inline-block"\x3e\x3c/div\x3e').css("display",
"block").parent().zoom({magnify:0});else imageComponent.wrap('\x3cdiv style\x3d"display:inline-block"\x3e\x3c/div\x3e').css("display","block").parent().zoom({magnify:2})};var loadImageViewer=function(){var slider=$(".bxslider").bxSlider({mode:"horizontal",pagerCustom:"#bx-pager",nextSelector:"#lot-slider-next",prevSelector:"#lot-slider-prev",prevText:"",nextText:"",keyboardEnabled:true,onSliderLoad:function(){$("#bx-pager").keydown(function(e){if(e.keyCode==37)slider.goToPrevSlide();else if(e.keyCode==
39)slider.goToNextSlide()})},onSlideBefore:function($slideElement,oldIndex,newIndex){var $lazy=$slideElement.find(".lazy");var siteCatalystVal={};siteCatalystVal.fname="doTagLotImages";siteCatalystVal.imageNumber=newIndex+1;siteCatalystVal.lotId=scope.lotNumber;siteCatalyst.addToQueue("doTagLotImages",siteCatalystVal);siteCatalyst.executeCall("doTagLotImages");lazyLoadAndAddZoom($lazy)}});$("#lot-slider-next").click(function(){slider.goToNextSlide();return false});$("#lot-slider-prev").click(function(){slider.goToPrevSlide();
return false});if(scope.slider)scope.slider.target=slider};scope.showVINImage=function(index){scope.slider.target.goToSlide(index)};scope.$on("ngRepeatFinished",function(ngRepeatFinishedEvent){var $lazy=jQuery("ul.bxslider").find("img:first");lazyLoadAndAddZoom($lazy);var siteCatalystVal={};siteCatalystVal.fname="doTagLotImages";siteCatalystVal.imageNumber=1;siteCatalystVal.lotId=scope.lotNumber;siteCatalyst.addToQueue("doTagLotImages",siteCatalystVal);siteCatalyst.executeCall("doTagLotImages");loadImageViewer()})},
template:""}}]);
app.directive("spImageViewer",["siteCatalyst","$window","localStorageService",function(siteCatalyst,$window,localStorageService){return{restrict:"A",link:{post:function(scope,elem,attrs){var self=scope;var activeIndex=0;var regZoomScale=300;var HDZoomScale=200;var zooomScale=regZoomScale;var loadspImageViewer=function(){jQuery("[target-index\x3d'0']").addClass("active");jQuery("#prevArrow").css("display","none");var url;var totalImgIndex=self.thumbNailImages.length;var isHDImg=self.thumbNailImages[0].highRes;isHDImg?
"":jQuery(".view-hd").hide();for(i=0;i<totalImgIndex;i++)localStorageService.remove("HDImg-index-"+i);self.showImg=function(index,isShowHDImg){activeIndex=index;zooomScale=regZoomScale;var HDBtnClicked=localStorageService.get("HDImg-index-"+index);if(isShowHDImg||HDBtnClicked){zooomScale=HDZoomScale;url=$("[target-index\x3d"+index+"]").attr("hd-url");HDBtnClicked?"":localStorageService.set("HDImg-index-"+index,true);HDBtnClicked=localStorageService.get("HDImg-index-"+index)}else url=$("[target-index\x3d"+
index+"]").attr("full-url");jQuery(".thumbnailImg").removeClass("active");jQuery("[target-index\x3d"+index+"]").addClass("active");jQuery("#show-img,#big-img").attr("src",url);jQuery(".spZoomImg").attr("sp-url",url);index==0?jQuery("#prevArrow").css("display","none"):jQuery("#prevArrow").css("display","inline-block");index==totalImgIndex-1?jQuery("#nextArrow").css("display","none"):jQuery("#nextArrow").css("display","inline-block");HDBtnClicked||!self.thumbNailImages[index].highRes?jQuery(".view-hd").hide():
jQuery(".view-hd").show()};self.goToPrevImg=function(){if(activeIndex>0){activeIndex-=1;self.showImg(activeIndex,false)}};self.goToNextImg=function(){if(activeIndex<totalImgIndex-1){activeIndex+=1;self.showImg(activeIndex,false)}};self.showHDImg=function(e){jQuery(".view-hd").hide();self.showImg(activeIndex,true)};$(document).keydown(function(e){if(e.keyCode==37)_.debounce(self.goToPrevImg(),true);else if(e.keyCode==39)_.debounce(self.goToNextImg(),true)});angular.element(document).ready(function(){function ImageloadEvent(){jQuery("#show-img").load(function(){zoomFuncInit();
return true})}function zoomFuncInit(){if(window.innerWidth>=1200){jQuery("#sp-canvas").hide();jQuery(".spZoomImg").zoomImage(zooomScale)}else{var gesturableImg=new ImgTouchCanvas({canvas:document.getElementById("sp-canvas"),path:jQuery("#show-img").attr("src"),desktop:true,imgWidth:jQuery("#show-img").width(),imgHeight:jQuery("#show-img").height()});jQuery("#show-img").hide()}}if($("#show-img").length>0)ImageloadEvent()?"":zoomFuncInit()})};scope.$on("ngRepeatFinished",function(ngRepeatFinishedEvent){var siteCatalystVal=
{};siteCatalystVal.fname="doTagLotImages";siteCatalystVal.imageNumber=1;siteCatalystVal.lotId=scope.lotNumber;siteCatalyst.addToQueue("doTagLotImages",siteCatalystVal);siteCatalyst.executeCall("doTagLotImages");loadspImageViewer()})}},template:""}}]);
app.directive("bidStatusTimeRange",["$filter","$timeout","$q","$rootScope",function($filter,$timeout,$q,$rootScope){return{restrict:"A",controller:function($scope,$element,$attrs){var dateFormat="YYYYMMDD";var locale=$scope.$parent.locale;$scope.showTimeRanges=[{desc:locale.messages["app.label.bidStatusTimeRange.last30Days"],fromDate:$filter("addDaysToDate")(moment(new Date),-30,dateFormat),toDate:$filter("addDaysToDate")(moment(new Date),0,dateFormat),dateRangeStringForSolr:"NOW-1MONTHS TO NOW"},
{desc:locale.messages["app.label.bidStatusTimeRange.last60Days"],fromDate:$filter("addDaysToDate")(moment(new Date),-60,dateFormat),toDate:$filter("addDaysToDate")(moment(new Date),0,dateFormat),dateRangeStringForSolr:"NOW-2MONTHS TO NOW"},{desc:locale.messages["app.label.bidStatusTimeRange.last90Days"],fromDate:$filter("addDaysToDate")(moment(new Date),-90,dateFormat),toDate:$filter("addDaysToDate")(moment(new Date),0,dateFormat),dateRangeStringForSolr:"NOW-3MONTHS TO NOW"},{desc:locale.messages["app.label.bidStatusTimeRange.last90_To_180Days"],
fromDate:$filter("addDaysToDate")(moment(new Date),-180,dateFormat),toDate:$filter("addDaysToDate")(moment(new Date),-90,dateFormat),dateRangeStringForSolr:"NOW-6MONTHS TO NOW-3MONTHS"},{desc:locale.messages["app.label.bidStatusTimeRange.last180_To_365Days"],fromDate:$filter("addDaysToDate")(moment(new Date),-365,dateFormat),toDate:$filter("addDaysToDate")(moment(new Date),-180,dateFormat),dateRangeStringForSolr:"NOW-1YEAR TO NOW-6MONTHS"}]},link:function(scope,elem,attrs){$timeout(scope.loadDataTable(),
0)}}}]);app.directive("backToTop",function(){return{restrict:"A",link:function(scope,$elm,attrs){$elm.on("click",function(){jQuery("body").animate({scrollTop:0},"slow")})}}});
app.directive("toggleChevron",function(){return{restrict:"A",link:function(scope,elm,attrs){function toggleChevron(e){jQuery(e.target).prev(".panel-heading").find("i.indicator").toggleClass("glyphicon-chevron-down glyphicon-chevron-up")}jQuery("#accordion").on("hidden.bs.collapse",toggleChevron);jQuery("#accordion").on("shown.bs.collapse",toggleChevron)}}});
app.directive("scrollToDiv",["scrollToDivService","$location",function(scrollToDivService,$location){return{restrict:"A",link:function(scope,element,attrs){var targetDiv=attrs.targetdiv;element.on("click",function(){scrollToDivService.scrollToDiv(targetDiv)})}}}]);
app.directive("previousBackNext",["$location","dataServiceG2","urlService","saveLotNumbersService","localStorageService","lotDetailsService",function($location,dataServiceG2,urlService,saveLotNumbersService,localStorageService,lotDetailsService){return{restrict:"E",controller:function($scope,$element,$attrs){var self=$scope;var totalRecords;var viewAllPhotos=$location.path().indexOf("Photos")!=-1;var navigationInfoFromStorage=localStorageService.get("lot-navigation-info");if(!navigationInfoFromStorage){var rIndex=
$location.search().resultIndex;var backToURL=$location.search().backTo;totalRecords=$location.search().totalRecords;if(rIndex&&backToURL&&totalRecords){navigationInfoFromStorage={backTo:"."+backToURL,resultIndex:rIndex,totalRecords:totalRecords,fromSearch:$location.search().fromSearch};localStorageService.set("lot-navigation-info",navigationInfoFromStorage)}}var info=navigationInfoFromStorage||{};var resultIndex=info.resultIndex;var fromSearch=info.fromSearch;self.backTo=info.backTo;self.backToText=
self.$parent.locale.messages["app.label.backToResults"];if(self.backTo)if(self.backTo.indexOf("paymentsDue")!=-1)self.backToText=self.$parent.locale.messages["app.label.backToPaymentsDue"];if(fromSearch){totalRecords=info.totalRecords;var currentLotNumber=self.$parent.lotDetails.ln;localStorageService.set("viewed-lot",currentLotNumber);self.goToPreviousLot=function(){dataServiceG2.getLotByIndex(parseInt(resultIndex)-1,function(response){if(response.data.returnCode==1)goToSearchLot(response);else console.error("Error - goToPreviousLot - "+
response.data)})};self.goToNextLot=function(){dataServiceG2.getLotByIndex(parseInt(resultIndex)+1,function(response){if(response.data.returnCode==1)goToSearchLot(response);else console.error("Error - goToNextLot - "+response.data)})};self.setSearchStore=function(){localStorageService.set("restore-search-state",true)};function goToSearchLot(response){info.totalRecords=response.data.data.totalElements;info.resultIndex=response.index;localStorageService.set("restore-search-state",true);localStorageService.set("lot-navigation-info",
info);var target="lot/"+response.data.data.lotNum;if(viewAllPhotos)target+="/Photos";var target=target+"/"+response.data.data.lotDescURI;self.prevNextLotClicked=true;self.$parent.prevNextLotClicked=true;$location.url(target)}}else{totalRecords=saveLotNumbersService.getListLength();var currentLotNumber=self.$parent.lotDetails.ln;localStorageService.set("viewed-lot",currentLotNumber);self.goToPreviousLot=function(){var previousIndex=parseInt(resultIndex)-1;var data={lotNumber:saveLotNumbersService.getLotNumber(previousIndex),
resultIndex:previousIndex};goToLot(data)};self.setSearchStore=function(){};self.goToNextLot=function(){var nextIndex=parseInt(resultIndex)+1;var data={lotNumber:saveLotNumbersService.getLotNumber(nextIndex),resultIndex:nextIndex};goToLot(data)};function goToLot(data){var target="lot/"+data.lotNumber;if(viewAllPhotos)target+="/Photos";info.resultIndex=data.resultIndex;localStorageService.set("lot-navigation-info",info);localStorageService.set("restore-search-state",true);self.prevNextLotClicked=true;
self.$parent.prevNextLotClicked=true;$location.url(target)}}function setButtonVisibility(){self.showPrevious=false;self.showNext=false;if(resultIndex>0)self.showPrevious=true;if(resultIndex<totalRecords-1)self.showNext=true}setButtonVisibility()},template:"\x3cspan class\x3d'pagination-prev-next d-flex align-baseline'\x3e"+"\x3ca class\x3d'cursor-pointer btn-white mob-back-link-icon' title\x3d'{{backToText}}' ng-if\x3d'backTo' ng-href\x3d'{{backTo}}'\x3e"+"\x3cimg src\x3d'../images/lot-details/lot-details-sprite.svg' class\x3d'img-responsive back-link-icon' alt\x3d'{{backToText}}'\x3e"+
"\x3c/a\x3e"+"\x3ca class\x3d'cursor-pointer btn-white' title\x3d\"{{locale.messages['app.label.previous']}} {{locale.messages['app.label.lot']}}\" ng-if\x3d'showPrevious' ng-click\x3d'goToPreviousLot()'\x3e"+"\x3cimg src\x3d'../images/lot-details/lot-details-sprite.svg' class\x3d'img-responsive previous-button' alt\x3d\"{{locale.messages['app.label.previous']}} {{locale.messages['app.label.lot']}}\"\x3e"+"\x3cspan class\x3d'prev-btn' desktopText\x3d\"{{locale.messages['app.label.previous']}}\" mobText\x3d''\x3e\x3c/span\x3e"+
"\x3c/a\x3e"+"\x3cspan class\x3d'cursor-pointer back-to-link' ng-if\x3d'backTo'\x3e"+"\x3cspan\x3e"+"\x3ca ng-href\x3d'{{backTo}}'\x3e"+"\x3cstrong desktopText\x3d'{{backToText}}' mobText\x3d\"{{locale.messages['app.label.back']}}\" class\x3d'back-btn'\x3e\x3c/strong\x3e"+"\x3c/a\x3e"+"\x3c/span\x3e"+"\x3c/span\x3e"+"\x3ca class\x3d'cursor-pointer btn-white' title\x3d\"{{locale.messages['app.label.next']}} {{locale.messages['app.label.lot']}}\" ng-if\x3d'showNext' ng-click\x3d'goToNextLot()'\x3e"+
"\x3cspan class\x3d'prev-btn' desktopText\x3d\"{{locale.messages['app.label.next']}}\" mobText\x3d''\x3e\x3c/span\x3e"+"\x3cimg src\x3d'../images/lot-details/lot-details-sprite.svg' class\x3d'img-responsive next-button' alt\x3d\"{{locale.messages['app.label.next']}} {{locale.messages['app.label.lot']}}\"\x3e"+"\x3c/a\x3e"+"\x3c/span\x3e"}}]);app.directive("timeModal",[function(){return{restrict:"AE",link:function(scope,element,attrs){},controller:"timeModalController"}}]);
app.directive("multiLotBidding",["$location","dataServiceG2","urlService","$rootScope","bidService",function($location,dataServiceG2,urlService,$rootScope,bidService){return{restrict:"E",controller:function($scope,$element,$attrs){var self=$scope;self.index=$attrs.index;self.formName=$attrs.formName;self.yardName=$attrs.yardName;self.yardNumber=$attrs.yardNumber;self.lotDesc=$attrs.lotDesc;self.aucDate=$attrs.aucDate;self.aucTime=$attrs.aucTime;self.lotNum=$attrs.lotNum;self.yardNumber=$attrs.yardNumber;
self.isLive="N";self.currencyCode=$attrs.currencyCode;self.lotBidModal={};self.bidIncrements=bidService.getBidIncrements();var isDirty=function(){return checkIfDirty()};var resetErrors=function(){self.lotBidModal.isMaxBidLess=false;self.lotBidModal.isStartBidBlank=false;self.lotBidModal.isMaxBidBlank=false;self.lotBidModal.isStartBidLessThanNextBid=false;self.lotBidModal.isMaxBidLessThanNextBid=false};var checkIfDirty=function(){if((self.lotBidModal.startBid==""||!self.lotBidModal.startBid)&&(self.lotBidModal.maxBid==
""||!self.lotBidModal.maxBid)){self.preBidForm.$setPristine();$element.find("input").val("");resetErrors();return false}else return self.preBidForm.$dirty};var clear=function(){self.lotBidModal.startBid="";self.lotBidModal.maxBid="";resetErrors();self.preBidForm.$setPristine()};var isValid=function(){resetErrors();var flag=true;if(self.preBidForm.$valid)if(self.lotBidModal.currentBid==0){if(self.lotBidModal.startBid==null&&self.lotBidModal.maxBid==null)return false;if(self.lotBidModal.startBid!=null&&
self.lotBidModal.maxBid==null){self.lotBidModal.isMaxBidBlank=true;flag=false}if(self.lotBidModal.startBid==null&&self.lotBidModal.maxBid!=null){self.lotBidModal.isStartBidBlank=true;flag=false}if(self.lotBidModal.startBid!=null&&self.lotBidModal.maxBid!=null){if(self.lotBidModal.startBid>self.lotBidModal.maxBid){self.lotBidModal.isMaxBidLess=true;flag=false}if(self.lotBidModal.startBid<self.lotBidModal.bidInc){self.lotBidModal.isStartBidLessThanNextBid=true;flag=false}}if(flag==false)$($element).find("input").first().focus();
return flag}else{if(self.lotBidModal.maxBid==null)return false;if(self.lotBidModal.maxBid!=null)if(self.lotBidModal.maxBid<self.lotBidModal.bidInc+self.lotBidModal.currentBid){self.lotBidModal.isMaxBidLessThanNextBid=true;flag=false}if(flag==false)$($element).find("input").first().focus();return flag}};var getStartBid=function(){return self.lotBidModal.startBid};var getMaxBid=function(){return self.lotBidModal.maxBid};var getBidItem=function(){var retnObj={};if(self.lotBidModal.currentBid==0){retnObj.lotId=
self.lotBidModal.lotNum;retnObj.startingBid=self.lotBidModal.startBid;retnObj.maxBid=self.lotBidModal.maxBid;retnObj.bidAmount=self.lotBidModal.startBid;retnObj.yardNumber=self.yardNumber}else{retnObj.lotId=self.lotBidModal.lotNum;retnObj.startingBid=self.lotBidModal.maxBid;retnObj.maxBid=self.lotBidModal.maxBid;retnObj.bidAmount=self.lotBidModal.maxBid;retnObj.yardNumber=self.yardNumber}return retnObj};var initLotBidModal=function(lotData){if(_.isUndefined(lotData))lotData=self.lots[self.lotNum];
self.lotBidModal.formName=self.formName;self.lotBidModal.index=self.index;self.lotBidModal.isDirty=isDirty;self.lotBidModal.isValid=isValid;self.lotBidModal.clear=clear;self.lotBidModal.getStartBid=getStartBid;self.lotBidModal.getMaxBid=getMaxBid;self.lotBidModal.getBidItem=getBidItem;self.lotBidModal.currencyCode=self.currencyCode.toUpperCase();if(!_.isUndefined(lotData)){self.lotBidModal.currentBid=parseInt(lotData.currentBid);if(self.lotBidModal.currentBid<=0)self.lotBidModal.bidInc=parseInt(bidService.getBidIncrement($attrs.yardMinBid))+
parseInt($attrs.yardMinBid);else self.lotBidModal.bidInc=bidService.getBidIncrement(self.lotBidModal.currentBid);self.isLive=lotData.liveBid}else{self.lotBidModal.currentBid=parseInt($attrs.currentBid);if(self.lotBidModal.currentBid<=0)self.lotBidModal.bidInc=parseInt(bidService.getBidIncrement($attrs.yardMinBid))+parseInt($attrs.yardMinBid);else self.lotBidModal.bidInc=bidService.getBidIncrement(self.lotBidModal.currentBid)}self.lotBidModal.yardName=self.yardName;self.lotBidModal.yardNumber=self.yardNumber;
self.lotBidModal.lotDesc=self.lotDesc;self.lotBidModal.aucDate=self.aucDate;self.lotBidModal.aucTime=self.aucTime;self.lotBidModal.lotNum=self.lotNum;self.lotBidModal.yardNumber=self.yardNumber};initLotBidModal();$rootScope.$emit("registerBidForm",self.lotBidModal);var currentBidDeregisterEvent=$rootScope.$on("got-current-bid-data",function(event,data){var lotData=_.find(data.data,function(item){return item.lotNum==self.lotNum});initLotBidModal(lotData)});$scope.$on("$destroy",function(){currentBidDeregisterEvent()})},
scope:{lots:"\x3d",appConfig:"\x3d"},template:'\x3cng-form ng-attr-name\x3d"preBidForm" ng-attr-id\x3d"preBidForm"\x3e\x3cul  class\x3d"list-unstyled"\x3e'+"\x3cli ng-if\x3d\"isLive!\x3d'Y' \x26\x26 lotBidModal.currentBid\x3d\x3d0\"\x3e    "+'\x3cdiv class\x3d"form-group smallgroup"\x3e   '+'\x3clabel class\x3d"control-label" for\x3d"prependedtext"\x3eStarting Bid:\x3c/label\x3e '+'\x3cdiv class\x3d"input-group"\x3e '+'\x3cspan class\x3d"input-group-addon smallpad"\x3e{{ lotBidModal.currencyCode | globalize_currency_symbol}}\x3c/span\x3e    '+
'\x3cinput id\x3d"startBid" name\x3d"startBid" min\x3d"0" ng-attr-step\x3d"{{lotBidModal.bidInc}}" placeholder\x3d"" max\x3d"9999999" ng-maxlength\x3d7 class\x3d"form-control" ng-model\x3d"lotBidModal.startBid" type\x3d"number"\x3e'+"\x3c/div\x3e "+'\x3cp class\x3d"help-block"\x3e({{ lotBidModal.currencyCode | globalize_currency_symbol}}{{lotBidModal.bidInc}} {{lotBidModal.currencyCode}} Bid Increment)\x3c/p\x3e  '+'\x3cp class\x3d"lightred" ng-if\x3d"lotBidModal.isStartBidBlank"\x3eStarting cannot be blank.\x3c/p\x3e'+
'\x3cp class\x3d"lightred" ng-if\x3d"preBidForm.startBid.$error.maxlength"\x3eStarting Bid cannot be more than 7 digits.\x3c/p\x3e'+'\x3cp class\x3d"lightred" ng-if\x3d"lotBidModal.isStartBidLessThanNextBid"\x3ePlease enter a bid that is at least ${{lotBidModal.bidInc}}.\x3c/p\x3e'+"\x3c/div\x3e"+"\x3c/li\x3e "+"\x3cli ng-if\x3d\"isLive!\x3d'Y'\"\x3e "+'\x3cdiv class\x3d"form-group smallgroup"\x3e '+'\x3clabel class\x3d"control-label" for\x3d"prependedtext" ng-if\x3d"lotBidModal.currentBid\x3d\x3d0"\x3eMaximum Bid:\x3c/label\x3e  '+
'\x3clabel class\x3d"control-label" for\x3d"prependedtext" ng-if\x3d"lotBidModal.currentBid!\x3d0"\x3eYour New Max Bid:\x3c/label\x3e'+'\x3cdiv class\x3d"input-group"\x3e'+'\x3cspan class\x3d"input-group-addon smallpad"\x3e{{ lotBidModal.currencyCode | globalize_currency_symbol}}\x3c/span\x3e  '+'\x3cinput id\x3d"maxBid" name\x3d"maxBid" placeholder\x3d"" max\x3d"9999999" ng-maxlength\x3d7 min\x3d"0" ng-attr-step\x3d"{{lotBidModal.bidInc}}" class\x3d"form-control" ng-model\x3d"lotBidModal.maxBid" type\x3d"number"\x3e'+
"\x3c/div\x3e "+'\x3cp class\x3d"help-block" ng-if\x3d"lotBidModal.currentBid!\x3d0"\x3e({{ lotBidModal.currencyCode | globalize_currency_symbol}}{{lotBidModal.bidInc}} {{ lotBidModal.currencyCode}} Bid Increment)\x3c/p\x3e  '+'\x3cp class\x3d"lightred" ng-if\x3d"lotBidModal.isMaxBidBlank"\x3eMax Bid cannot be blank.\x3c/p\x3e'+'\x3cp class\x3d"lightred" ng-if\x3d"preBidForm.maxBid.$error.maxlength"\x3eMax Bid cannot be more than 7 digits.\x3c/p\x3e'+'\x3cp class\x3d"lightred" ng-if\x3d"lotBidModal.isMaxBidLess"\x3eMax Bid cannot be lower than the Starting Bid\x3c/p\x3e'+
'\x3cp class\x3d"lightred" ng-if\x3d"lotBidModal.isMaxBidLessThanNextBid"\x3ePlease enter a bid that is at least ${{lotBidModal.bidInc-0 + lotBidModal.currentBid-0 }}.\x3c/p\x3e'+"\x3c/div\x3e"+"\x3c/li\x3e"+"\x3cli ng-if\x3d\"isLive\x3d\x3d'Y'\"\x3e "+'\x3cdiv class\x3d"form-group smallgroup"\x3e '+'\x3cspan class\x3d"green"\x3eLive\x3c/span\x3e'+"\x3c/div\x3e"+"\x3c/li\x3e"+"\x3c/ul\x3e"+"\x3c/ng-form\x3e"}}]);
app.directive("lotPrintLink",["siteCatalyst","$q",function(siteCatalyst,$q){return{restrict:"AE",replace:true,link:function(scope,element,attrs){function sleep(time){var deferred=$q.defer();setTimeout(function(){deferred.resolve()},time);return deferred.promise}element.bind("click",function(e){$(this).parents().find(".table").removeClass("dropping_table");var siteCatalystVal={};siteCatalystVal.fname="doTagShareTypes";siteCatalystVal.type="print";siteCatalystVal.doctitle=document.title;siteCatalyst.addToQueue("doTagShareTypes",
siteCatalystVal);siteCatalyst.executeCall("doTagShareTypes");$("body").trigger("beforeprint");sleep(2E3).then(function(){window.print();$(this).parents().find(".table").addClass("dropping_table")});return false})},template:'\x3ca href\x3d"#" class\x3d"ng-binding clearfix float-left full-width"\x3e\x3cimg src\x3d"../images/lot-details/lot-details-sprite.svg" class\x3d"img-responsive print-page"\x3e{{locale.messages["app.label.print"]}}\x3c/a\x3e'}}]);
app.directive("printpage",["siteCatalyst","$q",function(siteCatalyst,$q){return{restrict:"AE",replace:true,link:function(scope,element,attrs){function sleep(time){var deferred=$q.defer();setTimeout(function(){deferred.resolve()},time);return deferred.promise}element.bind("click",function(e){$(this).parents().find(".table").removeClass("dropping_table");var siteCatalystVal={};siteCatalystVal.fname="doTagShareTypes";siteCatalystVal.type="print";siteCatalystVal.doctitle=document.title;siteCatalyst.addToQueue("doTagShareTypes",
siteCatalystVal);siteCatalyst.executeCall("doTagShareTypes");$("body").trigger("beforeprint");sleep(2E3).then(function(){window.print();$(this).parents().find(".table").addClass("dropping_table")});return false})},template:"\x3cli\x3e"+'\x3ca href\x3d"#" class\x3d"ng-binding"\x3e\x3ci class\x3d"fa fa-print"\x3e\x3c/i\x3e{{locale.messages["app.label.print"]}}\x3c/a\x3e\x3c/li\x3e'}}]);
app.directive("lotEmailLink",["copartUser","$location","siteCatalyst","$window",function(copartUser,$location,siteCatalyst,$window){return{restrict:"AE",replace:true,link:function(scope,element,attrs){element.bind("click",function(e){$window.location.href=getEmailContent(copartUser,$location,siteCatalyst,attrs);return false})},template:'\x3ca href\x3d"#" class\x3d"emailpage clearfix"\x3e'+'\x3cimg src\x3d"../images/lot-details/lot-details-sprite.svg" class\x3d"img-responsive email-page"\x3e'+'\x3cspan class\x3d"ng-binding"\x3e{{locale.messages["app.label.email"]}}\x3c/span\x3e'+
"\x3c/a\x3e"}}]);
app.directive("emailpage",["copartUser","$location","siteCatalyst","$window",function(copartUser,$location,siteCatalyst,$window){return{restrict:"AE",replace:true,link:function(scope,element,attrs){element.bind("click",function(e){$window.location.href=getEmailContent(copartUser,$location,siteCatalyst,attrs);return false})},template:'\x3cli id\x3d"email"\x3e'+'\x3ca href\x3d"#" class\x3d"emailpage"\x3e'+'\x3ci class\x3d"fa fa-envelope"\x3e\x3c/i\x3e'+'\x3cspan class\x3d"ng-binding"\x3e{{locale.messages["app.label.email"]}}\x3c/span\x3e'+"\x3c/a\x3e"+
"\x3c/li\x3e"}}]);
app.directive("emailPageSearch",["copartUser","$location","siteCatalyst","$window",function(copartUser,$location,siteCatalyst,$window){return{restrict:"AE",replace:true,link:function(scope,element,attrs){element.bind("click",function(e){var searchObject={};if(typeof scope.getSearchObject==="function"&&!_.isEmpty(scope.getSearchObject()))searchObject=scope.getSearchObject();var searchCriteria=encodeURIComponent(JSON.stringify(searchObject));$window.location.href=getEmailContent(copartUser,$location,
siteCatalyst,attrs,searchCriteria);return false})},template:'\x3cli id\x3d"email"\x3e'+'\x3ca href\x3d"#" class\x3d"emailpage"\x3e'+'\x3ci class\x3d"fa fa-envelope"\x3e\x3c/i\x3e'+'\x3cspan class\x3d"ng-binding"\x3e{{locale.messages["app.label.email"]}}\x3c/span\x3e'+"\x3c/a\x3e"+"\x3c/li\x3e"}}]);
var getEmailContent=function(copartUser,$location,siteCatalyst,attrs,searchCriteria){var siteCatalystVal={};siteCatalystVal.fname="doTagShareTypes";siteCatalystVal.type="email";siteCatalystVal.doctitle=document.title;siteCatalyst.addToQueue("doTagShareTypes",siteCatalystVal);siteCatalyst.executeCall("doTagShareTypes");var siteCode=copartUser.getUserConfig().siteCode;var subject;subject=globalLocale.getMessageStr("app.email.subject",[]);var body;var url=$location.absUrl();if($location.search().searchCriteria){var i=
url.indexOf("searchCriteria\x3d");if(i>-1)url=url.substring(0,i-1);var symbol=url.indexOf("/?")>-1?"\x26":"?";url+=symbol+"searchCriteria\x3d"+searchCriteria}body=globalLocale.getMessageStr("app.email.body",[attrs.doctitle,url]);return"mailto:?subject\x3d"+encodeURIComponent(subject)+"\x26body\x3d"+encodeURIComponent(body)};
app.directive("errorImage",[function(){return{restrict:"A",replace:true,scope:false,link:function postLink(scope,iElement,iAttrs){var errorFunc=function(){angular.element(this).attr("src",iAttrs.errorImage?iAttrs.errorImage:"images/testImages/no_photo.jpg");scope.defaultBanner=true};if(appInit.isUserAgentBOT)errorFunc=function(){};iElement.bind("error",errorFunc)},template:""}}]);
app.directive("locationModal",["dataServiceG2","$rootScope","auctionsCalendarService",function(dataServiceG2,$rootScope,auctionsCalendarService){return{restrict:"A",scope:{yardDetails:"\x3d"},link:function(scope,elem,attrs){var yardNumber=attrs.yardNumber;var self=scope;var showInventory=attrs.showInventory=="true"?true:false;elem.bind("click",function(){getYardDetails(yardNumber)});var getYardDetails=function(yardNumber){dataServiceG2.getLocationDetail(yardNumber,function(response){self.yardDetails=
response.data;auctionsCalendarService.isYardLive(yardNumber).then(function(flag){self.yardDetails.liveAuction=flag});self.yardDetails.showInventory=showInventory;if(self.yardDetails.liveAuction){self.yardDetails.auctionLane=attrs.lane;self.yardDetails.yardNumber=attrs.yardNumber}$rootScope.$emit("yardDetailsLoaded",self.yardDetails);jQuery("#locationGenericModal").modal("show")})}}}}]);
app.directive("livechat",["copartUser","cmsContentService",function(copartUser,cmsContentService){var blockLiveChat=copartUser.getUserConfig().blockLiveChat;if(blockLiveChat)return;else return{restrict:"EA",link:{post:function(scope,elem,attrs){jQuery("#lhnHocButton").show();jQuery("#lhnHelpOutCenter").show()}},templateUrl:function(){return cmsContentService.getCmsContentUrl("/content/us/en/live-chat")}}}]);
app.directive("jivoChat",["copartUser",function(copartUser){var allowJivoChat=copartUser.getUserConfig().allowJivoChat;if(allowJivoChat)return{restrict:"EA",link:{post:function(scope,elem,attrs){angular.element(document.querySelectorAll('script[plugin\x3d"jivoChat"]')).remove();var jivoChatScript='\x3cscript src\x3d"//code.jivosite.com/widget/z76883uYlJ" async plugin\x3d"jivoChat"\x3e\x3c/script\x3e';jQuery("head").append(jivoChatScript)}}};else return}]);
app.directive("copartVehicleIcons",function(){return{restrict:"EA",scope:{},templateUrl:"/public/fetchDirective.html?directive\x3dlotDetail/vehicleHighlightIcons",controller:function($scope,$element,$attrs){},link:function(scope,element,attr){scope.vehicleIconCodes=[];scope.iconCodes=attr.codes;if(scope.iconCodes){var codes=scope.iconCodes.replace(/[\[\]"]+/g,"");var codeslist=codes.split(",");scope.iconCodes=_.filter(codeslist,function(code){return code!="IV"})}}}});
app.directive("checkAccessByPrivilege",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var conditionsStr=attrs.checkAccessByPrivilege;var returnBool=conditionsStr.indexOf("!")>-1?copartUser.hasAccessPrivilege(conditionsStr.split("!")[1]):!copartUser.hasAccessPrivilege(conditionsStr);if(returnBool)element.addClass("hide");else{if(attrs.hasOwnProperty("altUrl"))attrs.$set("href",attrs.altUrl);if(attrs.hasOwnProperty("addClass"))element.addClass(attrs.addClass)}}}}]);
app.directive("checkAccessByRole",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var conditionsStr=attrs.checkAccessByRole;if(conditionsStr.indexOf(" and ")>0||conditionsStr.indexOf(" or ")>0){var roles=conditionsStr.indexOf(" and ")>0?conditionsStr.split(" and "):conditionsStr.split(" or ");var operators={and:function(values){var returnBool=false;for(var i in values)returnBool=returnBool&&(values[i].indexOf("!")>-1?copartUser.hasRoleAccess(values[i].split("!")[1]):
!copartUser.hasRoleAccess(values[i]));return returnBool},or:function(values){var returnBool=false;for(var i in values)returnBool=returnBool||(values[i].indexOf("!")>-1?copartUser.hasRoleAccess(values[i].split("!")[1]):!copartUser.hasRoleAccess(values[i]));return returnBool}};var operator=conditionsStr.indexOf("and")>-1?operators.and:operators.or;if(operator(roles))element.addClass("hide")}else{var returnBool=conditionsStr.indexOf("!")>-1?copartUser.hasRoleAccess(conditionsStr.split("!")[1]):!copartUser.hasRoleAccess(conditionsStr);
if(returnBool)if(attrs.hasOwnProperty("altUrl"))attrs.$set("href",attrs.altUrl);else if(attrs.hasOwnProperty("addClass")){element.addClass(attrs.addClass);if(attrs.addClass=="disabled")attrs.$set("disabled","disabled")}else element.addClass("hide")}}}}]);
app.directive("bufferedScroll",function($parse){return function($scope,element,attrs){var handler=$parse(attrs.bufferedScroll);element.scroll(function(evt){var scrollTop=Math.round(element[0].scrollTop),scrollHeight=element[0].scrollHeight,offsetHeight=element[0].offsetHeight;if(scrollTop===scrollHeight-offsetHeight)$scope.$apply(function(){handler($scope)})})}});
app.directive("lazySrc",["$window","$document",function($window,$document){var doc=$document[0],body=doc.body,win=$window,$win=angular.element(win),uid=0,elements={},forPrint=false;function getUid(el){var __uid=el.data("__uid");if(!__uid)el.data("__uid",__uid=""+ ++uid);return __uid}function getWindowOffset(){var t,pageXOffset=typeof win.pageXOffset=="number"?win.pageXOffset:(((t=doc.documentElement)||(t=body.parentNode))&&typeof t.ScrollLeft=="number"?t:body).ScrollLeft,pageYOffset=typeof win.pageYOffset==
"number"?win.pageYOffset:(((t=doc.documentElement)||(t=body.parentNode))&&typeof t.ScrollTop=="number"?t:body).ScrollTop;return{offsetX:pageXOffset,offsetY:pageYOffset}}function isVisible(iElement){var elem=iElement[0],elemRect=elem.getBoundingClientRect(),windowOffset=getWindowOffset(),winOffsetX=windowOffset.offsetX,winOffsetY=windowOffset.offsetY,elemWidth=elemRect.width,elemHeight=elemRect.height,elemOffsetX=elemRect.left+winOffsetX,elemOffsetY=elemRect.top+winOffsetY,viewWidth=Math.max(doc.documentElement.clientWidth,
win.innerWidth||0),viewHeight=Math.max(doc.documentElement.clientHeight,win.innerHeight||0),xVisible,yVisible;if(elemOffsetY<=winOffsetY){if(elemOffsetY+elemHeight>=winOffsetY)yVisible=true}else if(elemOffsetY>=winOffsetY)if(elemOffsetY<=winOffsetY+viewHeight)yVisible=true;if(elemOffsetX<=winOffsetX){if(elemOffsetX+elemWidth>=winOffsetX)xVisible=true}else if(elemOffsetX>=winOffsetX)if(elemOffsetX<=winOffsetX+viewWidth)xVisible=true;return xVisible&&yVisible}function checkImage(){Object.keys(elements).forEach(function(key){var obj=
elements[key],iElement=obj.iElement,$scope=obj.$scope;if(isVisible(iElement))iElement.attr("src",$scope.lazySrc);if(forPrint)iElement.attr("src",$scope.lazySrc)});forPrint=false}$(document).on("scroll",checkImage);$("body").on("beforeprint",function(event,userLang,region,contentPath){forPrint=true;checkImage()});$(window).beforeprint(function(){forPrint=true;checkImage()});$(window).afterprint(function(){forPrint=false});$win.bind("resize",checkImage);function onLoad(){var $el=angular.element(this),
uid=getUid($el);$el.css("opacity",1);if(elements.hasOwnProperty(uid))delete elements[uid]}return{restrict:"A",scope:{lazySrc:"@",animateVisible:"@",animateSpeed:"@"},link:function($scope,iElement){iElement.bind("load",onLoad);$scope.$watch("lazySrc",function(){var speed="1s";if($scope.animateSpeed!=null)speed=$scope.animateSpeed;if(isVisible(iElement)){if($scope.animateVisible)iElement.css({"background-color":"#fff","opacity":0,"-webkit-transition":"opacity "+speed,"transition":"opacity "+speed});
iElement.attr("src",$scope.lazySrc)}else{var uid=getUid(iElement);iElement.css({"background-color":"#fff","opacity":0,"-webkit-transition":"opacity "+speed,"transition":"opacity "+speed});elements[uid]={iElement:iElement,$scope:$scope}}});$scope.$on("$destroy",function(){iElement.unbind("load");var uid=getUid(iElement);if(elements.hasOwnProperty(uid))delete elements[uid]})}}}]);
app.directive("checkLotLive",["auctionsCalendarService","$filter","userService",function(auctionsCalendarService,$filter,userService){var check=function($scope,$element,$attrs){var self=$scope;self.locale=self.$parent.locale;var auctionLane=$attrs.auctionLane=="undefined"?undefined:$attrs.auctionLane;auctionsCalendarService.isAuctionLive(Number($attrs.yard),$attrs.auctionLane,Number($attrs.auctionDate)).then(function(flag){self.template="";self.isFuture=$attrs.isFuture==="true";var numericDate=Number($attrs.saleDate);
var displaySaleDate=moment.utc(numericDate).tz(userService.userConfig.selectedTimezone).format("MMM DD, YYYY");if(flag)self.template+='\x3cli class\x3d"btn btn-success"\x3e'+self.locale.messages["app.label.live.now"]+"\x3c/li\x3e";else if(self.isFuture)self.template+="\x3cli data-uName\x3d'saleDate'\x3e"+self.locale.messages["app.label.future"]+"\x3c/li\x3e";else self.template+="\x3cli data-uName\x3d'saleDate'\x3e"+displaySaleDate+"\x3c/li\x3e";self.template+="\x3c/ul\x3e"})};return{scope:{},restrict:"AE",
transclude:true,link:check,template:"\x3cdiv ng-bind-html\x3d'template'\x3e\x3c/div\x3e"}}]);
app.directive("contentSlider",function(){return{restrict:"AE",templateUrl:"",link:function($scope,elem,attrs){elem.find(".content_div").addClass("slide_div");setTimeout(function(){elem.find(".content_div").addClass("slide_div").find("div").addClass("mySlides");var myIndex=0;carousel();function carousel(){var i;var x=document.getElementsByClassName("mySlides");for(i=0;i<x.length;i++)x[i].style.display="none";myIndex++;if(myIndex>x.length)myIndex=1;x[myIndex-1].style.display="block";setTimeout(carousel,
2E3)}},1500);elem.ready(function(){})}}});app.directive("backToTop",function(){return{restrict:"E",replace:true,template:'\x3cdiv class\x3d"back-to-top"\x3e\x3ci class\x3d"fa fa-chevron-up"\x3e\x3c/i\x3e\x3c/div\x3e',link:function($scope,element,attrs){console.log($(element),"ele");$(window).scroll(function(){if($(window).scrollTop()<=0)$(element).fadeOut();else $(element).fadeIn()});$(element).on("click",function(e){$("html, body").animate({scrollTop:0},"fast")})}}});
app.directive("disableWhenHidden",["$rootScope",function($rootScope){return{restrict:"A",link:function(scope,attrs){var deleteWatchers=function(){scope.$$watchers=[]};$("#serverSideDataTable").on("page.dt",deleteWatchers)}}}]);
app.directive("transportaionEstimates",["$timeout","dataServiceG2","appConfigService","$filter","$location","$route","siteCatalyst","userService","shippingService","localStorageService","$q","copartUser",function($timeout,dataServiceG2,appConfigService,filter,$location,$route,siteCatalyst,userService,shippingService,localStorageService,$q,copartUser){return{restrict:"A",scope:{estimates:"\x3d",currentEstimatesList:"\x3d"},templateUrl:"/public/fetchDirective.html?directive\x3dtransportation/estimates",
link:function(scope,elem,attrs){scope.lotStatus=attrs.lotStatus;scope.amountDue=attrs.amountDue;scope.lotId=attrs.lotId;scope.memberPickupStatus=attrs.memberPickupStatus;scope.estimates.cuc=userService.userConfig.currencyCode;scope.estimates.showViewMapLink=false;var self=scope;self.locale=scope.$parent.locale;self.appConfig=appConfigService.getAppConfig();self.showDomesticDelivery=scope.$parent.ShwDelEstChecked;self.enableDomesticDelivery=function(){self.showDomesticDelivery=true;scope.getDeliveryEstimate(scope.lotId)};
self.backToDeliveryOptions=function(){self.showDomesticDelivery=false};self.getDynamicLotDetails=function(lotId){var deferred=$q.defer();dataServiceG2.getDynamicLotDetails(lotId,function(response){deferred.resolve(response.data)});return deferred.promise};self.intlShipModel=function(){localStorageService.set("lotNumber",scope.lotId);self.getDynamicLotDetails(scope.lotId).then(function(response){self.dynamiclotDetails=response.data.lotDetails||{};self.showQuoteInDelivery=self.dynamiclotDetails.lotAuctionStatus==
"COUNTER_BIDDING"&&self.dynamiclotDetails.bidStatus=="PAID";self.intlRedirectStatus=$location.search().status;self.intlRedirectTrackingUrl=$location.search().trackingUrl;self.intlRedirectClientRefId=$location.search().clientRefId;self.intlRedirectProviderName=$location.search().providerName;self.getLotDetails(scope.lotId).then(function(response){self.estimates.shiplotDetails=response.data.lotDetails;if(userService.userConfig.defaultDisplayPref&&userService.userConfig.defaultDisplayPref.internationalShipping){var titleTypes=
[];if(userService.userConfig.defaultDisplayPref&&userService.userConfig.defaultDisplayPref.titleType)titleTypes=userService.userConfig.defaultDisplayPref.titleType;self.displayIntlShipping=(self.estimates&&self.estimates.shiplotDetails&&self.estimates.shiplotDetails.lstg!==99&&self.estimates.shiplotDetails.vehTypDesc=="AUTOMOBILE"||self.estimates.shiplotDetails.vehTypDesc=="MOTORCYCLE")&&!self.estimates.shiplotDetails.offFlg&&!titleTypes.includes(self.estimates.shiplotDetails.td);if(self.showQuoteInDelivery)dataServiceG2.lotCurrentShippingStatus(userService.userConfig.buyerNumber,
self.lotId,function(response){self.currentLotShippingLotWonData=[];if(response&&response.returnCode!=-1){for(var i=0;i<response.length;++i)if(response[i].memberShippingItemDetails.trackingUrl){currentLotShipping={};currentLotShipping["providerCode"]=response[i].memberShippingItemDetails.providerCode;currentLotShipping["transactionUrl"]=response[i].memberShippingItemDetails.trackingUrl;currentLotShipping["destinationIso3CountryCode"]=response[i].memberShippingItemDetails.destinationCountryCode;currentLotShipping["destinationPortCode"]=
response[i].memberShippingItemDetails.destinationPortCode;currentLotShipping["trackingStatus"]=response[i].memberShippingItemDetails.trackingStatus;currentLotShipping["providerName"]=response[i].memberShippingItemDetails.providerName;currentLotShipping["destinationPortName"]=response[i].memberShippingItemDetails.destinationPortName;currentLotShipping["destinationCountryName"]=response[i].memberShippingItemDetails.destinationCountryName;currentLotShipping["clientRefId"]=response[i].clientRefId;self.currentLotShippingLotWonData.push(currentLotShipping)}if(self.currentLotShippingLotWonData&&
self.currentLotShippingLotWonData.length>0){self.estimates.currentShipData=self.currentLotShippingLotWonData[0];self.estimates.vendorContactInfoData=self.locale.getMessage("app.label.orderQuestionsModal.")+self.estimates.currentShipData.providerName;jQuery("#shippingSuccessm").modal("show")}}else if(self.intlRedirectStatus!=undefined&&self.intlRedirectTrackingUrl!=undefined&&self.intlRedirectClientRefId!=undefined){self.redirectIntlShipData={};self.redirectIntlShipData["trackingStatus"]=self.intlRedirectStatus;
self.redirectIntlShipData["transactionUrl"]=self.intlRedirectTrackingUrl;self.redirectIntlShipData["clientRefId"]=self.intlRedirectClientRefId;self.redirectIntlShipData["providerName"]=self.intlRedirectProviderName;self.currentLotShippingLotWonData.push(self.redirectIntlShipData);if($location.search().status!=null&&self.currentLotShippingLotWonData&&self.currentLotShippingLotWonData.length>0){self.estimates.redirectIntlShipOrderData=self.currentLotShippingLotWonData[0];self.showDelivery=false;self.displayError=
false;self.estimates.vendorContactData=self.locale.getMessage("app.label.orderQuestionsModal.")+self.estimates.redirectIntlShipOrderData.providerName;$("#redirectShippingModel").modal("show")}}else if(self.displayIntlShipping)jQuery("#intlShipModel").modal("show");else jQuery("#errorMsgModel").modal("show")});else if(self.displayIntlShipping)jQuery("#intlShipModel").modal("show");else jQuery("#errorMsgModel").modal("show")}})})};scope.getDeliveryEstimate=function(lotNumber,isOrderScreen,callBack){var requestParam=
{};var blockEstimateOnLoadLotDetail=false;if(attrs.module=="lotDetails"&&attrs.requestType=="ESTIMATES"&&scope.estimates.newZipCode==undefined)blockEstimateOnLoadLotDetail=true;if(!scope.estimates.newZipCode)scope.estimates.newZipCode=userService.userConfig.buyerZip;requestParam.newZipCode=scope.estimates.newZipCode;requestParam.lotNumber=lotNumber;requestParam.requestType=attrs.requestType;requestParam.module=attrs.module;requestParam.yardNumber=attrs.yardNumber;scope.requestType=attrs.requestType;
scope.module=attrs.module;requestParam.orderScreen=isOrderScreen;if(isOrderScreen)requestParam.locationKey=scope.estimates.selectedLocation.locationKey;if(!blockEstimateOnLoadLotDetail)dataServiceG2.getDeliveryEstimate(requestParam,scope.currentEstimatesList,function(response){scope.showErrorMessage=false;scope.errorMessage="";scope.estimatesObj=response.data;scope.estimates.showViewMapLink=true;if(!_.isUndefined(scope.estimates.selectedScope)){scope.estimates.selectedScope.errorMessage="";scope.estimates.selectedScope.handleableError=
false;scope.estimates.selectedScope.showErrorMessage=false;if(response.returnCode==1){scope.estimates.selectedScope.estimatesObj=scope.estimatesObj;if(isOrderScreen)if(scope.estimatesObj&&scope.estimatesObj.markupPrice)scope.estimates.orderMarkupPrice=scope.estimatesObj.markupPrice;else scope.estimates.orderMarkupPrice=0;else{if(scope.estimatesObj&&scope.estimatesObj.markupPrice)scope.estimates.selectedScope.markupPrice=scope.estimatesObj.markupPrice;else scope.estimates.selectedScope.markupPrice=
0;scope.estimates.selectedScope.transportationOrderStatus=response.data.transportationOrderStatus;scope.estimates.selectedScope.zip=response.data.selectedZipCode}scope.estimates.selectedScope.selectedLotNumber=lotNumber;if(callBack){callBack(response);return}if(response.data.errorObject){scope.estimates.selectedScope.handleableError=true;scope.estimates.selectedScope.errorMessage=response.data.errorObject?response.data.errorObject.trim():""}}else{scope.estimates.selectedScope.zip=requestParam.newZipCode;
scope.estimates.selectedScope.markupPrice=0;scope.estimates.selectedScope.showErrorMessage=true;scope.estimates.selectedScope.errorMessage=response.data.errorObject?response.data.errorObject.trim():""}}else if(response.returnCode==1){if(requestParam.requestType=="ESTIMATES")scope.estimates.newZipCode=response.data.selectedZipCode;else scope.zip=response.data.selectedZipCode;if(scope.estimatesObj&&scope.estimatesObj.markupPrice){scope.markupPrice=scope.estimatesObj.markupPrice;if(scope.currentEstimatesList)scope.currentEstimatesList[lotNumber]=
response.data}else scope.markupPrice=0;scope.transportationOrderStatus=response.data.transportationOrderStatus;if(response.data.errorObject){scope.handleableError=true;scope.errorMessage=response.data.errorObject?response.data.errorObject.trim():"app.label.error.delivery.estimate.unexpected"}}else{scope.showErrorMessage=true;scope.errorMessage=response.data.errorObject?response.data.errorObject.trim():"app.label.error.delivery.estimate.unexpected"}})};scope.openOrderDeliveryModal=function(lotNumber){self.showMemberPickupStatus=
userService.userConfig.defaultDisplayPref.showMemberPickupStatus;if(self.showMemberPickupStatus)dataServiceG2.getMemberPickupStatus(lotNumber,function(response){self.memberPickupStatus=response.data;self.showMemberPickupStatus=userService.userConfig.defaultDisplayPref.showMemberPickupStatus;if(response.returnCode!=-1&&self.memberPickupStatus!="UNKNOWN")$("#stopOrderTransporter").modal("show");else self.executeOrderDeliveryProcess(lotNumber)},function(error){log.error("get member pickup status Call -\x3e Failed "+
error)});else self.executeOrderDeliveryProcess(lotNumber)};self.executeOrderDeliveryProcess=function(lotNumber){scope.estimates.showErrorMessage=false;scope.estimates.disableOrderButton=true;scope.selectedLotNumber=lotNumber;scope.$parent.selectedLotNumber=scope.selectedLotNumber;var successCallBack=function(response){if(response.returnCode==1){scope.estimates.deliveryLocations=response.data.deliveryLocations;if(scope.estimates.deliveryLocations&&scope.estimates.deliveryLocations.length>0){var selectedLocation=
_.filter(scope.estimates.deliveryLocations,function(item){return item.inventoryDeliveryAddressFlag===true});if(selectedLocation.length>0){scope.estimates.selectedLocation=selectedLocation[0];scope.estimates.modifyAddress=true}else{var selectedLocation=_.filter(scope.estimates.deliveryLocations,function(item){return item.deliveryAddressFlag===true});if(selectedLocation.length>0)scope.estimates.selectedLocation=selectedLocation[0]}if(!scope.estimates.selectedLocation||!scope.estimates.selectedLocation.address.zip){scope.estimates.selectedLocation=
scope.estimates.deliveryLocations[0];scope.estimates.selectedLocation.type="location0"}scope.estimates.showAddDeliveryLocation=false;scope.estimates.newZipCode=scope.estimates.selectedLocation.address.zip.zip1;scope.getDeliveryEstimate(scope.selectedLotNumber,true,function(){if(scope.estimates.orderMarkupPrice&&scope.estimates.orderMarkupPrice>0)scope.estimates.disableOrderButton=false})}else scope.selectedLocation={};shippingService.setLotNumber(lotNumber);$("#orderDelivery").modal("show");localStorageService.set("lotNumber",
lotNumber)}};dataServiceG2.getDeliveryLocations(scope.selectedLotNumber,successCallBack)};self.getLotDetails=function(lotNumber){var deferred=$q.defer();dataServiceG2.getLotDetails(lotNumber,function(response){deferred.resolve(response.data)});return deferred.promise};scope.estimates.updateDeliveryEstimate=function(isEstimates,isValid,newZip){scope.estimates.submitted=true;if(!isValid)return;if(isEstimates){scope.markupPrice=0;scope.showErrorMessage=false;scope.getDeliveryEstimate(scope.lotId)}else{scope.estimates.showViewMapLink=
true;self.isZipChanged=true;scope.estimates.newZipCode=newZip;scope.getDeliveryEstimate(scope.estimates.selectedLotNumber);$("#payZipcode").modal("toggle");scope.estimates.newZipCode=self.isDeliveryOrdered||self.isZipChanged?scope.estimates.newZipCode:""}try{var siteCatalystVal={};siteCatalystVal.fname="doTagTransportation";siteCatalystVal.lotId=scope.lotId;siteCatalystVal.zipcode=scope.estimates.newZipCode;siteCatalyst.addToQueue("doTagTransportation",siteCatalystVal);siteCatalyst.executeCall("doTagTransportation")}catch(e){}};
scope.estimates.updateQuote=function(isValid){scope.estimates.submitted=true;scope.estimates.showErrorMessage=false;if(!isValid)return;var successCallBack=function(response){if(response.returnCode==1){scope.estimates.newZipCode=scope.estimates.selectedLocation.address.zip.zip1;scope.getDeliveryEstimate(scope.estimates.selectedLotNumber,true,function(response){if(response.data.errorObject){scope.estimates.errorMessage=response.data.errorObject;scope.estimates.showErrorMessage=true}else{scope.estimates.disableOrderButton=
false;scope.estimates.newLocationEstimates=true}})}else{scope.estimates.errorMessage=response.data.errorObject;scope.estimates.showErrorMessage=true}};dataServiceG2.validateAddress(self.estimates.selectedLocation,successCallBack)};scope.setSelectedRow=function(lotNumber){scope.estimates.selectedLotNumber=lotNumber;scope.estimates.selectedScope=scope};self.estimates.updateAddressEstimate=function(locationType,selectedLocation){scope.estimates.disableOrderButton=true;scope.estimates.showErrorMessage=
false;scope.estimates.submitted=false;if(selectedLocation&&locationType&&locationType.indexOf("location")==0){scope.estimates.showAddDeliveryLocation=false;scope.estimates.selectedLocation=selectedLocation;scope.estimates.selectedLocation.type=locationType;scope.estimates.newZipCode=selectedLocation.address.zip.zip1;scope.getDeliveryEstimate(scope.estimates.selectedLotNumber,true,function(response){if(response.data.errorObject){scope.estimates.errorMessage=response.data.errorObject?response.data.errorObject.trim():
"";scope.estimates.showErrorMessage=true}else if(scope.estimates.orderMarkupPrice&&scope.estimates.orderMarkupPrice>0)scope.estimates.disableOrderButton=false})}else{scope.estimates.showAddDeliveryLocation=true;scope.estimates.orderMarkupPrice=0;scope.estimates.selectedLocation={};scope.estimates.selectedLocation.type=locationType}};self.isDeliveryOrdered=false;self.isZipChanged=false;self.estimates.submitOrder=function(isDeliveryOrdered){self.isDeliveryOrdered=isDeliveryOrdered;var successCallBack=
function(response){if(response.returnCode==1){scope.estimates.selectedScope.transportationOrderStatus="cancel";scope.estimates.selectedScope.markupPrice=scope.estimates.selectedScope.estimatesObj.markupPrice;scope.estimates.selectedScope.zip=self.estimates.selectedLocation.address.zip.zip1;$("#orderDelivery").modal("hide");self.reloadParentPage();scope.estimates.newZipCode=self.isDeliveryOrdered||self.isZipChanged?scope.estimates.newZipCode:""}else{scope.estimates.errorMessage="transportation.generic.error";
scope.estimates.showErrorMessage=true;scope.estimates.disableOrderButton=true}};var transportationVO={};transportationVO.lotId=scope.estimates.selectedLotNumber;transportationVO.modifyAddress=scope.estimates.modifyAddress;transportationVO.deliveryEstimate=scope.estimates.selectedScope.estimatesObj;transportationVO.deliveryLocation=self.estimates.selectedLocation;dataServiceG2.submitOrder(transportationVO,successCallBack)};self.reloadParentPage=function(){var url=$location.url();if(self.estimates.selectedPaymentMethod&&
self.estimates.selectedCurrency)if(url=="/paymentsDue/?paymentMethod\x3d"+self.estimates.selectedPaymentMethod+"\x26currency\x3d"+self.estimates.selectedCurrency){$location.url("/paymentsDue/?paymentMethod\x3d"+self.estimates.selectedPaymentMethod+"\x26currency\x3d"+self.estimates.selectedCurrency);$route.reload()}else $location.search({"paymentMethod":self.estimates.selectedPaymentMethod,"currency":self.estimates.selectedCurrency});else if(url.indexOf("/lot/")==0)scope.getDeliveryEstimate(scope.estimates.selectedLotNumber)};
self.openCancelDeliveryModal=function(lotNumber){scope.estimates.showErrorMessage=false;$("#cancelDelivery").modal("show")};self.estimates.cancelOrder=function(){var successCallBack=function(response){if(response.returnCode==1){$("#cancelDelivery").modal("hide");if(scope.estimates.selectedLotNumber)scope.estimates.selectedScope.transportationOrderStatus="order";self.reloadParentPage()}else{scope.estimates.errorMessage="transportation.generic.error";scope.estimates.showErrorMessage=true}};dataServiceG2.cancelOrder(scope.estimates.selectedLotNumber,
successCallBack)};if(scope.$parent.ShwDelEstChecked||scope.$parent.ShwDelEstChecked==undefined)scope.getDeliveryEstimate(scope.lotId);$("#payZipcode").on("hidden.bs.modal",function(){$(this).find("input,textarea,select").val("").end();scope.estimates.submitted=false});$("#orderDelivery").on("hidden.bs.modal",function(){scope.estimates.disableOrderButton=true;scope.estimates.submitted=false})}}}]);
app.directive("dwhElement",["$rootScope",function($rootScope){return{restrict:"A",link:function(scope,element){var disableWatchers=function(){wArray.length=0;leaveHimToDie(element);isHidden=true};scope.$on("delete-table-watchers",function(){disableWatchers()});var leaveHimToDie=function(elem){var i=0;function getElemWatchers(element){wArray[i]=[];wArray[i][0]=getWatchersFromScope(element.data().$isolateScope);wArray[i][1]=getWatchersFromScope(element.data().$scope);angular.forEach(element.children(),
function(childElement){i++;getElemWatchers(angular.element(childElement))})}function getWatchersFromScope(scope){if(scope){var tmp=scope.$$watchers||[];scope.$$watchers=[];return tmp}else return[]}getElemWatchers(elem)}}}}]);
app.directive("googleplace",function(){return{link:function(scope,element,attrs,model){var options={types:["geocode"]};scope.gPlace=new google.maps.places.Autocomplete(element[0],options);google.maps.event.addListener(scope.gPlace,"place_changed",function(){scope.$apply(function(){scope.details=scope.gPlace.getPlace();var addressLine1="";for(var i=0;i<scope.details.address_components.length;i++){if(scope.details.address_components[i].types[0]=="premise")addressLine1=addressLine1+" "+scope.details.address_components[i].short_name;
if(scope.details.address_components[i].types[0]=="sublocality_level_1")addressLine1=addressLine1+" "+scope.details.address_components[i].short_name;if(scope.details.address_components[i].types[0]=="street_number")addressLine1=scope.details.address_components[i].short_name;if(scope.details.address_components[i].types[0]=="route")addressLine1=addressLine1+" "+scope.details.address_components[i].long_name;if(scope.details.address_components[i].types[0]=="postal_code")scope.personalDetails.zipOrPostalCode=
scope.details.address_components[i].short_name;if(scope.details.address_components[i].types[0]=="locality")scope.personalDetails.city=scope.details.address_components[i].long_name;if(scope.details.address_components[i].types[0]=="administrative_area_level_1")scope.personalDetails.stateOrProvince=scope.details.address_components[i].short_name;var countrySelected;if(scope.details.address_components[i].types[0]=="country"){countrySelected=scope.details.address_components[i].long_name;var short_name=
scope.details.address_components[i].short_name;countrySelected=countrySelected.toString().toUpperCase();var countries=scope.appConfig.getCountries();for(var option in countries)if(countries[option].description==countrySelected){scope.personalDetails.country=countries[option];break}var element=$('[name\x3d"phoneNumber"]');var countryArray=element.intlTelInput.getCountryData();for(var l=0;l<countryArray.length;l++){var country=countryArray[l].name.toUpperCase();if(country.includes("("))country=country.substring(0,
countryArray[l].name.indexOf("(")).trim();if(country==countrySelected){element.intlTelInput("setCountry",countryArray[l].iso2);break}}if(countrySelected!=="UNITED STATES")scope.personalDetails.stateOrProvince=short_name}}scope.personalDetails.address=addressLine1})})}}});
app.directive("googleplaceEditContact",function(){return{link:function(scope,element,attrs,model){var options={types:["geocode"]};scope.gPlace=new google.maps.places.Autocomplete(element[0],options);google.maps.event.addListener(scope.gPlace,"place_changed",function(){scope.$apply(function(){scope.details=scope.gPlace.getPlace();var addressLine1="my address";for(var i=0;i<scope.details.address_components.length;i++){if(scope.details.address_components[i].types[0]=="premise")addressLine1=addressLine1+
" "+scope.details.address_components[i].short_name;if(scope.details.address_components[i].types[0]=="sublocality_level_1")addressLine1=addressLine1+" "+scope.details.address_components[i].short_name;if(scope.details.address_components[i].types[0]=="street_number")addressLine1=scope.details.address_components[i].short_name;if(scope.details.address_components[i].types[0]=="route")addressLine1=addressLine1+" "+scope.details.address_components[i].long_name;if(scope.details.address_components[i].types[0]==
"postal_code")if(scope.details.address_components[i].short_name.toString().includes(" ")){var zip=scope.details.address_components[i].short_name.toString().split(" ");scope.accountInfoVO.mailingAddressZip1=zip[0];scope.accountInfoVO.mailingAddressZip2=zip[1]}else{scope.accountInfoVO.mailingAddressZip2="";scope.accountInfoVO.mailingAddressZip1=scope.details.address_components[i].short_name}if(scope.details.address_components[i].types[0]=="locality")scope.accountInfoVO.mailingAddressCity=scope.details.address_components[i].long_name;
if(scope.details.address_components[i].types[0]=="administrative_area_level_1")scope.accountInfoVO.mailingAddressState=scope.details.address_components[i].short_name;var countrySelected;if(scope.details.address_components[i].types[0]=="country"){countrySelected=scope.details.address_components[i].long_name;var short_name=scope.details.address_components[i].short_name;countrySelected=countrySelected.toString().toUpperCase();var countries=scope.appConfig.getCountries();for(var option in countries)if(countries[option].description==
countrySelected){scope.accountInfoVO.mailingAddressCountry=countries[option].code;break}var element=$('[name\x3d"phoneNumber"]');var countryArray=element.intlTelInput.getCountryData();for(var l=0;l<countryArray.length;l++){var country=countryArray[l].name.toUpperCase();if(country.includes("("))country=country.substring(0,countryArray[l].name.indexOf("(")).trim();if(country==countrySelected){element.intlTelInput("setCountry",countryArray[l].iso2);break}}if(countrySelected!=="UNITED STATES")scope.accountInfoVO.mailingAddressState=
short_name}}scope.accountInfoVO.mailingAddressLine1=addressLine1})})}}});
app.directive("googleplaceEditPref",function(){return{link:function(scope,element,attrs,model){var options={types:["geocode"]};scope.gPlace=new google.maps.places.Autocomplete(element[0],options);google.maps.event.addListener(scope.gPlace,"place_changed",function(){scope.$apply(function(){scope.details=scope.gPlace.getPlace();var addressLine1="";for(var i=0;i<scope.details.address_components.length;i++){if(scope.details.address_components[i].types[0]=="premise")addressLine1=addressLine1+" "+scope.details.address_components[i].short_name;
if(scope.details.address_components[i].types[0]=="sublocality_level_1")addressLine1=addressLine1+" "+scope.details.address_components[i].short_name;if(scope.details.address_components[i].types[0]=="street_number")addressLine1=scope.details.address_components[i].short_name;if(scope.details.address_components[i].types[0]=="route")addressLine1=addressLine1+" "+scope.details.address_components[i].long_name;if(scope.details.address_components[i].types[0]=="postal_code")if(scope.details.address_components[i].short_name.toString().includes(" ")){var zip=
scope.details.address_components[i].short_name.toString().split(" ");scope.accountPrefVO.mailingAddressZip1=zip[0];scope.accountPrefVO.mailingAddressZip2=zip[1]}else{scope.accountPrefVO.mailingAddressZip2="";scope.accountPrefVO.mailingAddressZip1=scope.details.address_components[i].short_name}if(scope.details.address_components[i].types[0]=="locality")scope.accountPrefVO.mailingAddressCity=scope.details.address_components[i].long_name;if(scope.details.address_components[i].types[0]=="administrative_area_level_1")scope.accountPrefVO.mailingAddressState=
scope.details.address_components[i].short_name;var countrySelected;if(scope.details.address_components[i].types[0]=="country"){countrySelected=scope.details.address_components[i].long_name;var short_name=scope.details.address_components[i].short_name;countrySelected=countrySelected.toString().toUpperCase();var countries=scope.appConfig.getCountries();for(var option in countries)if(countries[option].description==countrySelected){scope.accountPrefVO.mailingAddressCountry=countries[option].code;break}var element=
$('[name\x3d"phoneNumber"]');var countryArray=element.intlTelInput.getCountryData();for(var l=0;l<countryArray.length;l++){var country=countryArray[l].name.toUpperCase();if(country.includes("("))country=country.substring(0,countryArray[l].name.indexOf("(")).trim();if(country==countrySelected){element.intlTelInput("setCountry",countryArray[l].iso2);break}}if(countrySelected!=="UNITED STATES")scope.accountPrefVO.mailingAddressState=short_name}}scope.accountPrefVO.mailingAddressLine1=addressLine1})})}}});
app.directive("bindHtmlCompile",["$compile",function($compile){return{restrict:"A",link:function(scope,element,attrs){scope.$watch(function(){return scope.$eval(attrs.bindHtmlCompile)},function(value){element.html(value);$compile(element.contents())(scope)})}}}]);app.directive("videoSlide",[function(){return{restrict:"AE",transclude:false,link:function(scope,elem,attrs){jQuery(".carousel").carousel({interval:false});elem.bind("mouseleave",".carousel",function(e){jQuery(this).carousel("pause")})}}}]);
app.directive("lottooltip",function(){return{restrict:"A",link:function(scope,element,attrs){var params={};params.placement="auto top";params.live=true;params.trigger="manual";if(attrs.popoverid){params.html=true;params.content=function(){return $("#"+attrs.popoverid).html()}}if(attrs.popup=="popupParam"){params.placement="auto left";var isMobile=window.matchMedia("only screen and (max-width: 760px)");if(isMobile.matches)if(attrs.popoverid)params.placement="auto top"}jQuery(element).popover(params);
var action=attrs.action||"click";element.bind(action,function(){jQuery(element).popover("toggle")})}}});app.directive("dropdowncontent",function(){return{restrict:"A",link:function(scope,element,attrs){var params={};jQuery(".dropdown-menu").click(function(e){e.stopPropagation()})}}});
app.directive("tooltip",function(){return{restrict:"A",link:function(scope,element,attrs){var params={};params.placement="auto right";params.live=true;params.trigger="manual";if(attrs.popoverid){params.html=true;params.content=function(){return $("#"+attrs.popoverid).html()}}if(attrs.popup=="popupParam"){params.placement="auto left";var isMobile=window.matchMedia("only screen and (max-width: 760px)");if(isMobile.matches)if(attrs.popoverid)params.placement="auto top"}jQuery(element).popover(params);
var action=attrs.action||"click";element.bind(action,function(){jQuery(element).popover("show")}).on("mouseleave",function(e){jQuery(element).popover("hide")})}}});
app.directive("googleAds",["$timeout","userService",function($timeout,userService){return{restrict:"A",scope:{adPageName:"@",adNumber:"@"},link:function(scope,element,attrs){var isAnonymous=userService.isAnonymous();var googleAdPrefMap;if(userService.userConfig.displayPref[scope.adPageName])googleAdPrefMap=userService.userConfig.displayPref[scope.adPageName];if(!scope.adNumber||!googleAdPrefMap)return;var googleAdPref;if(googleAdPrefMap[scope.adNumber])googleAdPref=googleAdPrefMap[scope.adNumber];
else return;attrs.$set("id",googleAdPref.divSlotId);var slotId="'/"+googleAdPref.slotId+"/"+googleAdPref.adPage+"_"+googleAdPref.adWidth+"x"+googleAdPref.adHeight+"'";var styleParams="["+googleAdPref.adWidth+","+googleAdPref.adHeight+"]";var customDivSlotId="'"+googleAdPref.divSlotId+"'";var customSlotStr=slotId+","+styleParams+","+customDivSlotId;var s=document.createElement("script");s.type="text/javascript";var innerHtml="try{ var googletag \x3d googletag || {};googletag.cmd \x3d googletag.cmd || [];";
innerHtml=innerHtml+"googletag.cmd.push(function() {googletag.defineSlot("+customSlotStr+").addService(googletag.pubads());googletag.enableServices();});";innerHtml=innerHtml+"googletag.cmd.push(function() {googletag.display("+customDivSlotId+");});}catch(e){console.error(e)};";s.innerHTML=innerHtml;element.html(s)}}}]);app.directive("navcollapse",function(){return{restrict:"A",link:function(scope,element,attrs){$(".navbar-collapse .menu_click").click(function(){$(".navbar-collapse").collapse("hide")})}}});
app.directive("clicksigninmenu",[function(){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){$(".header").on("show.bs.collapse",function(){var actives=$(this).find(".collapse.in"),hasData;if(actives&&actives.length){hasData=actives.data("collapse");if(hasData&&hasData.transitioning)return;actives.collapse("hide");hasData||actives.data("collapse",null)}})}}}]);
app.directive("nameAbbr",[function(){return{restrict:"AE",transclude:false,link:function(scope,elem,attrs){var Shortname=$("#outputname").text();var initials=Shortname.match(/\b\w/g)||[];initials=((initials.shift()||"")+(initials.pop()||"")).toUpperCase();$("#outputname").text(initials)}}}]);
app.directive("elipses",[function(){return{restrict:"AE",transclude:false,link:function(scope,elem,attrs){var name=attrs.value||elem.text();elem.attr("title",name);var maxlength=parseInt(attrs.elipses);if(name.length>maxlength)elem.text(name.substring(0,maxlength)+"...")}}}]);app.directive("noResultsView",function(){return{restrict:"E",controller:"noResultsController",scope:false,templateUrl:"/public/fetchDirective.html?directive\x3dvehicleFinder/noresults"}});
app.directive("checkAccessBySitePref",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var sitePrefCode=attrs.prefCode||"";var accessValue=attrs.accessValue||"";var returnBool=copartUser.hasAccessSitePref(sitePrefCode,accessValue);if(!returnBool)element.addClass("hide")}}}]);
app.directive("tagreplace",function(){return{restrict:"A",link:function(scope,$elm,attrs){$(window).resize(function(){if(window.innerWidth<=765)$("pre").contents().unwrap().wrap('\x3cdiv class\x3d"pre"/\x3e');else $("div.pre").contents().unwrap().wrap("\x3cpre /\x3e")});$(window).resize()}}});app.directive("backButton",["$window",function($window){return{restrict:"A",link:function(scope,elem,attrs){elem.bind("click",function(){$window.history.back()})}}}]);
app.directive("hideCookieBanner",["localStorageService","$cookies","userService","userLocationService",function(localStorageService,$cookies,userService,userLocationService){return{restrict:"A",link:function(scope,element,attrs){var hideBanner=function(){element.hide()};var showBanner=function(){element.show()};hideBanner();scope.showCookiePolicy=function(cookiePolicyCountries){if(userService.userConfig.siteRegionCode=="us")userLocationService.getUserLocationInfo().then(function(locationDetails){var locationInfo=
locationDetails||{};var country=locationInfo.countryCode||"";if(!localStorageService.cookie.get("acceptCookiePolicy")&&_.contains(cookiePolicyCountries,country))showBanner()},function(){hideBanner()});else if(!localStorageService.cookie.get("acceptCookiePolicy"))showBanner()};element.on("click","#acceptCookieBanner",function(){localStorageService.cookie.set("acceptCookiePolicy",true);hideBanner()});scope.$watch("cookiePolicyCountries",function(newValue,oldValue){scope.showCookiePolicy(newValue)})}}}]);
app.directive("filterModal",[function(){return{restrict:"EA",controller:function($scope,$element,$attrs){var self=$scope;self.filterModal={step:1,items:[],quickPickCode:"",filter:{}};self.filterModal.init=function(){self.filterModal.step=1;self.filterModal.items=[];self.filterModal.quickPickCode="";self.filterModal.filter={}};self.filterModal.populateItems=function(filter){self.filterModal.step=2;self.filterModal.quickPickCode=filter.quickPickCode;self.filterModal.items=filter.items;self.filterModal.filter=
filter};self.filterModal.back=function(){self.filterModal.init()}}}}]);app.directive("notifications",["cmsContentService",function(cmsContentService){return{restrict:"EA",scope:true,controller:function($scope,$element,$attrs){var self=$scope;self.notifications={};self.notifications.isBrowserOld=appInit.isBrowserOld;self.notifications.oldBrowser=appInit.oldBrowser},templateUrl:function(){return cmsContentService.getCmsContentUrl("Content/US/EN/User/Notifications.html")}}}]);
app.directive("lotExportInCsv",["dataServiceG2","$q","$interpolate","userService",function(dataServiceG2,$q,$interpolate,userService){return{restrict:"EA",scope:{csvUrl:"@",csvCriteria:"@",csvHeader:"\x3d",exportFileName:"@",csvClass:"@",exportLabel:"@"},template:function(element,scope){if(userService.isAnonymous())return'\x3ca check-for-logged-in-user class\x3d"{{csvClass}} full-width" data-uname\x3d"lotsearchExport" id\x3d"exportButton"\x3e'+'\x3cimg src\x3d"../images/lot-details/lot-details-sprite.svg" class\x3d"img-responsive export"\x3e{{exportLabel}}\x3c/a\x3e';
return'\x3ca class\x3d"{{csvClass}} full-width" data-uname\x3d"lotsearchExport" id\x3d"exportButton" ng-csv\x3d"getCSVResult()" filename\x3d"{{exportFileName}}" csv-header\x3d"csvHeader" add-bom\x3d"true"\x3e'+'\x3cimg src\x3d"../images/lot-details/lot-details-sprite.svg" class\x3d"img-responsive export"\x3e{{exportLabel}}\x3c/a\x3e'},link:function(scope,element,attrs){var locale=scope.$parent.locale;scope.exportLabel=scope.exportLabel||(locale?locale.messages["app.label.exportInCSV"]:"Export in CSV");
var convertToJson=function(response){var jsonArray=[];$(response).find("tr").each(function(){var row=[];$(this).find("td").each(function(){row.push(_.unescape($(this).html().trim()))});jsonArray.push(row)});return jsonArray};var url=scope.csvUrl;var csvCriteria=scope.csvCriteria;if(!url){console.log("Service url cannot be empty");return}scope.getCSVResult=function(){var deferred=$q.defer();var csvResult=[];var successCallBack=function(response){var csvResult=convertToJson($interpolate(response.data)(scope.$parent));
deferred.resolve(csvResult)};var failureCallBack=function(){deferred.resolve(csvResult)};dataServiceG2.downloadCSV(url,successCallBack,failureCallBack);return deferred.promise}}}}]);
app.directive("exportCsv",["dataServiceG2","$q","$interpolate","userService",function(dataServiceG2,$q,$interpolate,userService){return{restrict:"EA",scope:{csvUrl:"@",csvCriteria:"@",csvHeader:"\x3d",exportFileName:"@",csvClass:"@",exportLabel:"@"},template:function(element,scope){if(userService.isAnonymous())return'\x3ca check-for-logged-in-user class\x3d"{{csvClass}}" data-uname\x3d"lotsearchExport" id\x3d"exportButton"\x3e\x3ci class\x3d"fa fa-cloud-download"\x3e\x3c/i\x3e{{exportLabel}}\x3c/a\x3e';return'\x3ca class\x3d"{{csvClass}}" data-uname\x3d"lotsearchExport" id\x3d"exportButton" ng-csv\x3d"getCSVResult()" filename\x3d"{{exportFileName}}" csv-header\x3d"csvHeader" add-bom\x3d"true"\x3e\x3ci class\x3d"fa fa-cloud-download"\x3e\x3c/i\x3e{{exportLabel}}\x3c/a\x3e'},
link:function(scope,element,attrs){var locale=scope.$parent.locale;scope.exportLabel=scope.exportLabel||(locale?locale.messages["app.label.export"]:"Export");var convertToJson=function(response){var jsonArray=[];$(response).find("tr").each(function(){var row=[];$(this).find("td").each(function(){row.push(_.unescape($(this).html().trim()))});jsonArray.push(row)});return jsonArray};var url=scope.csvUrl;var csvCriteria=scope.csvCriteria;if(!url){console.log("Service url cannot be empty");return}scope.getCSVResult=
function(){var deferred=$q.defer();var csvResult=[];var successCallBack=function(response){var csvResult=convertToJson($interpolate(response.data)(scope.$parent));deferred.resolve(csvResult)};var failureCallBack=function(){deferred.resolve(csvResult)};dataServiceG2.downloadCSV(url,successCallBack,failureCallBack);return deferred.promise}}}}]);app.directive("preventRightClick",[function(){return{restrict:"A",link:function($scope,$elem){$elem.bind("contextmenu",function(e){e.preventDefault()})}}}]);
app.directive("seeMoreModal",[function(){return{restrict:"A",scope:{modelValue:"\x3dngModel"},link:function(scope,element,attr){var self=scope;angular.element(document.querySelector("#modal-join-auction")).on("click","#saleHighlights_"+attr.yardNumber+"_"+attr.auctionLane,function(){showLaneHighlights()});element.bind("click",function(){showLaneHighlights()});var showLaneHighlights=function(){jQuery("#seeMore").modal("show").find(".modal-body").html(self.modelValue)}}}}]);
app.directive("lotDataIf",function(){return{restrict:"A",link:function($scope,$element,$attr){var attr=$attr;var appPlatform=appInit.appPlatform;if(appPlatform=="gbl")if(!attr.lotDataIf||!attr.lotDataIf.trim()||attr.lotDataIf=="[]")$element.remove()}}});
var facebookPixel=function(isEligible,pixelId){if(pixelId){var scripts=["script","noscript"];angular.element(document.querySelectorAll('noscript[plugin\x3d"facebookPixel"], script[plugin\x3d"facebookPixel"]')).remove();for(var i=0;i<scripts.length;i++){var script=document.createElement(scripts[i]);if(i==0){var innerHtml='if(typeof fbq \x3d\x3d\x3d "undefined") {!function(f,b,e,v,n,t,s){if(f.fbq)return;n\x3df.fbq\x3dfunction(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};';
innerHtml=innerHtml+"if(!f._fbq)f._fbq\x3dn;n.push\x3dn;n.loaded\x3d!0;n.version\x3d'2.0';n.queue\x3d[];t\x3db.createElement(e);t.async\x3d!0;";innerHtml=innerHtml+"t.src\x3dv;s\x3db.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','https://connect.facebook.net/en_US/fbevents.js');";innerHtml=innerHtml+"fbq('init', "+pixelId+"); /*Insert your pixel ID here.*/ fbq('track', 'PageView');fbq('track', '{{fBPixelType}}');}else {fbq('track', '{{fBPixelType}}');}";script.setAttribute("plugin",
"facebookPixel");script.innerHTML=innerHtml;angular.element(document.querySelector("head")).append(script)}else{var innerHtml='\x3cimg height\x3d"1" width\x3d"1" style\x3d"display:none" src\x3d"https://www.facebook.com/tr?id\x3d'+pixelId+'\x26ev\x3dPageView\x26noscript\x3d1"/\x3e';script.setAttribute("plugin","facebookPixel");script.innerHTML=innerHtml;angular.element(document.querySelector("head")).append(script)}}}};
var loadGoogleTagManager=function(GTM_ID){if(GTM_ID){var scripts=["script","noscript"];angular.element(document.querySelectorAll('noscript[plugin\x3d"googletagmanager"], script[plugin\x3d"googletagmanager"],script[src\x3d"http://www.googletagservices.com/tag/js/gpt.js"]')).remove();for(var i=0;i<scripts.length;i++){var script=document.createElement(scripts[i]);if(i==0){var headScript="(function(w,d,s,l,i){w[l]\x3dw[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f\x3dd.getElementsByTagName(s)[0],j\x3dd.createElement(s),dl\x3dl!\x3d'dataLayer'?'\x26l\x3d'+l:'';j.setAttribute('plugin','googletagmanager');j.async\x3dtrue;j.src\x3d'https://www.googletagmanager.com/gtm.js?id\x3d'+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','"+
GTM_ID+"');";script.setAttribute("plugin","googletagmanager");script.innerHTML=headScript;angular.element(document.querySelector("head")).prepend(script)}else{var bodyScript='\x3ciframe src\x3d"https://www.googletagmanager.com/ns.html?id\x3d'+GTM_ID+'" height\x3d"0" width\x3d"0" style\x3d"display:none;visibility:hidden"\x3e\x3c/iframe\x3e';script.setAttribute("plugin","googletagmanager");script.innerHTML=bodyScript;angular.element(document.querySelector("body")).prepend(script)}}}};
var loadGoogleTagManager=function(GTM_ID){if(GTM_ID){var scripts=["script","noscript"];angular.element(document.querySelectorAll('noscript[plugin\x3d"googletagmanager"], script[plugin\x3d"googletagmanager"],script[src\x3d"http://www.googletagservices.com/tag/js/gpt.js"]')).remove();for(var i=0;i<scripts.length;i++){var script=document.createElement(scripts[i]);if(i==0){var headScript="(function(w,d,s,l,i){w[l]\x3dw[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f\x3dd.getElementsByTagName(s)[0],j\x3dd.createElement(s),dl\x3dl!\x3d'dataLayer'?'\x26l\x3d'+l:'';j.setAttribute('plugin','googletagmanager');j.async\x3dtrue;j.src\x3d'https://www.googletagmanager.com/gtm.js?id\x3d'+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','"+
GTM_ID+"');";script.setAttribute("plugin","googletagmanager");script.innerHTML=headScript;angular.element(document.querySelector("head")).prepend(script)}else{var bodyScript='\x3ciframe src\x3d"https://www.googletagmanager.com/ns.html?id\x3d'+GTM_ID+'" height\x3d"0" width\x3d"0" style\x3d"display:none;visibility:hidden"\x3e\x3c/iframe\x3e';script.setAttribute("plugin","googletagmanager");script.innerHTML=bodyScript;angular.element(document.querySelector("body")).prepend(script)}}}};
app.directive("elementReposition",function(){return{restrict:"A",controller:function($scope,$element){var element=$element;angular.element(document.querySelector(".mobile_Adx")).insertAfter(".panel-default:first-of-type")}}});app.directive("menuCollapse",function(){return{restrict:"E",controller:function($scope,$element){$scope.$on("$viewContentLoaded",function(){angular.element(document.querySelector("#bs-example-navbar-collapse-1")).removeClass("in")})}}});
app.directive("toggleCollapse",function(){return{restrict:"A",link:function(scope,element,attrs){$(".special-interests .collapse").on("shown.bs.collapse",function(){$(this).parent().find(".fa-chevron-down").removeClass("fa-chevron-down").addClass("fa-chevron-up")}).on("hidden.bs.collapse",function(){$(this).parent().find(".fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down")})}}});
app.directive("showHideMenu",["$window",function($window){var count=0;return{restrict:"A",link:function($scope,$element,$attr){var menuBlock=angular.element(document.querySelector("#menu-content,#toggle-content"));angular.element(document.querySelector("div[data-target\x3d'#toggle-content'] ,h3[data-target\x3d'#menu-content']")).on("click",function(){if($window.document.body.clientWidth<768){count++;if(count%2){menuBlock.removeClass("hideMenu");menuBlock.addClass("showMenu")}else{menuBlock.removeClass("showMenu");
menuBlock.addClass("hideMenu")}}})}}}]);app.directive("sellVehicleStyle",function(){return{restrict:"A",link:function($scope,$element,$attr){$element.closest(".main-content-widgets-small").find(".row:first-child").removeClass("row");$element.closest(".sectionContent").removeClass("sectionContent")}}});
app.directive("registerAndOrUploadLicense",["copartUser","siteCatalyst","dataServiceG2","copartUtils",function(copartUser,siteCatalyst,dataServiceG2,copartUtils){return{restrict:"AE",replace:true,templateUrl:"/public/fetchDirective.html?directive\x3dregistration/licenseUploadTemplate\x26agent\x3d007",link:function(scope,element,attrs){var self=scope;self.disableUploadBtn=false;var registerAndUploadFile=function(validFileFormats,acceptableFileSize,fileElement,newBuyerNumber,registrationForm,callBack){self.validFileFormats=
validFileFormats;self.acceptableFileSize=acceptableFileSize;self.licenseFile=fileElement;self.message=null;if(!self.validatedFiles&&self.validatedFiles.length<1){self.message=self.locale.getMessage("app.acctInfo.uploadLicense.noFileSelected");return}var formData=new FormData;_.each(self.validatedFiles,function(file,index){formData.append("documentServiceInquiryVOS["+index+"].file",file.file);formData.append("documentServiceInquiryVOS["+index+"].documentCategory",file.documentCategory)});formData.append("applicationName",
"G2MBR");formData.append("destination","CAS");formData.append("fileType","DOCUMENT");formData.append("documentType","BUYER_LICENSE");formData.append("objectType","MEMBER");formData.append("country","US");var uploadFunc;if(registrationForm){formData.append("registrationData",JSON.stringify(registrationForm));uploadFunc=dataServiceG2.uploadRegLicense}else{formData.append("newlyRegisteredBuyerNumber",newBuyerNumber);uploadFunc=dataServiceG2.uploadLicense}uploadFunc(formData,function(response){if(response.returnCodeDesc==
"Success")callBack.onSuccess(response);else callBack.onFailure(response)});return self.message};this.uploadFile=function(validFileFormats,acceptableFileSize,fileElement,newBuyerNumber,callBack){this.registerAndUploadFile(validFileFormats,acceptableFileSize,fileElement,newBuyerNumber,null,callBack)};self.uploadFiles=function(){self.disableUploadBtn=true;if(self.formObj)self.formObj.$setPristine();registerAndUploadFile("pdf,jpg,jpeg,tif,tiff,png,gif",10485760,self.licenseFile,self.newBuyerNumber,self.getRequestData(),
{onSuccess:function(response){self.disableUploadBtn=false;var responseData=response.data;self.registrationSuccessHandler(responseData,self.formObj)},onFailure:function(response){self.disableUploadBtn=false;var responseData=response.data;if(responseData.type=="registration")self.registrationErrorResponseHandler(responseData);else if(responseData.type=="uploadLicense")self.uploadLicenceErrorHandler(responseData);else if(!self.message)self.message=self.locale.getMessage("app.accountinformation.error.errorcode.default");
console.log("Error occurred while uploading the license document!")}})}}}}]);app.directive("openAccordion",["$location",function($location){return{restrict:"EA",link:function(scope,element,attrs){if($location.search().showAcc==="Y")jQuery('a[href\x3d"#'+attrs.id+'"]').trigger("click")}}}]);
app.directive("confirmOnExit",["$location",function($location){return{restrict:"A",append:true,link:function(scope,elem,attrs){var form=attrs.ngForm;if(!form)form=attrs.name;scope.$on("$locationChangeStart",function(event,next,current){if(form&&scope[form].$dirty){event.preventDefault();jQuery("#settingsNotSaved").modal("show");jQuery("#leavePageButton").attr("href",next);jQuery("#leavePageButton").click(function(){scope[form].$setPristine()})}})}}}]);
app.directive("registrationConfirmOnExit",["$location","$window","dataServiceG2",function($location,$window,dataServiceG2){return{restrict:"A",scope:false,link:function(scope,elem,attrs){var form=attrs.ngForm;if(!form)form=attrs.name;scope.$on("$locationChangeStart",function(event,next,current){if(form&&scope[form].$dirty||scope.$parent.showConfirmOnExit){var alertMsg=scope.locale.getMessage("registration.navigation.step.alert.message").toString();event.preventDefault();jQuery("#registrationAlertModal").modal("show");
jQuery("#routeChangeAlertMsg").html(alertMsg);jQuery("#leaveRegistrationButton").click(function(){if(scope[form])scope[form].$setPristine();if(scope.registrationStatus)dataServiceG2.clearRegistrationStatus(function(response){$window.location.href=next});else $window.location.href=next})}})}}}]);
app.directive("selectghost",function(){return{restrict:"A",link:function(scope,element,attrs){$("select").change(function(){if($(this).children("option:first-child").is(":selected"))$(this).addClass("select-ghost-text");else $(this).removeClass("select-ghost-text")})}}});
app.directive("loadMemberInterestChoices",["$templateRequest","$compile","memberChoicesService","memberChoicesConstants",function($templateRequest,$compile,memberChoicesService,memberChoicesConstants){return{restrict:"EA",scope:{selectedMemberChoices:"\x3d"},link:function($scope,element,attrs){var self=$scope;var choiceCategory=attrs.choiceCategory;var filterDiv=memberChoicesConstants.memberChoicesFilterIds[attrs.filterDiv];self.messageKeyForChoices="member.choice."+filterDiv+".";self.choiceTypes=
memberChoicesService.getQuestion(choiceCategory);self.locale=$scope.$parent.locale;self.choiceSelection=function(selChoiceType,selected){memberChoicesService.updateChoiceSelections(choiceCategory,selChoiceType);self.selChoicesDisplayName=memberChoicesService.displaySelectedChoices(choiceCategory)};self.removeSelection=function(list){list.selected=false;self.choiceSelection(list)};self.prePopulateSelectedMemberChoices=function(){_.each(self.selectedMemberChoices,function(selectedMemberChoice){var selectedChoiceTypes=
_.filter(self.choiceTypes.answers,function(answer){return answer.answerCode==selectedMemberChoice.answerCode})[0];if(selectedChoiceTypes){selectedChoiceTypes.selected=true;self.choiceSelection(selectedChoiceTypes,true)}})};$scope.$watch("selectedMemberChoices",self.prePopulateSelectedMemberChoices);$templateRequest("/public/fetchDirective.html?directive\x3dregistration/member-choices").then(function(html){var template=angular.element(html).filter("#"+filterDiv);element.append(template);$compile(template)($scope)})}}}]);
app.directive("runLights",["copartUser","$location","siteCatalyst","$window",function(copartUser,$location,siteCatalyst,$window){return{restrict:"EA",replace:true,scope:{runLightCodes:"\x3d"},template:'\x3cspan style\x3d"margin:1px;" ng-bind-html\x3d"runLightsTemplate"\x3e\x3c/span\x3e',link:function($scope,element,attrs){var runLightsTemplate="";var defaultRunLights=["green","red","yellow","blue"];var lotRunLights=$scope.runLightCodes||[];lotRunLights=lotRunLights.toString().toLowerCase();runLightsTemplate+=
'\x3cspan class\x3d"float-none"\x3e';_.each(defaultRunLights,function(code){if(lotRunLights.indexOf(code)>-1){var highLightedClass="dot";runLightsTemplate+="\x3cspan data-uname\x3d'runLights'  class\x3d'"+code.toLowerCase()+highLightedClass+" no-wrap run-highLight pull-left'\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x3c/span\x3e"}});runLightsTemplate+="\x3c/span\x3e";$scope.runLightsTemplate=runLightsTemplate}}}]);
app.directive("conditionReport",["copartUser","copartUtils","dataServiceG2",function(copartUser,copartUtils,dataServiceG2){return{restrict:"EA",replace:true,scope:true,template:'\x3cspan\x3e\x3ca ng-href\x3d"{{url}}" class\x3d"view-report" target\x3d"_blank"\x3e{{displayName | trim}}\x3c/a\x3e\x3c/span\x3e',link:function($scope,element,attrs){var self=$scope;self.displayName=attrs.displayName||"";var lotNumber=attrs.lotNumber||self.lotNumber;var documentInquiryVO={};documentInquiryVO.objectType=attrs.objectType||
"VEHICLE";documentInquiryVO.fileType=attrs.fileType||"DOCUMENT";documentInquiryVO.country=appInit.regionCode||"US";documentInquiryVO.documentType=attrs.documentType||"CONDITION_REPORT";self.url="/public/condition-report/lot/"+lotNumber;self.url=copartUtils.appendQueryStringToURL(self.url,documentInquiryVO)}}}]);
app.directive("increaseBuyingPower",["copartUser","dataServiceG2","$location","$window",function(copartUser,dataServiceG2,$location,$window){return{restrict:"EA",replace:true,scope:{bidLimitInquiryObj:"\x3d"},link:function($scope,element,attrs){var increaseBuyingPower=function(){var bidLimitInquiryVO=$scope.bidLimitInquiryObj;var callBackUrl=attrs.callBackUrl;bidLimitInquiryVO.lotNumber=bidLimitInquiryVO.lotNumber||0;bidLimitInquiryVO.buyingPower=bidLimitInquiryVO.buyingPower||0;bidLimitInquiryVO.depositAmount=
bidLimitInquiryVO.depositAmount||0;dataServiceG2.increaseBuyingPower(bidLimitInquiryVO,function(response){if(response.returnCode==1){var batchNumber=response.data.batchNumber;var requestParam={};requestParam.transactionId=batchNumber;requestParam.GATEWAY_URL_KEY="INCREASE_BUYING_POWER";requestParam.cancelCallBackUrl=callBackUrl;requestParam.successCallBackURL=callBackUrl;requestParam.cookieValue=$location.path();dataServiceG2.setPciParam(requestParam,function(response){if(response.returnCode==1)$window.location.href=
response.data.pciURL.trim();else log.error("Error in Gateway")})}})};element.bind("click",function(){increaseBuyingPower()})}}}]);app.directive("contentNgHref",["cmsContentService",function(cmsContentService){return{restrict:"A",transclude:false,link:function(scope,element,attr){var path=attr.contentNgHref;jQuery(element).removeAttr("content-ng-href");var finalUrl=path;try{finalUrl=cmsContentService.getContentUrl(path)}catch(e){}jQuery(element).attr("href",finalUrl)}}}]);
app.directive("matchValidator",function($parse){return{require:"ngModel",link:function(scope,elem,attrs,ctrl){scope.$watch(function(){var currentValue=ctrl.$modelValue?ctrl.$modelValue.toLowerCase():"";var matchingValue=$parse(attrs.matchValidator)(scope);matchingValue=matchingValue?matchingValue.toLowerCase():"";return currentValue===matchingValue},function(currentValue){ctrl.$setValidity("mismatch",currentValue)})}}});
app.directive("reviveBannerTagging",[function(){return{restrict:"A",transclude:false,link:function(scope,elem,attrs){elem.bind("click",function(e){scope.doTagHomePageBannerZoneId(attrs.zoneid)})}}}]);
app.directive("internationalShipping",["$timeout","dataServiceG2","appConfigService","$filter","$location","$route","siteCatalyst","userService","shippingService","localStorageService",function($timeout,dataServiceG2,appConfigService,filter,$location,$route,siteCatalyst,userService,shippingService,localStorageService){return{restrict:"A",templateUrl:"/public/fetchDirective.html?directive\x3dtransportation/internationalShipping",link:function(scope,elem,attrs){var shippingPortData={};dataServiceG2.getCountriesForShipping(function(response){shippingPortData=
response.data;var countryData=[];Object.keys(shippingPortData).forEach(function(k){countryData.push({countryCode:k,countryName:shippingPortData[k].countryName})});scope.countryCodes=countryData});scope.getPorts=function(country){scope.countryCd=country.countryCode;scope.portData=[];scope.shipPortData=[];scope.redirectOriginator=$location.url();if(!localStorageService.get("lotNumber"))shippingService.setLotNumber(scope.lotNumber);else{var lotNumber=localStorageService.get("lotNumber");shippingService.setLotNumber(lotNumber);
localStorageService.remove("lotNumber")}shippingService.setDestinationCountryName(scope.shippingCountryCodes.countryName);shippingService.setDestinationCountryCode(scope.countryCd);if(shippingPortData.hasOwnProperty(scope.countryCd)){scope.shipPortData=shippingPortData[scope.countryCd].portCities;for(var i=0;i<scope.shipPortData.length;i++)scope.portData.push({portName:scope.shipPortData[i].portName,portCode:scope.shipPortData[i].portCode})}};scope.selectPort=function(port){shippingService.setPort(port)};
if(localStorageService.get("lot-navigation-info"))localStorageService.set("lot-navigation-info-shipping",localStorageService.get("lot-navigation-info"))}}}]);app.directive("bindValueToModal",["$parse",function($parse){return{restrict:"EA",require:"?ngModel",link:function postLink(scope,iElement,iAttrs,ngModelController){if(iAttrs.value&&ngModelController){console.log("iAttrs.value is:"+iAttrs.value);ngModelController.$setViewValue(iAttrs.value)}}}}]);
app.directive("datepicker",function(){return{restrict:"A",require:"ngModel",link:function(scope,elem,attrs,ngModelCtrl){var updateModel=function(dateText){scope.$apply(function(){ngModelCtrl.$setViewValue(dateText)})};var options={dateFormat:"dd/mm/yy",onSelect:function(dateText){updateModel(dateText)}};elem.datepicker(options)}}});
app.directive("showHidePassword",function(){return{restrict:"EA",link:function(scope,elem,attrs){var self=scope;self.showPassword=false;elem.bind("click",function(e){self.showPassword=!self.showPassword;self.$apply()})}}});
app.directive("copartVideo",["$sce",function($sce){return{restrict:"AE",link:function(scope,element,attrs){var videoUrl=attrs.videourl;var url=videoSourceURL(videoUrl);var videoType=url.substring(url.indexOf("?")+1);scope.mp4Url=getMp4Url(videoUrl);scope.finalUrl=videoUrl;scope.videoType=videoType;function getMp4Url(url){url=url.substring(0,url.lastIndexOf("."))+".mp4";return url}function videoSourceURL(url){if(url.lastIndexOf(".m3u8")===url.length-5)url=url+"?"+"application/x-mpegurl";else if(url.lastIndexOf(".mp4")===
url.length-4)url=url+"?"+"video/mp4";else if(url.lastIndexOf(".webm")===url.length-5)url=url+"?"+"video/webm";else if(url.lastIndexOf(".ogx")===url.length-4)url=url+"?"+"video/ogg";else if(url.lastIndexOf(".ogv")===url.length-4)url=url+"?"+"video/ogg";else if(url.lastIndexOf(".oga")===url.length-4)url=url+"?"+"video/ogg";else if(url.lastIndexOf(".flv")===url.length-4)url=url+"?"+"video/x-flv";else if(url.lastIndexOf(".ts")===url.length-3)url=url+"?"+"video/MP2T";else if(url.lastIndexOf(".3gpp")===
url.length-5)url=url+"?"+"video/3gpp";else if(url.lastIndexOf(".mov")===url.length-4)url=url+"?"+"video/quicktime";else if(url.lastIndexOf(".avi")===url.length-4)url=url+"?"+"video/x-msvideo";else if(url.lastIndexOf(".wmv")===url.length-4)url=url+"?"+"video/x-ms-wmv";return url}},template:' \x3cvideo width\x3d"100%" height\x3d"auto" controls\x3e'+"\x3csource src\x3d'{{$sce.trustAsResourceUrl(mp4Url)}}' type\x3d'video/mp4'\x3e "+"\x3csource src\x3d'{{$sce.trustAsResourceUrl(finalUrl)}}' type\x3d'{{videoType}}'\x3e"+
"\x3c/video\x3e",replace:true}}]);app.directive("allowAccessByPrivilege",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var conditionsStr=attrs.allowAccessByPrivilege;var returnBool=!copartUser.hasAccessPrivilege(conditionsStr);if(returnBool)element.addClass("hide");else{if(attrs.hasOwnProperty("altUrl"))attrs.$set("href",attrs.altUrl);if(attrs.hasOwnProperty("addClass"))element.addClass(attrs.addClass)}}}}]);
app.directive("blockAccessByPrivilege",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var conditionsStr=attrs.blockAccessByPrivilege;var returnBool=copartUser.hasAccessPrivilege(conditionsStr);if(returnBool)element.addClass("hide");else{if(attrs.hasOwnProperty("altUrl"))attrs.$set("href",attrs.altUrl);if(attrs.hasOwnProperty("addClass"))element.addClass(attrs.addClass)}}}}]);
app.directive("allowAccessByRole",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var conditionsStr=attrs.allowAccessByRole;if(conditionsStr.indexOf(" and ")>0||conditionsStr.indexOf(" or ")>0){var roles=conditionsStr.indexOf(" and ")>0?conditionsStr.split(" and "):conditionsStr.split(" or ");var operators={and:function(values){var returnBool=false;for(var i in values)returnBool=returnBool&&!copartUser.hasRoleAccess(values[i]);return returnBool},or:function(values){var returnBool=
false;for(var i in values)returnBool=returnBool||!copartUser.hasRoleAccess(values[i]);return returnBool}};var operator=conditionsStr.indexOf("and")>-1?operators.and:operators.or;if(operator(roles))element.addClass("hide")}else{var returnBool=!copartUser.hasRoleAccess(conditionsStr);if(returnBool)if(attrs.hasOwnProperty("altUrl"))attrs.$set("href",attrs.altUrl);else if(attrs.hasOwnProperty("addClass"))element.addClass(attrs.addClass);else element.addClass("hide")}}}}]);
app.directive("blockAccessByRole",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var conditionsStr=attrs.blockAccessByRole;if(conditionsStr.indexOf(" and ")>0||conditionsStr.indexOf(" or ")>0){var roles=conditionsStr.indexOf(" and ")>0?conditionsStr.split(" and "):conditionsStr.split(" or ");var operators={and:function(values){var returnBool=false;for(var i in values)returnBool=returnBool&&copartUser.hasRoleAccess(values[i]);return returnBool},or:function(values){var returnBool=
false;for(var i in values)returnBool=returnBool||copartUser.hasRoleAccess(values[i]);return returnBool}};var operator=conditionsStr.indexOf("and")>-1?operators.and:operators.or;if(operator(roles))element.addClass("hide")}else{var returnBool=copartUser.hasRoleAccess(conditionsStr);if(returnBool)if(attrs.hasOwnProperty("altUrl"))attrs.$set("href",attrs.altUrl);else if(attrs.hasOwnProperty("addClass"))element.addClass(attrs.addClass);else element.addClass("hide")}}}}]);
app.directive("allowAccessByPreference",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var sitePrefCode=attrs.prefCode||"";var accessValue=attrs.accessValue||"";var returnBool=copartUser.hasAccessSitePref(sitePrefCode,accessValue);if(!returnBool)element.addClass("hide")}}}]);
app.directive("blockAccessByPreference",["copartUser",function(copartUser){return{restrict:"AE",link:function(scope,element,attrs){var sitePrefCode=attrs.prefCode||"";var accessValue=attrs.accessValue||"";var returnBool=copartUser.hasAccessSitePref(sitePrefCode,accessValue);if(returnBool)element.addClass("hide")}}}]);
app.directive("cmsContentFragment",["$sce","$rootScope","$timeout","cmsContentService",function($sce,$rootScope,$timeout,cmsContentService){return{transclude:true,restrict:"AE",scope:true,link:function(scope,element,attrs){cmsContentService.getFragmentContent(attrs.parentId).then(function(data){scope.fragmentedCms=jQuery(data).filter("#"+attrs.fragmentId);if(attrs.removeInlineStyle||attrs.removeInlineStyle==="")jQuery(scope.fragmentedCms).find("[style]").removeAttr("style");scope.fragmentedCms=jQuery(scope.fragmentedCms).html();
if(scope.fragmentedCms&&scope.fragmentedCms.indexOf("]]\x26gt;")>-1)scope.fragmentedCms=scope.fragmentedCms.replace(new RegExp("]]\x26gt;","g"),"");scope.fragmentedCms=$sce.trustAsHtml(scope.fragmentedCms);scope.loaded=true})},template:'\x3cng-transclude ng-if\x3d"!loaded"\x3e\x3c/ng-transclude\x3e\x3cdiv ng-bind-html\x3d"fragmentedCms"\x3e\x3c/div\x3e'}}]);
app.directive("cmsContent",["cmsContentService",function(cmsContentService){return{restrict:"AE",templateUrl:function(element,attrs){return cmsContentService.getCmsContentUrl(attrs.fragment)},link:function($scope,elem,attrs){elem.ready(function(){$(elem).find("a").each(function(){var href=$(this).attr("href");if(href){var redirectHref=href.replace("~","");var hrefLowerCase=redirectHref.toLowerCase();$(this).attr("href",redirectHref)}});if($(elem).html()&&$(elem).html().indexOf("]]\x26gt;")>-1){var modifiedHtml=
$(elem).html().replace("]]\x26gt;","");$(elem).html(modifiedHtml)}})}}}]);
app.directive("lotHighlightsToolTip",["cmsContentService","$q","$http","deviceService",function(cmsContentService,$q,$http,deviceService){return{restrict:"AE",scope:{popoverid:"@"},link:function(scope,element,attrs){var parentFragmentId="Content/"+appInit.regionCode+"/"+appInit.localeString+"/_LotIcons/Lot-Icon-List.html";var action=attrs.action||"click";var isMobileDevice=deviceService.isMobileDevice();if(isMobileDevice)jQuery("body").addClass("cursor-pointer");element.popover({html:true,placement:"auto right",
live:true,trigger:"manual",content:'\x3cdiv\x3e\x3cimg src\x3d"./images/icons/loader.gif"\x3e\x3c/div\x3e'});element.bind(action,function(){var e=$(this);e.off("hover");$(element).popover("toggle");var promise=cmsContentService.getFragmentContent(parentFragmentId);promise.then(function(fragmentCMSContent){fragmentCMSContent=jQuery(fragmentCMSContent).filter("#"+attrs.fragmentId);var popover=$(element).data("bs.popover");popover.tip().find(".popover-content").html(fragmentCMSContent)})}).on("mouseleave",
function(e){var e=$(this);e.popover("hide")})}}}]);
app.directive("reviveFragmentedContent",["$sce","cmsContentService","userService","$location","copartUser",function($sce,cmsContentService,userService,$location,copartUser){return{transclude:true,restrict:"AE",scope:true,link:function(scope,element,attrs,parentCtrl){var reviveUrl="";var setReviveParams=function(){var isAnonymous=userService.isAnonymous();var membershipType=copartUser.getUserConfig().membershipType||"membershipType";var licenceCategory=copartUser.getUserConfig().licenceCategory||"";
var pageUrl=$location.path();reviveUrl="\x26ismember\x3dtrue\x26isloggedin\x3d"+!isAnonymous+"\x26membertype\x3d"+membershipType+"\x26sitelang\x3den\x26pageurl\x3d"+pageUrl+"\x26intcmp\x3d\x26cid\x3d\x26eid\x3d\x26memberlicensecategory\x3d"+licenceCategory;if(attrs.reviveappendurl)reviveUrl=reviveUrl+attrs.reviveappendurl};cmsContentService.getFragmentContent(attrs.parentId).then(function(data){setReviveParams();scope.fragmentedCms=jQuery(data).filter("#"+attrs.fragmentId);scope.fragmentedCms=jQuery(scope.fragmentedCms).html();
if(scope.fragmentedCms&&scope.fragmentedCms.indexOf("?WCOPARAMS")>-1)scope.fragmentedCms=scope.fragmentedCms.replace("?WCOPARAMS",reviveUrl);scope.fragmentedCms=$sce.trustAsHtml(scope.fragmentedCms);if(scope.fragmentedCms)scope.loaded=true;else scope.loaded=false})},template:'\x3cng-transclude ng-if\x3d"!loaded"\x3e\x3c/ng-transclude\x3e\x3cdiv ng-bind-html\x3d"fragmentedCms"\x3e\x3c/div\x3e'}}]);
app.directive("fileUpload",["copartUtils","constants","smoothScroll",function(copartUtils,constants,smoothScroll){return{restrict:"A",controller:function($scope,$element,$attrs){var self=$scope;self.loadingGif=false;self.uploadObjs=[];self.inputDocumentType={};self.validatedFiles=[];self.failedFiles=[];self.documentTypeSelected=false;self.chooseFiles=function(){self.documentSubmitFailure=false;self.userSubmitted=false;if(self.inputDocumentType.documentCategoryName!==undefined){if(_.isFunction(self.validatedDocumentMetaData))if(!self.validatedDocumentMetaData())return;
self.message="";self.loadingGif="true";self.failedFiles=[];elem.trigger("click");self.documentTypeSelected=false}else{self.documentTypeSelected=true;self.documentTypeSelected?smoothScroll.targetElement("documentUpload"):"";self.errorField=true}};var inputBrowseElement=document.getElementById("inputBrowse");function clearLoading(){if(!inputBrowseElement.value.length)self.loadingGif=false;document.body.onfocus=null}inputBrowseElement.onclick=function(){inputBrowseElement.value=null;document.body.onfocus=
clearLoading};self.addUploadObject=function(file,fullName,category){self.documentMetaData=self.documentMetaData||{};self.documentMetaData.file=file;self.uploadObjs.push({file:file,name:fullName,category:self.inputDocumentType.documentCategoryName,country:self.documentMetaData.country,state:self.documentMetaData.state,documentNumber:self.documentMetaData.documentNumber,expDate:self.documentMetaData.expDate,documentMetaData:self.documentMetaData});self.showDocUpForm=false;self.showDocUpLink=false};
var elem=$element.siblings("#inputBrowse");var sizeLimit=$attrs.sizeLimit||constants.MAX_ACCEPTED_FILE_SIZE;var validFormats=elem.attr("accept")||"pdf,jpg,jpeg,tif,tiff,png,gif";var validFormatsArray=copartUtils.splitIntoArray(validFormats,",",true);elem.on("change",function(evt){var files=elem[0].files||[];_.each(files,function(file){var fullName=file.name;var ext=fullName.substring(fullName.lastIndexOf(".")+1,fullName.length).toLowerCase();var nameOnly=fullName.replace("."+ext,"");if(nameOnly.length<=
15)fullName=nameOnly+"."+ext;else fullName=nameOnly.substr(0,15)+"[...]"+"."+ext;if(copartUtils.validateFile(file,validFormatsArray,sizeLimit)){var validatedFile={};validatedFile.file=file;validatedFile.documentCategory=self.inputDocumentType?self.inputDocumentType.documentCategoryCode:undefined;validatedFile.documentMetaData=self.documentMetaData;self.validatedFiles.push(validatedFile);self.addUploadObject(file,fullName);self.$emit("computeDocUploadWarningMsg",self.validatedFiles)}else{if(file.size>
sizeLimit)self.message=self.locale.getMessage("app.acctInfo.uploadLicense.sizeLimitValidationMessage",copartUtils.bytesToSize(sizeLimit));else self.message=self.locale.getMessage("app.acctInfo.uploadLicense.validationMessage");if(self.failedFiles.indexOf(nameOnly)==-1){self.largeFile=true;self.failedFiles.push(nameOnly+" "+self.message)}}});self.loadingGif=false;self.$apply()})}}}]);
app.directive("phoneinput",["copartUser","dataServiceG2",function(copartUser,dataServiceG2){return{restrict:"E",replace:true,scope:{myModel:"\x3dbindObject",errors:"\x3d",altPhone:"\x3d",lowerLimit:"\x3d",upperLimit:"\x3d",dialCode:"\x3ddialCodeBindObj",countryCode:"\x3dcountryCodeBindObj",enableCountryFlags:"\x3c",mandatory:"\x3d",placeholder:"\x3d"},controller:function($scope,$element,$attrs){var self=$scope;self.locale=dataServiceG2.getLocale();self.addCountryCodeToDOM=function(element){var countryCodeElement=
$(element).find('[class\x3d"countryCode"]');if(countryCodeElement)countryCodeElement.text(self.countryCode)};self.bindCountryCode=function(countryData,iElement){self.dialCode=countryData?countryData.dialCode:"";self.countryCode=countryData?countryData.iso2:"";self.addCountryCodeToDOM(iElement)};self.validatePhone=function(phoneNum){phoneNum=phoneNum.replace(/[^a-zA-Z0-9]+/g,"");if(self.mandatory||phoneNum!="")if(appInit.regionCode==="us"){var isValidNumber=$element.find('[name\x3d"phoneNumber"]').intlTelInput("isValidNumber");
if(self.errors)self.errors[$attrs.id]=!isValidNumber}else{var userConfig=copartUser.getUserConfig();var numRegex=new RegExp("^[0-9]*$");var isValidNumber=numRegex.test(phoneNum)&&phoneNum.length<=self.upperLimit&&phoneNum.length>=self.lowerLimit;if(self.errors)self.errors[$attrs.id]=!isValidNumber}else if(self.errors)self.errors[$attrs.id]=false}},link:{pre:function($scope,iElement,iAttrs,controller){},post:function($scope,iElement,iAttrs,controller){var self=$scope;var userConfig=copartUser.getUserConfig();
var countryFlagsPreference=userConfig.countryFlagsPreference||{};var enableCountryFlags=true;var preferredCountries=countryFlagsPreference.prefCountries||["us","fr","gb"];$scope.phoneInputGhostText=self.placeholder!=null?self.placeholder:$scope.locale.messages["culture.label.phoneInputGhostText"];var phoneElement=$(iElement).find('[name\x3d"phoneNumber"]');if(enableCountryFlags){phoneElement.intlTelInput({utilsScript:"/js/lib/intlTelInput/utils.js",autoPlaceholder:false,separateDialCode:true,preferredCountries:preferredCountries});
phoneElement.on("countrychange",function(e,countryData){self.bindCountryCode(countryData,iElement)});if(!self.countryCode){var selectedCountryFlagObj=phoneElement.intlTelInput("getSelectedCountryData")||{};self.bindCountryCode(selectedCountryFlagObj,iElement)}else phoneElement.intlTelInput("setCountry",self.countryCode);var selectedCountryFlagObj=phoneElement.intlTelInput("getSelectedCountryData")||{};self.bindCountryCode(selectedCountryFlagObj,iElement)}$(iElement).formValidation({framework:"bootstrap",
icon:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{intlInput:{validators:{callback:{message:"\x26nbsp;",callback:function(value,validator,$field){if(appInit.regionCode==="us"){var isValidNumber=$field.intlTelInput("isValidNumber");if(isValidNumber){var numRegex=new RegExp("^[0-9()+-]*$");isValidNumber=numRegex.test(value);$scope.errors.phoneNumber=!isValidNumber}return isValidNumber}}}}}}}).on("click",".country-list",function(){$(iElement).formValidation("revalidateField",
"phoneNumber")})}},template:function(elem,attr,controller,scope){return'\x3cform class\x3d"form-horizontal"\x3e'+'\x3cinput ng-model\x3d"myModel" ng-change\x3d"validatePhone(myModel)" placeholder\x3d"{{phoneInputGhostText}}" minlength\x3d"10" type\x3d"tel" class\x3d"form-control  border_rad4 phone_input phn_popover dinline" name\x3d"phoneNumber" ng-attr-required\x3d"mandatory" /\x3e'+'\x3cdiv style\x3d"float:left"\x3e\x3cspan class\x3d"error" ng-show\x3d"errors.'+attr.id+'"\x3e{{locale.messages["registration.phonenumber.invalid"]}}\x3c/span\x3e\x3c/div\x3e'+
"\x3c/form\x3e"}}}]);
app.directive("phoneComponent",["copartUser","dataServiceG2",function(copartUser,dataServiceG2){return{restrict:"E",replace:true,templateUrl:"/public/fetchDirective.html?directive\x3dregistration/phoneInputTemplate\x26agent\x3d007",scope:{phoneObj:"\x3dbindObject",errors:"\x3d",lowerLimit:"\x3d",upperLimit:"\x3d",enableCountryFlags:"\x3c",mandatory:"\x3d",showPhoneType:"\x3d",id:"@",submitted:"\x3d?"},controller:function($scope,$element,$attrs){var self=$scope;self.locale=dataServiceG2.getLocale();self.bindCountryCode=
function(countryData,iElement){self.phoneObj.intlDialCode=countryData?countryData.dialCode:"";self.phoneObj.isoTwoCharCntryCode=countryData?countryData.iso2:""}},link:{pre:function($scope,iElement,iAttrs,controller){},post:function($scope,iElement,iAttrs,controller){var self=$scope;var phoneNumberValidFlag=true;var phoneTypeValidFlag=true;self.mandatory=Boolean(self.mandatory);self.phoneObj=self.phoneObj||new PhoneVO;self.defaultPhoneType=iAttrs.defaultPhoneType||"MOBILE";self.showPhoneType=Boolean(self.showPhoneType);
self.submitted=Boolean(self.submitted);self.phoneTypeList=[{code:"MOBILE",description:self.locale.messages["app.label.phoneType.MOBILE"]},{code:"WORK",description:self.locale.messages["app.label.phoneType.WORK"]},{code:"HOME",description:self.locale.messages["app.label.phoneType.HOME"]}];var userConfig=copartUser.getUserConfig();var countryFlagsPreference=userConfig.countryFlagsPreference||{};var enableCountryFlags=true;var preferredCountries=countryFlagsPreference.prefCountries||["us","fr","gb"];
$scope.phoneInputGhostText=$scope.locale.messages["culture.label.phoneInputGhostText"];var handleErrorForPhoneType=function(flag){if(self.phoneComponentForm&&self.phoneComponentForm.phoneType)self.phoneComponentForm.phoneType.$setValidity("valid",flag)};var handleErrorForPhoneNumber=function(flag){if(self.phoneComponentForm&&self.phoneComponentForm.phoneNumber)self.phoneComponentForm.phoneNumber.$setValidity("valid",flag)};self.validatePhoneType=function(){handleErrorForPhoneType(Boolean(self.phoneObj.phoneType))};
self.validatePhone=function(phoneNum){phoneNum=phoneNum&&(isNaN(phoneNum)?phoneNum.replace(/[^a-zA-Z0-9]+/g,"")||"":phoneNum);self.phoneObj.phoneNumber=phoneNum;if(phoneNum||self.mandatory){var isValidNumber=iElement.find('[name\x3d"phoneNumber"]').intlTelInput("isValidNumber");phoneNumberValidFlag=isValidNumber&&phoneNum.length<=self.upperLimit&&phoneNum.length>=self.lowerLimit;phoneTypeValidFlag=Boolean(self.phoneObj.phoneType)}else{phoneNumberValidFlag=true;phoneTypeValidFlag=true}handleErrorForPhoneNumber(phoneNumberValidFlag);
if(self.showPhoneType)handleErrorForPhoneType(phoneTypeValidFlag)};if(enableCountryFlags){var phoneElement=$(iElement).find('[name\x3d"phoneNumber"]');var countryData=phoneElement.intlTelInput.getCountryData();phoneElement.intlTelInput({utilsScript:"/js/lib/intlTelInput/utils.js",autoPlaceholder:false,separateDialCode:true,preferredCountries:preferredCountries});phoneElement.on("countrychange",function(e,countryData){self.bindCountryCode(countryData,iElement)});var getDefaultCountryCodeObj=function(){return _.find(countryData,
{"iso2":_.first(preferredCountries)})};var getSelectedCountryCodeObj=function(){return _.find(countryData,{"iso2":self.phoneObj.isoTwoCharCntryCode})||_.find(countryData,{"dialCode":self.phoneObj.intlDialCode})||getDefaultCountryCodeObj()};var prepopulateCountryFlag=function(){var getCountryCodeObj=getSelectedCountryCodeObj();self.bindCountryCode(getCountryCodeObj,iElement)};var initPhoneType=function(){if(!self.phoneObj.phoneType||self.phoneObj.phoneType=="UNKNOWN")self.phoneObj.phoneType=self.defaultPhoneType;
if(self.phoneObj.phoneNumber)self.validatePhoneType()};var init=function(){prepopulateCountryFlag();initPhoneType()};init()}}}}}]);
app.directive("licenseUploadModal",["copartUser","siteCatalyst","dataServiceG2","copartUtils","licenseUploadFactory","$window",function(copartUser,siteCatalyst,dataServiceG2,copartUtils,licenseUploadFactory,$window){return{restrict:"AE",replace:true,templateUrl:"/public/fetchDirective.html?directive\x3dregistration/liceseUploadModal\x26agent\x3d007",link:function(scope,element,attrs){var self=scope;self.disableUploadBtn=false;self.uploadStatus=false;self.uploadFiles=function(){self.disableUploadBtn=
true;self.message=null;if(!self.validatedFiles&&self.validatedFiles.length<1){self.message=self.locale.getMessage("app.acctInfo.uploadLicense.noFileSelected");return}var formData=copartUtils.getFormDataForLicenseUpload(self.validatedFiles,licenseUploadFactory.params);dataServiceG2.uploadLicense(formData,function(response){self.disableUploadBtn=false;var responseData=response.data;if(response.returnCodeDesc=="Success")self.uploadStatus=true;else{self.uploadStatus=false;self.uploadLicenceErrorHandler(responseData)}$("#liceseuploadmodal").modal("hide");
$("#uploadLicenseStatus").modal("show")});return self.message};self.removeFile=function(fileName,$index){self.message="";self.fileList.splice($index,1);self.validatedFiles.splice($index,1);document.getElementById("inputBrowse").value=""};self.uploadLicenceErrorHandler=function(responseData){self.resetLicenseFiles()};self.uploadLicenceSuccesshandler=function(){$("#uploadLicenseStatus").removeClass("fade").modal("hide");$window.location.href="/dashboard"};self.resetLicenseFiles=function(){self.message=
"";self.fileList=[];self.validatedFiles=[]};self.redirectToDashBoard=function(){if(self.uploadStatus)self.uploadLicenceSuccesshandler()}}}}]);
app.directive("carouselControls",["dataServiceG2","localStorageService","copartUser",function(dataServiceG2,localStorageService,copartUser){return{require:"^uibCarousel",link:function(scope,element,attrs,carouselCtrl){var no_photo_url="/images/testImages/lot_NoPhoto.png";scope.goPrevSlide=function(lot_Number){carouselCtrl.prev();getLotImages(lot_Number)};var siteCatalystEvent=attrs.siteCatalystEvent?attrs.siteCatalystEvent:null;scope.goNextSlide=function(lot_Number){carouselCtrl.next();getLotImages(lot_Number)};
scope.viewVehicle=function(recommendedLot,currentPageNumber,clickedLotIndex){localStorageService.set("from-rec-engine",true);var recLotEngine={};var pageNumber=currentPageNumber>4?Math.ceil(currentPageNumber/4):currentPageNumber;recLotEngine.parentLotNumber=recommendedLot.parentLotNumber;recLotEngine.recEngineLotNumber=recommendedLot.lotNumber;recLotEngine.clickedLotIndex=pageNumber>1?currentPageNumber+clickedLotIndex:clickedLotIndex+1;recLotEngine.memNumber=copartUser.getUserConfig().buyerNumber;
if(siteCatalystEvent)copartOmnitureCallOne(siteCatalystEvent,recLotEngine)};var serviceInvoked;var getLotImages=function(lot_Number){if(!serviceInvoked){serviceInvoked=true;dataServiceG2.getLotImages(lot_Number,function(response){if(response&&response.returnCode!=-1){var imagesList=response.data.data.imagesList||{};scope.fullSizeImages=imagesList.FULL_IMAGE;scope.recommendedLot.images=[];_.each(scope.fullSizeImages,function(image,index,list){scope.recommendedLot.images.push(list[index].url)});if(!imagesList.FULL_IMAGE)scope.recommendedLot.images.push(no_photo_url)}})}}}}}]);
app.directive("addressForm",function($timeout,dataServiceG2,copartUser,appConfigService,subscriptionsService,constants){return{restrict:"E",replace:true,require:"^form",scope:{formName:"@",addressVO:"\x3daddress",phoneVO:"\x3dphone",subscriptions:"\x3dsubscriptions",companyFlag:"\x3d?companyFlag",errors:"\x3d",submitted:"\x3d?"},templateUrl:"/public/fetchDirective.html?directive\x3dregistration/addressTemplate\x26agent\x3d007",link:{pre:function(scope,element,attributes,controller,transcludeFn){var self=
scope;self.isGDPRCountry=false;self.locale=dataServiceG2.getLocale();self.countryCodesToShowCookiePolicy=[];self.subscriptions=self.subscriptions||[]},post:function(scope,element,attributes,controller,transcludeFn){var self=scope;self.countryList=appConfigService.appConfig.getCountries();self.statesList=appConfigService.appConfig.getCountryStates();self.phoneVO=self.phoneVO||{};self.addressVO=self.addressVO||new AddressVO;self.companyFlag=Boolean(self.companyFlag);self.siteCode=copartUser.getUserConfig().siteCode.trim();
self.submitted=Boolean(self.submitted);self.culture=null;self.errors=self.errors||{};self.irelandCounties=["Co. Carlow","Co. Cavan","Co. Clare","Co. Cork","Co. Donegal","Co. Dublin","Co. Galway","Co. Kerry","Co. Kildare","Co. Kilkenny","Co. Laois","Co. Leitrim","Co. Limerick","Co. Longford","Co. Louth","Co. Mayo","Co. Meath","Co. Monaghan","Co. Offaly","Co. Roscommon","Co. Sligo","Co. Tipperary","Co. Waterford","Co. Westmeath","Co. Wexford","Co. Wicklow"];if(appConfigService&&appConfigService.envConfigProps&&
appConfigService.envConfigProps.countryCodesToShowCookiePolicy)self.countryCodesToShowCookiePolicy=appConfigService.envConfigProps.countryCodesToShowCookiePolicy;self.checkForSpecialChars1=function(value,fieldName){if(value===""||value===undefined)self.errors[fieldName]=false;else self.errors[fieldName]=!self.addressLinepattern.test(value.toString())};var getCountryObj=function(countryCode){return _.find(self.countryList,{code:countryCode})};var getStateObj=function(countryCode,stateCode){if(!_.isEmpty(countryCode)&&
!_.isEmpty(stateCode)){var stateCodeObj=_.find(self.statesList,{type:countryCode,code:stateCode});return stateCodeObj||{}}return{}};self.setDefaultCountry=function(){var defaultCountryForSite=constants.DEFAULT_COUNTY_FOR_SITE[self.siteCode]||constants.DEFAULT_COUNTY_FOR_SITE["DEFAULT"];var selectedCountryObj=_.find(self.countryList,{code:defaultCountryForSite})||{};self.addressVO.country=selectedCountryObj.code;self.changeCountry()};self.changeCountry=function(){var countryObj=getCountryObj(self.addressVO.country);
var stateObj=getStateObj(self.addressVO.country,self.addressVO.state);var countryCode=countryObj.code;self.culture=countryObj.culture;self.addressVO.state=stateObj.code;self.resetZipOrPostalCode(self.addressVO);self.cityPattern=self.getCityPattern(countryCode);self.addressLinepattern=self.getAddressLinePattern(countryCode);appConfigService.appConfig.getStatesOfCountry(countryCode,function(states){self.statesList=states});$timeout(function(){self.resetPhoneData(self.addressVO,countryObj)})};self.resetZipOrPostalCode=
function(addressVO){addressVO.postCode=""};self.resetPhoneData=function(addressVO,countryObj){var selected=countryObj.description?countryObj.description.toUpperCase():"";var untranslatedCountryDesc=countryObj.descriptionOriginal?countryObj.descriptionOriginal.toUpperCase():"";self.phoneVO.phoneNumber="";var element=$('[name\x3d"phoneNumber"]');var countryArray=element.intlTelInput.getCountryData();for(var i=0;i<countryArray.length;i++){var country=countryArray[i].name;if(country.indexOf("(")>-1)country=
country.substring(0,countryArray[i].name.indexOf("(")).trim();country=country.toUpperCase();if(country===selected||country===untranslatedCountryDesc){element.intlTelInput("setCountry",countryArray[i].iso2);self.phoneVO.intlDialCode=countryArray[i].dialCode;self.phoneVO.isoTwoCharCntryCode=countryArray[i].iso2;break}}};self.getCityPattern=function(countryCode){var cityPattern=constants.CITY_PATTERNS[countryCode]||constants.CITY_PATTERNS["DEFAULT"]||"^[a-zA-Z\\s-]*$";return new RegExp(cityPattern)};
self.getAddressLinePattern=function(countryCode){var addressLinePattern=constants.ADDRESS_LINE_PATTERNS[countryCode]||constants.ADDRESS_LINE_PATTERNS["DEFAULT"]||"^[a-zA-Z0-9- ]*$";return new RegExp(addressLinePattern)};self.clearZipErrors=function(){if(self.errors.zip1)self.errors.zip1=false};self.convertCandaZip=function(candaZipCode){self.clearZipErrors();if(candaZipCode&&candaZipCode.length>=6){candaZipCode=candaZipCode.toUpperCase();var zipCode=angular.copy(candaZipCode);zipCode=zipCode.trim();
if(zipCode.indexOf(" ")==-1){var zip1=zipCode.substring(0,3);var zip2=zipCode.substring(3,zipCode.length);zipCode=zip1+" "+zip2;candaZipCode=zipCode}}};self.checkForSpecialCharsForCanada=function(value,fieldName){if(value===""||value===undefined)self.errors.specialChars[fieldName]=false;else self.errors.specialChars[fieldName]=!/^[a-zA-Z0-9- ]*$/.test(value.toString())};self.init=function(){if(_.isEmpty(self.addressVO)||_.isEmpty(self.addressVO.country))self.setDefaultCountry();else{var countryObj=
getCountryObj(self.addressVO.country);if(countryObj)self.culture=countryObj.culture;self.changeCountry()}};self.init()}}}});
app.directive("membershipPurchase",["copartUser","dataServiceG2","$sce","$templateRequest","$compile","constants","userService","membershipService","errorHandler","$q","copartUtils","$window","appConfigService","scrollToDivService","$location",function(copartUser,dataServiceG2,$sce,$templateRequest,$compile,constants,userService,membershipService,errorHandler,$q,copartUtils,$window,appConfigService,scrollToDivService,$location){return{restrict:"E",replace:true,transclude:true,scope:{selectedProduct:"\x3d",
membershipPurchaseFuncs:"\x3d?membershipPurchaseFuncs",purchaseAction:"\x3d?purchaseAction",autoPaySubscription:"\x3d?autoPaySubscription",membershipPurchaseSuccessHandler:"\x3d?successHandler",membershipPurchaseFailureHandler:"\x3d?failureHandler",referenceId:"\x3d?referenceId",additionalPaymentInfo:"\x3d?additionalPaymentInfo",hideReviewAndPay:"\x3d?",submitted:"\x3d?",reviewPayment:"\x3d?"},controller:function($scope,$element,$attrs){var self=$scope;self.locale=dataServiceG2.getLocale();self.loadingPricingDetails=
true;self.membershipProducts=undefined;self.promoCode={value:"",enablePromo:true,valid:true};self.selectedProduct={index:0,totalPrice:undefined,version:undefined,productCode:undefined,autoPaySubscription:Boolean(self.autoPaySubscription),saveCardOnFile:undefined};self.defaultCurrencyCode=constants.DEFAULT_CURRENCY_CODE;self.currencyCodeForReg=constants.DEFAULT_CURRENCY_CODE;self.showConvenienceFee=false;if(userService.userConfig.defaultDisplayPref){if(userService.userConfig.defaultDisplayPref.currencyCode)self.currencyCodeForReg=
userService.userConfig.defaultDisplayPref.currencyCode;if(userService.userConfig.defaultDisplayPref.membershipPreference)self.showConvenienceFee=Boolean(userService.userConfig.defaultDisplayPref.membershipPreference.showConvenienceFee)}self.membershipProductsRefData=[];self.mbrshpPurchaseErrors=[];self.promoCodeErrors=[];self.paymentFuncs={};self.paymentTypes=[];if(appConfigService.getAppConfig()&&appConfigService.getAppConfig().getPaymentMethods())self.paymentTypes=appConfigService.getAppConfig().getPaymentMethods();
self.isInternationalBuyer=false;self.referenceId=self.referenceId||"";self.instantPaymentSupported=true},link:{pre:function($scope,element,iAttrs,controller){},post:function($scope,element,iAttrs,controller){var self=$scope;self.submitted=Boolean(self.submitted);self.paymentSuccessHandler=self.paymentSuccessHandler||{};self.purchaseAction=self.purchaseAction||{};self.membershipPurchaseFuncs=self.membershipPurchaseFuncs||{};self.additionalPaymentInfo=self.additionalPaymentInfo||{};self.showApplyCouponFlag=
false;var getSelectedPaymentType=function(){return _.isFunction(self.paymentFuncs.getSelectedPaymentType)?self.paymentFuncs.getSelectedPaymentType():""};self.reloadWindow=function(){$compile(element.contents())(self)};$scope.$watch(function(){if(_.isFunction(self.paymentFuncs.getSelectedPaymentType))return self.paymentFuncs.getSelectedPaymentType()},function(newPaymentType,oldPaymentType){self.showApplyCouponFlag=Boolean(self.showApplyCouponFlag)&&Boolean(newPaymentType!=="WIRE");self.instantPaymentSupported=
newPaymentType!=="WIRE";self.mbrshpPurchaseErrors=[]});self.validateIfInternationalBuyer=function(){if(userService.isAnonymous()){if(self.referenceId)dataServiceG2.getRegistrationStatus(self.referenceId,function(response){if(response.returnCode!==-1&&response.data){self.registrationStatus=response.data;if(response.data.physicalAddress&&response.data.physicalAddress.country){self.additionalPaymentInfo.buyerPhysicalCountry=response.data.physicalAddress.country;self.additionalPaymentInfo.physicalAddress=
response.data.physicalAddress}}})}else if(userService.userConfig&&userService.userConfig.memberContactInfo&&userService.userConfig.memberContactInfo.country)self.additionalPaymentInfo.buyerPhysicalCountry=userService.userConfig.memberContactInfo.country};var computeApplyPromoSecVisibility=function(){var promoCode=$location.search().prmCd;if(promoCode){self.showApplyCouponFlag=true;self.promoCode=self.promoCode||{};self.promoCode.value=promoCode.replace(/\"/g,"");self.promoCode.valid=true;self.applyPromoCode()}};
self.init=function(){self.submitted=false;self.reviewPayment=false;self.selectedProduct=self.selectedProduct||{};self.reviewProduct=self.reviewProduct||{};var userConfig=userService.userConfig;self.currencyCode=userConfig.defaultDisplayPref.currencyCode;self.showReviewAndPayButtonFlag=!Boolean(self.hideReviewAndPay);$window.scrollTo(0,0);membershipService.getMembershipProductsWithPricing().then(function(response){if(response){self.membershipProductsRefData=response;self.membershipProducts=angular.copy(self.membershipProductsRefData);
self.initProduct()}else self.membershipProducts=[];self.loadingPricingDetails=false});self.validateIfInternationalBuyer()};self.promoChange=function(value){self.promoCode.valid=true;self.promoCodeErrors=[]};self.reloadAccountSettings=function(){$window.location.href="/dashboard"};self.applyPromoCode=function(){if(self.promoCode&&self.promoCode.value===""){self.promoCodeErrors=[];self.promoCodeErrors.push(self.locale.messages["app.label.promo.invalid"]);self.promoCode.valid=false}if(self.promoCode&&
self.promoCode.value)dataServiceG2.addCoupon(self.generatePromoData(self.selectedProduct),function(response){if(response&&response.data&&response.data.returnCode!==-1&&response.data.data){var res=response.data.data;self.referenceId=res.referenceId;var product=res.productSite;self.membershipProducts.forEach(function(membershipProduct,index){if(membershipProduct.term===product.term){self.membershipProducts[index]=product;self.additionalPaymentInfo.product=product}});self.promoCode.enablePromo=false;
self.promoCode.valid=true}else{self.promoCode.enablePromo=true;self.promoCode.valid=false;var errorObjs=response.data.data.errorObjects||response.data.data.errorObjects||[];self.promoCodeErrors=self.handleErrorMessages(errorObjs,"app.label.promo.error.");console.log("Promo application failed: ",response)}},function(error){self.promoCodeErrors=self.handleErrorMessages(error,"app.label.promo.error.");console.log("Promo application failed error: ",error)})};self.removePromoCode=function(){if(self.promoCode&&
self.promoCode.value){self.promoCode.value="";self.promoCode.enablePromo=true;self.promoCode.valid=true;self.promoCodeErrors=[];self.membershipProducts=angular.copy(self.membershipProductsRefData)}};self.generatePromoData=function(selectedProduct){var promoCode=[];if(self.promoCode&&self.promoCode.value){var promoVal=self.promoCode.value;promoCode.push({"promoCode":promoVal.toUpperCase()})}return{"productCode":selectedProduct.productCode,"referenceId":self.referenceId,"promos":promoCode}};self.changeProduct=
function(product){if(product){self.selectedProduct.version=product.versionId;self.selectedProduct.productCode=product.term;if(angular.isDefined(product.autoPaySubscription)&&product.autoPaySubscription!==null)self.selectedProduct.autoPaySubscription=product.autoPaySubscription;self.selectedProduct.totalPrice=product.total;self.additionalPaymentInfo.product=product;self.validateAndApplyPromo(product)}};self.validateAndApplyPromo=function(product){self.promoCodeErrors=[];if($location.search().prmCd){var membershipCharge=
_.find(product.charges,{chargeDesc:"MEMBERSHIP"});if(membershipCharge.promos&&membershipCharge.promos.length>0){var promoCodeApplied=membershipCharge.promos[0].promoCode;if(promoCodeApplied!==$location.search().prmCd)computeApplyPromoSecVisibility();else enableAppliedPromoForView(promoCodeApplied)}else if($location.search().prmCd)computeApplyPromoSecVisibility();else self.removePromoCode()}};var enableAppliedPromoForView=function(promoCode){self.promoCode=self.promoCode||{};self.promoCode.value=promoCode.replace(/\"/g,
"");self.promoCode.valid=true;self.promoCode.enablePromo=false};self.initProduct=function(){self.selectedProduct={index:self.selectedProduct?self.selectedProduct.index?self.selectedProduct.index:0:0,totalPrice:undefined,version:undefined,productCode:undefined,autoPaySubscription:Boolean(self.selectedProduct.autoPaySubscription),saveCardOnFile:undefined};var product=getCurrentSelectedProduct();if(product){self.selectedProduct.version=product.versionId;self.selectedProduct.productCode=product.term;
if(angular.isDefined(product.autoPaySubscription)&&product.autoPaySubscription!==null)self.selectedProduct.autoPaySubscription=product.autoPaySubscription;self.selectedProduct.totalPrice=product.total;self.additionalPaymentInfo.product=product}computeApplyPromoSecVisibility()};var getCurrentSelectedProduct=function(){var productCode=$location.search().prdCd;var membershipProduct=self.membershipProductsRefData&&self.membershipProductsRefData[0];if(productCode){productCode=productCode.replace(/\"/g,
"");productCode=productCode.toUpperCase();self.membershipProducts.forEach(function(product,index){if(product.term===productCode){self.selectedProduct.index=index;membershipProduct=product}})}return membershipProduct};self.generateInitPaymentData=function(selectedProduct){var promoCode=[];if(self.promoCode&&self.promoCode.valid&&self.promoCode.value)promoCode.push({"promoCode":self.promoCode.value});return{"productCode":selectedProduct.productCode,"paymentDetails":{"paymentMethod":getSelectedPaymentType()},
"referenceId":self.referenceId,"autoPaySubscription":selectedProduct.autoPaySubscription,"saveCardOnFile":selectedProduct.saveCard,"promos":promoCode}};self.initiatePayment=function(){var deferred=$q.defer();self.paymentFuncs.validatePaymentPayload().then(function(response){if(Boolean(response))dataServiceG2.initiatePayment(self.generateInitPaymentData(self.selectedProduct),function(response){if(response&&response.data&&response.data.returnCode!==-1){var initPayResponse=response.data.data||{};if(!_.isEmpty(initPayResponse)){self.reviewProduct=
initPayResponse||{};self.referenceId=self.reviewProduct.referenceId;self.reviewProductSite=self.reviewProduct.productSite||{};self.additionalPaymentInfo.product=self.reviewProductSite}deferred.resolve(initPayResponse)}else if(response&&response.data&&response.data.data&&response.data.data.errorObjects)deferred.reject(response.data.data.errorObjects);else{deferred.reject({});self.mbrshpPurchaseErrors.push(self.locale.messages["app.error.global.text"])}});else{self.mbrshpPurchaseErrors.push(self.locale.messages["app.label.submission.error"]);
deferred.reject({});scrollToDivService.scrollToDiv("membershipPurchaseForm")}},function(errors){self.mbrshpPurchaseErrors.push(self.locale.messages["app.label.submission.error"]);deferred.reject({});scrollToDivService.scrollToDiv("membershipPurchaseForm")});return deferred.promise};self.membershipPurchaseFuncs.submitWithOutReview=function(){var deferred=$q.defer();self.mbrshpPurchaseErrors=[];self.paymentFuncs.clearErrors();self.paymentDetailsForReview={};self.submitted=true;self.initiatePayment().then(function(response){self.membershipPurchaseFuncs.submitPayment().then(function(response){deferred.resolve(response)},
function(error){deferred.reject(error)})},function(errorObjs){var localeErrors=errorHandler.handleErrors(errorObjs,"app.error.paymentgateway.");if(!_.isEmpty(localeErrors))self.mbrshpPurchaseErrors.push(localeErrors);deferred.reject(errorObjs);console.log("Payment Initiation failed: ",errorObjs)});return deferred.promise};self.reviewAndPay=function(){self.mbrshpPurchaseErrors=[];self.paymentFuncs.clearErrors();self.paymentDetailsForReview={};self.submitted=true;self.initiatePayment().then(function(response){self.generatePaymentSectionForReview().then(function(data){self.reviewPayment=
true;scrollToDivService.scrollToDiv("review-section")},function(error){console.log("initiatePayment#generateInitPaymentData failed")})},function(errorObjs){self.reviewPayment=false;var localeErrors=errorHandler.handleErrors(errorObjs,"app.error.paymentgateway.");if(!_.isEmpty(localeErrors))self.mbrshpPurchaseErrors.push(localeErrors);console.log("Payment Initiation failed: ",errorObjs)})};self.membershipPurchaseFuncs.reviewAndPay=self.reviewAndPay;self.editMembershipType=function(){self.reviewPayment=
false;setTimeout(function(){jQuery("html, body").animate({scrollTop:jQuery(".select-membership")&&jQuery(".select-membership").offset()?jQuery(".select-membership").offset().top-50:0},700)},1)};self.editPaymentDetails=function(){self.reviewPayment=false;setTimeout(function(){jQuery("html, body").animate({scrollTop:jQuery(".payment-details")&&jQuery(".payment-details").offset()?jQuery(".payment-details").offset().top-50:0},700)},1)};self.submitMembershipPayment=function(){if(_.isFunction(self.purchaseAction))self.purchaseAction();
else console.log("Submit payment from review failed")};self.membershipPurchaseFuncs.submitPayment=function(){var deferred=$q.defer();self.mbrshpPurchaseErrors=[];self.paymentProcessing=true;if(_.isFunction(self.paymentFuncs.submitPayment))self.paymentFuncs.submitPayment().then(function(response){if(_.isFunction(self.membershipPurchaseSuccessHandler))self.membershipPurchaseSuccessHandler(response);deferred.resolve(response)},function(error){self.paymentProcessing=false;self.reviewPayment=false;self.mbrshpPurchaseErrors=
self.handleErrorMessages(error,"app.error.paymentgateway.");if(_.isFunction(self.membershipPurchaseFailureHandler))self.membershipPurchaseFailureHandler(error);scrollToDivService.scrollToDiv("membershipPurchaseForm");deferred.reject(error)});else{self.paymentProcessing=false;deferred.reject({})}return deferred.promise};self.handleErrorMessages=function(error,label){var errorObjs=[];var errorMsgs=[];if(error)errorObjs=error;if(label)errorMsgs=errorHandler.handleErrors(errorObjs,label);else errorMsgs=
errorHandler.handleErrors(errorObjs,"app.error.paymentgateway.");return errorMsgs};self.generatePaymentSectionForReview=function(){var deferred=$q.defer();if(_.isFunction(self.paymentFuncs.generateCustomerPaymentToken)&&getSelectedPaymentType()===constants.CARD_PAYMENT_METHOD_CODE)self.paymentFuncs.generateCustomerPaymentToken().then(function(data){if(data&&data.token){var parsedData=copartUtils.parseJwt(data.token);if(parsedData&&parsedData.data)self.getPaymentDetailsForReview(parsedData.data);else;
deferred.resolve(data)}else deferred.reject(data)},function(error){console.log("Purchasedirective#generatePaymentSection: ",error);deferred.reject(error)});else{self.getPaymentDetailsForReview(null);deferred.resolve({})}return deferred.promise};self.getPaymentDetailsForReview=function(parsedData){var selectedPaymentType=undefined;var selectedCard=undefined;var cardNumber=undefined;var cardCVV=undefined;var cardExpiryDate=undefined;if(getSelectedPaymentType())self.paymentTypes.forEach(function(paymentType){if(paymentType.paymentMethod===
getSelectedPaymentType())selectedPaymentType=paymentType.paymentMethodName});if(parsedData){var cardData=parsedData;if(cardData.expirationMonth&&cardData.expirationYear)cardExpiryDate=cardData.expirationMonth+"/"+cardData.expirationYear;if(cardData.number)selectedCard=cardData.number;if(cardData.type)constants.CARD_TYPES.forEach(function(cardType){if(cardType.code===cardData.type)selectedCard=cardType.displayName})}self.paymentDetailsForReview={selectedPaymentType:selectedPaymentType,selectedCard:selectedCard,
cardNumber:cardNumber,cardCVV:cardCVV,cardExpiryDate:cardExpiryDate}};self.getPriceForCurrency=function(convertedCurrencyBreakdownList,currency){if(convertedCurrencyBreakdownList&&currency)for(var i=0;i<convertedCurrencyBreakdownList.length;++i)if(currency===convertedCurrencyBreakdownList[i].currency)return convertedCurrencyBreakdownList[i].price};self.filterChargesByChargeType=function(charges){var filteredCharges=[];if(!self.showConvenienceFee){for(var i=0;i<charges.length;++i)if(charges[i].chargeDesc!==
"CONVENIENCE FEE")filteredCharges.push(charges[i]);return filteredCharges}return charges};self.paymentSuccessHandler=function(){console.log("Payment success::paymentSuccessHandler")};self.paymentFailureHandler=function(){console.log("Payment failure::paymentFailureHandler")};self.submit=function(){self.membershipPurchaseSuccessHandler()};self.init()}},templateUrl:"/public/fetchDirective.html?directive\x3dmembership/membershipPurchase"}}]);
app.directive("paymentReview",["copartUser","dataServiceG2","$sce","$templateRequest","$compile","constants","copartUtils",function(copartUser,dataServiceG2,$sce,$templateRequest,$compile,constants,copartUtils){return{restrict:"E",replace:true,transclude:true,scope:{selectedProduct:"\x3c",selectedPaymentType:"\x3d",paymentFuncs:"\x3d?paymentFuncs",reviewPayment:"\x3d"},controller:function($scope,$element,$attrs){var self=$scope;self.locale=dataServiceG2.getLocale()},link:{pre:function($scope,element,
iAttrs,controller){},post:function($scope,element,iAttrs,controller){var self=$scope;self.paymentFuncs=self.paymentFuncs||{};self.generateInitPaymentData=function(selectedProduct){return{"productCode":selectedProduct.productCode,"paymentDetails":{"paymentMethod":self.selectedPaymentType},"clientRefId":self.clientRefId,"autoPaySubscription":selectedProduct.autoPaySubscription,"saveCardOnFile":selectedProduct.saveCard}};self.initiatePayment=function(){dataServiceG2.initiatePayment(self.generateInitPaymentData(self.selectedProduct),
function(response){console.log("Response: ",response);if(response&&response.data&&response.data.returnCode!==-1){console.log("Payment Initiation successful: ",response);self.generatePaymentSection();var reviewPayment=angular.element(document.querySelector("#reviewPayment"));var reviewPaymentTemplate=angular.element(response.data);reviewPayment.append(reviewPaymentTemplate);$compile(reviewPayment)(self)}else{self.reviewPayment=false;console.log("Payment Initiation failed: ",response)}})};self.generatePaymentSection=
function(){if(_.isFunction(self.paymentFuncs.generateCustomerPaymentToken)&&self.selectedPaymentType==="CRDCARD"){console.log("generateCustomerPaymentToken available");self.paymentFuncs.generateCustomerPaymentToken().then(function(data){console.log("generateCustomerPaymentToken available data: ",data);if(data&&data.token){var parsedData=copartUtils.parseJwt(data.token);console.log("parsedData: ",parsedData.data);self.getPaymentDetailsForReview(parsedData.data)}})}else;};self.initiatePayment()}},templateUrl:"/public/fetchDirective.html?directive\x3dregistration/reviewPayment"}}]);
app.directive("accountAlerts",["copartUser","dataServiceG2","$sce","$templateRequest","$compile","constants","accountAlertsService","$timeout","$window","$location","cmsContentService",function(copartUser,dataServiceG2,$sce,$templateRequest,$compile,constants,accountAlertsService,$timeout,$window,$location,cmsContentService){return{restrict:"E",replace:true,transclude:true,scope:{},controller:function($scope){var self=$scope;self.locale=dataServiceG2.getLocale();self.alertsData="";self.alertsContent=
"";self.banners=[];self.pendingUserActions=[];self.currentAlertsCount=0;self.enableAlerts=false;$scope.$watch(function(){return accountAlertsService.getAlerts()},function(newAlerts){if(newAlerts&&newAlerts.length>0){self.enableAlerts=true;self.pendingUserActions=accountAlertsService.filterAlertsForUserViewFromUserActivities(newAlerts);self.pendingUserActions=self.pendingUserActions.filter(function(value){if(value.actionStatus===constants.ALERT_FILTER_ACTION_STATUS){var actionActivationDate=new Date(value.actionActivationDate.date);
var today=new Date;today.setHours(0,0,0,0);return actionActivationDate<=today}return true});if(self.pendingUserActions&&self.pendingUserActions.length===0)self.removeAlertsFromView();else self.showAlerts()}})},link:{pre:function(){},post:function($scope){var self=$scope;self.remindLater=function(userActionCode){if(userActionCode)accountAlertsService.removeAlert(userActionCode).then(function(){self.updateAlertCount()},function(error){console.log("Remind later failed for",userActionCode)})};self.updateAlertCount=
function(){self.currentAlertsCount-=1;if(self.currentAlertsCount===0)self.removeAlertsFromView()};self.removeAlertsFromView=function(){$("body").removeClass("modal-open");$(".modal-backdrop").remove();self.enableAlerts=false};self.removeBannerAndModal=function(userActionCode){accountAlertsService.removeAlertBannerAndModalFromView(userActionCode);self.updateAlertCount()};self.gotoAction=function($event,userActionCode,href){$("#actionItemModal").modal("hide");$location.url(href)};self.renderAccountAlerts=
function(){self.banners=[];if(self.pendingUserActions&&self.pendingUserActions.length>0){self.pendingUserActions.forEach(function(alert,index){self.banners[alert.customUserActionCode]={};self.banners[alert.customUserActionCode].value=true;self.banners[alert.customUserActionCode].index=index});$timeout(function(){jQuery("#notification-carousel").carousel({interval:15E3,pause:"hover"});jQuery("#carousel-banner").children().removeClass("active");jQuery("#carousel-banner .item").first().addClass("active");
jQuery("#alertsContent .item").first().addClass("active");self.pendingUserActions.forEach(function(alert,index){jQuery("#banner-"+alert.customUserActionCode).click(function(e){jQuery("#alertsContent").children().removeClass("active");jQuery("#alertsContent #modal-"+alert.customUserActionCode).addClass("active")});jQuery("#modal-"+alert.customUserActionCode).click(function(e){jQuery("#carousel-banner").children().removeClass("active");jQuery("#carousel-banner #banner-"+alert.customUserActionCode).addClass("active")})});
self.openAlertModalOnConfigReload();jQuery("#actionItemModal").on("show.bs.modal",function(e){jQuery("#notification-carousel").carousel("pause")});jQuery("#actionItemModal").on("hide.bs.modal",function(e){jQuery("#notification-carousel").carousel({interval:3E3,pause:"hover"})});$("#notification-modal-carousel").bind("slid.bs.carousel",function(e){var currentActiveModal=jQuery("#alertsContent .active");if(currentActiveModal&&currentActiveModal.length>0&&currentActiveModal.attr("id").replace("modal-",
"")){var userActionCode=currentActiveModal.attr("id").replace("modal-","");var banner=jQuery("#carousel-banner #banner-"+userActionCode);if(banner&&banner.length>0){jQuery("#carousel-banner").children().removeClass("active");banner.addClass("active")}}})})}};self.showAlerts=function(){self.compileCmsContent()};self.compileCmsContent=function(){self.currentAlertsCount=0;self.contentUrl=cmsContentService.getCmsContentUrl("content/us/en/account-alerts.html");$templateRequest(self.contentUrl).then(function(html){var alertsModalHolder=
angular.element(document.querySelector("#alertsContent"));var alertsBannerHolder=angular.element(document.querySelector("#carousel-banner"));if(alertsModalHolder&&alertsModalHolder.length>0){alertsModalHolder.empty();alertsBannerHolder.empty();self.pendingUserActions.forEach(function(alert,index){var alertModalForUserActionCode=angular.element(html).filter("#modal-"+alert.customUserActionCode).html();var alertBannerForUserActionCode=angular.element(html).filter("#banner-"+alert.customUserActionCode).html();
if(alertModalForUserActionCode&&alertModalForUserActionCode.length>0){self.currentAlertsCount+=1;alertsBannerHolder.append(alertBannerForUserActionCode);alertsModalHolder.append(alertModalForUserActionCode)}});if(self.currentAlertsCount===0)self.enableAlerts=false;else{$compile(alertsBannerHolder)(self);$compile(alertsModalHolder)(self);self.renderAccountAlerts()}}},function(error){})};self.openAlertModalOnConfigReload=function(){if(copartUser.getUserConfig()&&copartUser.getUserConfig().displayAlertsModal){if(self.pendingUserActions&&
self.pendingUserActions[0]&&self.pendingUserActions[0].customUserActionCode){jQuery("#banner-"+self.pendingUserActions[0].customUserActionCode).click();$("#actionItemModal").modal("show")}accountAlertsService.updateDisplayAlertsModal(!copartUser.getUserConfig().displayAlertsModal)}};self.closeModal=function(){$("#actionItemModal").modal("hide");jQuery("#notification-carousel").carousel("cycle");$("body").removeClass("modal-open");$(".modal-backdrop").remove()}}},templateUrl:"/fetchDirective.html?directive\x3daccountAlerts/accountAlerts"}}]);
app.directive("memberAccountInfo",["$q","$location","copartUser","appConfigService","dataServiceG2","copartUtils","memberChoicesService","memberChoicesConstants","errorHandler","scrollToDivService","constants","accountInfoService",function($q,$location,copartUser,appConfigService,dataServiceG2,copartUtils,memberChoicesService,memberChoicesConstants,errorHandler,scrollToDivService,constants,accountInfoService){return{restrict:"E",replace:true,transclude:true,templateUrl:"/public/fetchDirective.html?directive\x3dregistration/memberAccountInfo",
scope:{updateAccountInfoFuncs:"\x3dupdateAccountInfoFuncs",additionalInfo:"\x3d",physicalAddress:"\x3d?",accountInfoSuccessHandler:"\x3dsuccessHandler",accountInfoFailureHandler:"\x3dfailureHandler",docUploadSuccessHandler:"\x3d?docUploadSuccessHandler",docUploadFailureHandler:"\x3d?docUploadFailureHandler",hideSubmit:"\x3d?hideSubmit"},controller:function($scope,$element,$attrs){},link:{pre:function($scope,element,$attrs,controller){},post:function($scope,element,$attrs,controller){var self=$scope;
self.locale=dataServiceG2.getLocale();self.accountInfoForm=self.accountInfoForm||{};self.membershipPurchaseFuncs={};self.additionalInfo=self.additionalInfo||{};self.updateAccountInfoFuncs=self.updateAccountInfoFuncs||{};self.primaryPhoneVO=new PhoneVO;self.physicalAddress=self.physicalAddress||{};self.errors={phoneNumber:false,addressLine1:false,addressLine2:false,zipCode:false};self.validatedFiles=[];self.companyFlag=false;self.photoIDWarningFlag=true;self.bussinessIDWarningFlag=true;self.documentSubmitFailure=
false;self.skipDocumentUpload=false;self.selectedMemberChoices="";self.subscriptions=[];self.showMemberChoices=copartUser.getUserConfig().supportedMemberChoices||false;self.showSubscriptions=copartUser.hasAccessSitePref(constants.REGISTRATION_PREF_COL_STR,constants.SUBSCRIPTIONS);self.hideSubmit=Boolean(self.hideSubmit);self.populateAddress=function(registrationStatus){if(registrationStatus){self.physicalAddress=registrationStatus.physicalAddress||self.physicalAddress;self.primaryPhoneVO=registrationStatus.phone||
self.primaryPhoneVO}};self.errorResponseHandler=function(response){};$scope.$watch($attrs.additionalInfo,function(newVal,oldVal){self.setAdditionalInfo()},true);self.setAdditionalInfo=function(){self.additionalPaymentInfo=angular.extend({},self.additionalInfo);self.additionalPaymentInfo.physicalAddress=self.physicalAddress;self.companyFlag=false;if(self.additionalInfo.registrationStatus){self.populateAddress(self.additionalInfo.registrationStatus);self.companyFlag=self.additionalInfo.registrationStatus.basicInfo?
self.additionalInfo.registrationStatus.basicInfo.companyFlag:copartUser.getUserConfig().companyFlag}};self.buildAddressVO=function(addressVO){if(addressVO){if(addressVO.state===""||addressVO.state===undefined)appConfigService.appConfig.getCountryStates().forEach(function(item){if(item.type===addressVO.country){addressVO.state=item.code;return}});addressVO.postCode=addressVO.postCode?addressVO.postCode.toUpperCase():"";return addressVO}return null};self.buildPhoneVO=function(phoneVO){phoneVO.phoneNumber=
copartUtils.sanitizePhoneNumber(phoneVO);return phoneVO};self.getMemberChoices=function(){return memberChoicesService.getSelectedChoices()};self.buildAccountInfoPayload=function(){var requestPayLoad={};requestPayLoad.physicalAddress=self.buildAddressVO(self.physicalAddress);requestPayLoad.mailingAddress=self.buildAddressVO(self.mailingAddress);if(self.primaryPhoneVO&&self.primaryPhoneVO.phoneNumber)requestPayLoad.phone=self.buildPhoneVO(self.primaryPhoneVO);if(self.mobilePhone)requestPayLoad.mobilePhone=
self.mobilePhone;requestPayLoad.selectedChoices=self.getMemberChoices();requestPayLoad.memberSubscriptions=self.subscriptions;return requestPayLoad};self.updateAccountInfoFuncs.getAccountInfoRequestData=function(){var requestPayLoad=self.buildAccountInfoPayload();return requestPayLoad};self.submitPayment=function(){if(_.isFunction(self.membershipPurchaseFuncs.submitPayment))self.membershipPurchaseFuncs.submitPayment()};var navigateToAddressForm=function(){scrollToDivService.scrollToDiv("memberAccountInfoSection")};
var accountInfoSuccessHandler=function(response){if(response.physicalAddress)self.physicalAddress.communicationId=response.physicalAddress.communicationId;if(response.mailingAddress)self.mailingAddress.communicationId=response.mailingAddress.communicationId;if(response.phone)self.primaryPhoneVO.communicationId=response.phone.communicationId};var saveAccountInfoFailureHandler=function(response){self.isError=true;if(response&&response.data){var errorObjs=response.data||[];self.saveAddressErrors=errorHandler.handleErrors(errorObjs,
"app.error.address.")}else self.saveAddressErrors=errorHandler.handleErrors(null,"");navigateToAddressForm()};self.updateAccountInfoFuncs.updateAccountInfo=function(){var deferred=$q.defer();self.updateAccountInfo().then(function(response){deferred.resolve(response)},function(error){deferred.reject(error)});return deferred.promise};self.updateAccountInfo=function(){var deferred=$q.defer();self.submitted=true;self.isError=false;self.saveAddressErrors=[];if(self.isFormValid())dataServiceG2.updateAccountInfoInRegistration(self.buildAccountInfoPayload(),
function(response){if(response&&response.data&&response.data.returnCode!==-1){accountInfoSuccessHandler(response.data.data);self.performNextAction().then(function(response){deferred.resolve(response)},function(error){deferred.reject(error)})}else{self.skipDocumentUpload=false;saveAccountInfoFailureHandler(response.data);self.accountInfoFailureHandler(response);deferred.reject(response)}},function(error){self.accountInfoFailureHandler(error);deferred.reject(error)});else deferred.reject({});return deferred.promise};
self.uploadDocuments=function(){var deferred=$q.defer();if(_.isFunction(self.uploadDocumentFuncs.validateDocumentPayload)&&!self.uploadDocumentFuncs.validateDocumentPayload(self.validatedFiles)){self.documentSubmitFailure=true;return deferred.reject({})}else{self.documentSubmitFailure=false;self.uploadDocumentFuncs.uploadDocuments().then(function(response){if(response&&response.returnCode!==-1){self.validatedFiles=[];self.accountInfoSuccessHandler(response);return deferred.resolve(response)}else{self.accountInfoFailureHandler(response);
self.showNotificationModal(constants.DOCUMENT_UPLOAD_FAILED_MODAL,true);return deferred.reject({})}},function(error){self.accountInfoFailureHandler(error);self.showNotificationModal(constants.DOCUMENT_UPLOAD_FAILED_MODAL,true);return deferred.reject({});console.log("error while uploading the document :",error)})}return deferred.promise};var fieldErrors=["pattern","required","maxlength"];self.isFormValid=function(){if(self.accountInfoForm.addressForm&&!self.accountInfoForm.addressForm.$valid){self.isError=
true;self.saveAddressErrors.push(self.locale.messages["app.error.address.invalid"]);if(self.accountInfoForm.addressForm.$error)angular.forEach(fieldErrors,function(fieldError){if(self.accountInfoForm.addressForm.$error[fieldError])angular.forEach(self.accountInfoForm.addressForm.$error[fieldError],function(errorField){self.errors[errorField.$name]=true})});navigateToAddressForm();return false}else if(!self.skipDocumentUpload&&!self.areDocumentsValid())return false;return true};self.areDocumentsValid=
function(){if(_.isFunction(self.uploadDocumentFuncs.validateDocumentPayload)&&!self.uploadDocumentFuncs.validateDocumentPayload(self.validatedFiles))self.documentSubmitFailure=true;else{self.documentSubmitFailure=false;self.checkForDocumentWarningMessage(self.validatedFiles);if(!self.photoIDWarningFlag){if(self.companyFlag){self.showNotificationModal(constants.DOCUMENT_UPLOAD_WARNING_MODAL,true);return!self.bussinessIDWarningFlag}}else self.showNotificationModal(constants.DOCUMENT_UPLOAD_WARNING_MODAL,
true);return!self.photoIDWarningFlag}return false};self.checkForDocumentWarningMessage=function(validFiles){var photoIdIndex=self.checkForRequiredDocCategory(validFiles,"ID");self.photoIDWarningFlag=photoIdIndex===-1;if(self.companyFlag&&!self.photoIDWarningFlag){var businessIdIndex=self.checkForRequiredDocCategory(validFiles,"LIC");self.bussinessIDWarningFlag=businessIdIndex===-1}};self.checkForRequiredDocCategory=function(validFiles,category){return _.findIndex(validFiles,function(file){return file.documentCategory===
category})};self.toggleDocumentUploadFlag=function(){self.skipDocumentUpload=true;self.showNotificationModal(constants.DOCUMENT_UPLOAD_WARNING_MODAL,false);if(_.isFunction(self.updateAccountInfoFuncs.updateAccountInfoSubmit))self.updateAccountInfoFuncs.updateAccountInfoSubmit();else self.updateAccountInfo()};self.performNextAction=function(){var deferred=$q.defer();if(self.validatedFiles&&self.validatedFiles.length==0){self.regStep3Tracking("");self.proceedToNextStep();return deferred.resolve({})}else self.uploadDocuments().then(function(response){if(response&&
response==="Upload Successful!")self.regStep3Tracking("success");return deferred.resolve(response)},function(error){return deferred.reject(error)});return deferred.promise};self.proceedToNextStep=function(){self.accountInfoSuccessHandler()};self.showNotificationModal=function(modalId,flag){if(flag)jQuery("#"+modalId).modal("show");else{jQuery("#"+modalId).modal("hide");jQuery(".modal-backdrop").remove();jQuery("body").removeClass("modal-open")}};var getAccountInformation=function(){accountInfoService.getAccountInformation(true).then(function(response){self.accountInfo=
response;self.physicalAddress=response.physicalAddress;self.mailingAddress=response.mailingAddress;if(response.primaryPhone){self.primaryPhoneVO=response.primaryPhone;if(_.isNumber(self.primaryPhoneVO.phoneNumber))self.primaryPhoneVO.phoneNumber=self.primaryPhoneVO.phoneNumber.toString()}if(response.mobilePhone)self.mobilePhone=response.mobilePhone},function(error){})};self.regStep3Tracking=function(fileUpload){try{var crmIdTracking="";var regType="";if(self.companyFlag===false)regType="indv";else regType=
"busi";if(copartUser.getUserConfig().crmId)crmIdTracking=copartUser.getUserConfig().crmId;copartOmnitureCallMulti("doTagRegistrationStep3Complete",[fileUpload,crmIdTracking,regType])}catch(e){log.error("Registration Step3 sitecatalyst error:",e)}};self.init=function(){self.submitted=false;self.saveAddressErrors=[];getAccountInformation()};self.init()}}}}]);
app.directive("documentsUpload",["$q","dataServiceG2","appConfigService","copartUser","constants",function($q,dataServiceG2,appConfigService,copartUser,constants){return{restrict:"AE",replace:true,templateUrl:"/public/fetchDirective.html?directive\x3dregistration/documentsUpload\x26agent\x3d007",scope:{uploadFuncs:"\x3duploadFuncs",docUploadSuccessHandler:"\x3d?docUploadSuccessHandler",docUploadFailureHandler:"\x3d?docUploadFailureHandler",userSubmitted:"\x3d?",validatedFiles:"\x3d",companyFlag:"\x3d?",
documentAdditionalInfo:"\x3d?",documentSubmitFailure:"\x3d?",physicalAddress:"\x3d?"},link:{pre:function($scope,iElement,$attrs,controller){},post:function($scope,iElement,$attrs,controller){var self=$scope;self.locale=self.$parent.locale;var userConfig=copartUser.getUserConfig();var physicalAddress=_.clone(self.physicalAddress)||userConfig.physicalAddress||{};var defaultCountries=["USA","CAN","GBR"];self.documentAdditionalInfo=self.documentAdditionalInfo||{};self.getCountries=function(countryListForDocuments){if(countryListForDocuments){var popularCountries=
[];var remainingCountries=[];countryListForDocuments.forEach(function(country){if(_.contains(defaultCountries,country.code))popularCountries.push(country);else remainingCountries.push(country)});var countriesList=[];defaultCountries.forEach(function(country){var countryObj=_.find(popularCountries,{code:country});if(!_.isEmpty(countryObj))countriesList.push(countryObj)});remainingCountries=_.sortBy(remainingCountries,"description");return countriesList.concat(remainingCountries)}return[]};self.getDocumentCategories=
function(documentCategories){if(documentCategories){var defaultDocumentCategories=["ID","LIC","POA","TAX","ADBIDR","MISC"];var documentCategoriesList=[];defaultDocumentCategories.forEach(function(code){var documentObject=_.find(documentCategories,{documentCategoryCode:code});if(!_.isEmpty(documentObject))documentCategoriesList.push(documentObject)});return documentCategoriesList}return[]};self.documentMetaData=self.documentMetaData||{};self.previousDocMetaData={};self.uploadFuncs=self.uploadFuncs||
{};self.companyFlag=self.companyFlag||copartUser.getUserConfig().companyFlag;self.showDocUpForm=true;self.showDocUpLink=false;self.siteCode=copartUser.getUserConfig().siteCode.trim();self.countryListForDocuments=appConfigService.appConfig.getCountries();self.statesListForDocuments=appConfigService.appConfig.getCountryStates();self.documentCategories=self.getDocumentCategories(appConfigService.distinctDocCategories())||{};self.uploadObjs=[];self.removeFile=function(fileName,$index){self.uploadObjs.splice($index,
1);self.validatedFiles.splice($index,1);if(!(self.validatedFiles.length>0)){self.showDocUpForm=true;self.showDocUpLink=false}document.getElementById("inputBrowse").value=""};self.documentSelected=function(){self.documentTypeSelected=false;if(self.inputDocumentType==null)self.inputDocumentType={}};self.getFormData=function(){var formData=new FormData;_.each(self.validatedFiles,function(file,index){formData.append("documentServiceInquiryVOS["+index+"].file",file.file);formData.append("documentServiceInquiryVOS["+
index+"].documentCategory",file.documentCategory);if(file.documentMetaData.documentNumber)formData.append("documentServiceInquiryVOS["+index+"].documentNumber",file.documentMetaData.documentNumber);if(file.documentMetaData.country)formData.append("documentServiceInquiryVOS["+index+"].documentCountry",file.documentMetaData.country);if(file.documentMetaData.state)formData.append("documentServiceInquiryVOS["+index+"].documentState",file.documentMetaData.state);if(file.documentMetaData.expDate)formData.append("documentServiceInquiryVOS["+
index+"].expiryDate",moment(file.documentMetaData.expDate).set({hour:23,minute:59,second:59,millisecond:0}).format("YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"))});formData.append("applicationName","G2MBR");formData.append("destination","CAS");formData.append("fileType","DOCUMENT");formData.append("documentType","BUYER_LICENSE");formData.append("objectType","MEMBER");formData.append("country","US");return formData};self.uploadFuncs.clearForm=function(){self.uploadObjs=[];self.validatedFiles=[];self.showDocUpForm=
true;self.showDocUpLink=false;initializeDocumentMetaData()};self.uploadFuncs.validateDocumentPayload=function(validatedFiles){if(!_.isEmpty(self.documentMetaData)&&self.inputDocumentType&&self.inputDocumentType.documentCategoryName)return Boolean(self.validatedDocumentMetaData()&&self.documentMetaData.file);return true};self.uploadFuncs.uploadDocuments=function(){var deferred=$q.defer();if(self.formObj)self.formObj.$setPristine();var formData=self.getFormData(self.validatedFiles);dataServiceG2.documentsUpload(formData,
function(response){if(response&&response.returnCode!==-1){if(_.isFunction(self.docUploadSuccessHandler))self.docUploadSuccessHandler(response.data);deferred.resolve(response.data)}else{if(response.data&&response.data.failedDocs&&!response.data.code)response.data.code="DOC_UPLOAD_FAILED";if(_.isFunction(self.docUploadFailureHandler))self.docUploadFailureHandler(response);deferred.reject(response)}});return deferred.promise};self.changeDocumentCountry=function(countrySelected){appConfigService.appConfig.getStatesOfCountry(countrySelected,
function(states){self.statesListForDocuments=states})};self.resetDocumentMetaData=function(){self.previousDocMetaData=_.clone(self.documentMetaData);self.documentMetaData={}};self.changeDate=function(){if(self.documentMetaData.expDate)self.expiredDate=new Date(self.documentMetaData.expDate)<new Date;else self.expiredDate=false};self.validatedDocumentMetaData=function(){if(self.inputDocumentType.documentCategoryName)return Boolean(self.documentMetaData.country)&&Boolean(self.documentMetaData.state);
return false};self.resetDocUpForm=function(){self.resetDocumentMetaData();self.inputDocumentType={};self.userSubmitted=false;self.documentSubmitFailure=false};self.addMoreFiles=function(){self.showDocUpForm=true;self.showDocUpLink=true;initializeDocumentMetaData()};self.hideDocUpForm=function(){self.showDocUpForm=false;self.showDocUpLink=false};var initializeDocumentMetaData=function(){self.previousDocMetaData=_.clone(self.documentMetaData);self.documentMetaData={};self.inputDocumentType={};prePopulateCountryAndState()};
var prePopulateCountryAndState=function(){physicalAddress=physicalAddress||{};self.documentMetaData=self.documentMetaData||{};self.documentMetaData.country=self.previousDocMetaData.country||physicalAddress.country||"";self.documentMetaData.state=self.previousDocMetaData.state||physicalAddress.state};self.init=function(){self.resetDocumentMetaData();self.inputDocumentType={};if(!_.isEmpty(self.documentAdditionalInfo.physicalAddress))physicalAddress=_.clone(self.documentAdditionalInfo.physicalAddress);
else if(userConfig.physicalAddress)physicalAddress=_.clone(userConfig.physicalAddress);else physicalAddress={};initializeDocumentMetaData()};self.$watch("physicalAddress",function(newVal,oldVal){physicalAddress=newVal||{};prePopulateCountryAndState()},true);self.init()}}}}]);
app.directive("confirmMobilePhnNbr",["copartUser","dataServiceG2","accountAlertsService",function(copartUser,dataServiceG2,accountAlertsService){return{restrict:"E",replace:true,transclude:true,scope:{remindLater:"\x3dremindLater",removeBannerAndModal:"\x3dremoveBannerAndModal",closeModal:"\x3dcloseModal"},controller:function($scope){var self=$scope;self.locale=dataServiceG2.getLocale();self.primaryPhone={};self.mobileCommunication={type:"",value:{}};self.defaultPhoneNumberObj={number:undefined,extension:undefined,
type:undefined,prefix:undefined,areaCode:undefined,phoneNumber:undefined,phoneType:undefined};self.accountEditInfoVO={};self.enableAfterSubmitSection=false;self.message="";self.confirmMobileUserActionCode="TEXT_MSG_SUBSCRIPTION";self.submitted=false;self.showExisting=false},link:{pre:function(){},post:function($scope){var self=$scope;self.getContactInformation=function(){dataServiceG2.getContactInformation(function(response){if(response.primaryPhone)self.primaryPhone=response.primaryPhone;if(response.secondaryPhone)self.secondaryPhone=
response.secondaryPhone;if(response.mobilePhone)self.mobilePhone=response.mobilePhone;self.showExisting=!_.isEmpty(self.primaryPhone||self.secondaryPhone||self.mobilePhone);self.setDefaultSelection();self.setUpMobileCommunication()},function(error){self.showExisting=false;self.setDefaultSelection();self.setUpMobileCommunication()})};self.setDefaultSelection=function(){if(self.showExisting)self.mobileCommunication.type="existing";else self.mobileCommunication.type="new"};self.remindMeLater=function(userActionCode){if(_.isFunction(self.remindLater))self.remindLater(userActionCode)};
self.setUpMobileCommunication=function(){self.submitted=false;if(self.mobileCommunication.type==="existing")self.mobileCommunication.value=self.primaryPhone||self.secondaryPhone||self.mobilePhone;else if(self.mobileCommunication.type==="new")self.mobileCommunication.value={}};self.submit=function(form,data){self.message="";self.success=false;self.error=false;self.submitted=true;var mobileNbrSelector=$('#confirmMobilePhoneNbr [name\x3d"phoneNumber"]');if(mobileNbrSelector.length>0){if(mobileNbrSelector.intlTelInput("isValidNumber"))self.saveMobileNumber()}else self.saveMobileNumber()};
self.saveMobileNumber=function(){dataServiceG2.saveContactInfo(self.getRequestData(),function(response){if(response&&response.data&&response.data.returnCode!==-1){self.message=self.locale.messages["app.label.subscriptions.update.modal.update.phone.success"];self.success=true}else{console.log("Proactive comm update failed",response);self.message=self.locale.messages["app.error.global.text"];self.submitted=false;self.error=true}},function(error){console.log("Proactive comm update failed",error);self.message=
self.locale.messages["app.error.global.text"];self.error=true;self.submitted=false})};self.getRequestData=function(){if(self.mobileCommunication.value)self.mobileCommunication.value.phoneType="MOBILE";self.accountEditInfoVO.mobilePhone=self.mobileCommunication.value;return self.accountEditInfoVO};self.close=function(){if(_.isFunction(self.closeModal)){self.closeModal();self.message="";self.error=false;self.success=false;self.setUpMobileCommunication()}};self.closeAndRefreshAlerts=function(){if(self.success)self.removeBannerAndModal(self.confirmMobileUserActionCode);
else{self.message="";self.error=false;self.success=false;self.setUpMobileCommunication()}};self.init=function(){self.getContactInformation()};self.init()}},templateUrl:"/fetchDirective.html?directive\x3daccountAlerts/confirmMobilePhoneNumberDirective"}}]);
app.directive("subscriptions",function($timeout,copartUser,appConfigService,subscriptionsService,constants){return{restrict:"E",replace:true,scope:{addressVO:"\x3d?",subscriptions:"\x3d?subscriptions"},templateUrl:"/public/fetchDirective.html?directive\x3dregistration/subscriptions\x26agent\x3d007",link:function(scope,element,attributes,controller){var self=scope;self.addressVO=self.addressVO||{};self.subscriptions=self.subscriptions||[];self.isGDPRCountry=false;self.locale=scope.$parent.locale;var siteRegionCode=
copartUser.getUserConfig().siteRegionCode;var registerCountryChangeEvent=function(){scope.$watch("addressVO.country",function(newVal,oldVal){checkForGDPRCountry(newVal)},true)};var checkForGDPRCountry=function(country){self.isGDPRCountry=self.countryCodesToShowCookiePolicy&&_.contains(self.countryCodesToShowCookiePolicy,country);if(self.isGDPRCountry)self.subscriptions=subscriptionsService.getSubscriptionsForSubscriptionCode("MKT_NEWS");else self.subscriptions=[]};var initialize=function(){if(siteRegionCode==
"us"){if(appConfigService&&appConfigService.envConfigProps&&appConfigService.envConfigProps.countryCodesToShowCookiePolicy)self.countryCodesToShowCookiePolicy=appConfigService.envConfigProps.countryCodesToShowCookiePolicy;registerCountryChangeEvent()}else;};self.updateSubscription=function(subscription){if(subscription.isChecked)subscription.subscriptionStatus=constants.SUBSCRIBED;else subscription.subscriptionStatus=constants.NOT_SUBSCRIBED};self.init=function(){initialize()};self.init()}}});
app.directive("globalAlerts",["dataServiceG2","$templateRequest","$q","cmsContentService","$compile","$timeout",function(dataServiceG2,$templateRequest,$q,cmsContentService,$compile,$timeout){return{restrict:"E",replace:true,transclude:true,scope:{},controller:function($scope,$element,$attrs){var self=$scope},link:{pre:function(){},post:function($scope,$element){var self=$scope;self.enableGlobalAlerts=false;self.globalAlertsBannerCount=0;self.notifications={};self.notifications.isBrowserOld=appInit.isBrowserOld;
self.notifications.oldBrowser=appInit.oldBrowser;if(self.notifications.isBrowserOld&&self.notifications.oldBrowser)self.globalAlertsBannerCount+=1;var parentFragmentId="/Content/US/EN/User/GlobalAlerts.html";var alertsWrapperFragmentId="GlobalAlerts";var fetchGlobalAlertsWrapper=function(){var deferred=$q.defer();cmsContentService.getFragmentContent(parentFragmentId).then(function(data){if(data){var wrapper=jQuery(data).filter("#"+alertsWrapperFragmentId);if(wrapper&&wrapper.length>0)deferred.resolve(wrapper)}else deferred.reject("")},
function(error){deferred.reject("")});return deferred.promise};var appendGlobalAlerts=function(){fetchGlobalAlerts().then(function(response){if(response){var alerts=response;alerts.forEach(function(alert){if(alert&&alert.alertContent&&alert.alertCode){var carousel=jQuery($element).find("#global-carousel-banner");if(carousel&&carousel.length>0){var banner=jQuery("\x3cdiv class\x3d'item' id\x3d'global-banner-"+alert.alertCode+"'\x3e\x3c/div\x3e");banner.append(alert.alertContent);carousel.append(banner);
self.globalAlertsBannerCount+=1}}})}compileAlerts()},function(error){compileAlerts()})};var fetchGlobalAlerts=function(){var deferred=$q.defer();dataServiceG2.getGlobalAlerts(function(response){if(response&&response.data&&response.data.returnCode!==-1)deferred.resolve(response.data.data);else deferred.reject("")},function(error){deferred.reject("")});return deferred.promise};var compileAlerts=function(){$compile($element)(self);$timeout(function(){initializeBannerCarousel();setFirstBannerActive();
enableAlertsForView()})};var initializeBannerCarousel=function(){jQuery("#global-notification-carousel").carousel({interval:1E4,pause:"hover"})};var setFirstBannerActive=function(){jQuery("#global-carousel-banner").children().removeClass("active");jQuery("#global-carousel-banner .item").first().addClass("active")};var enableAlertsForView=function(){if(self.globalAlertsBannerCount>0)self.enableGlobalAlerts=true};self.renderGlobalAlerts=function(){fetchGlobalAlertsWrapper().then(function(response){if(response){var defaultBanner=
jQuery(response).find("#default-banner");if(defaultBanner&&defaultBanner.length>0&&!defaultBanner.is(":empty")){$element.append(defaultBanner);compileAlerts()}else{var alertsBannerHolder=jQuery(response).find("#global-carousel-banner");if(alertsBannerHolder&&alertsBannerHolder.length>0)$element.append(response);appendGlobalAlerts()}}},function(error){console.log("Could not load global alerts")})};self.closeCarousel=function(){console.log(self.enableGlobalAlerts);self.enableGlobalAlerts=false};self.init=
function(){self.renderGlobalAlerts()};self.init()}},template:'\x3cdiv id\x3d"global-alerts" class\x3d"global-alerts"\x3e\x3c/div\x3e'}}]);
app.directive("pendingStepForBidding",["dataServiceG2","accountAlertsService","userService","constants","navigationUrlConstants",function(dataServiceG2,accountAlertsService,userService,constants,navigationUrlConstants){return{restrict:"A",transclude:false,scope:{},controller:function($scope,$element,$attrs){var self=$scope;self.locale=dataServiceG2.getLocale();$scope.$watch(function(){return accountAlertsService.getAlerts()},function(newAlerts){if(newAlerts&&newAlerts.length>0){self.pendingRegistration=
!accountAlertsService.isRegistrationComplete();self.setLabelAndNavigation()}})},link:{pre:function(){},post:function($scope,iElement,iAttrs,controller){var self=$scope;self.navigationUrl="";self.label="";self.pendingRegistration=false;var buyerStatus=userService.userConfig&&userService.userConfig.buyerStatus;self.setLabelAndNavigation=function(){if(self.pendingRegistration)if(!accountAlertsService.isActionCompleteForActivity(constants.REGISTRATION_USER_ACTIVITY,constants.ALERT_TYPE_STATUS.missingAccInfo)||
!accountAlertsService.isActionCompleteForActivity(constants.REGISTRATION_USER_ACTIVITY,constants.ALERT_TYPE_STATUS.pendingMemPayment)){self.navigationUrl=constants.FORWARD_SLASH+navigationUrlConstants.COMPLETE_REGISTRATION;self.label=self.locale.messages["app.label.complete.registration"]||self.locale.messages["app.label.upgradeMembership"]}else{if(!accountAlertsService.isActionCompleteForActivity(constants.REGISTRATION_USER_ACTIVITY,constants.ALERT_TYPE_STATUS.noUploadDoc)){self.navigationUrl=constants.FORWARD_SLASH+
navigationUrlConstants.DOCUMENT_UPLOAD;self.label=self.locale.messages["app.label.alert.NEW_DOCUMENT_UPLOAD.action.button.text"]||self.locale.messages["app.label.upgradeMembership"]}}else if(buyerStatus==="ROLE_GUEST"){self.navigationUrl=constants.FORWARD_SLASH+navigationUrlConstants.ACCOUNT_UPGRADE_MEMBERSHIP;self.label=self.locale.messages["app.label.upgradeMembership"]||self.locale.messages["app.label.upgradeMembership"]}if(self.navigationUrl)iAttrs.$set("href",self.navigationUrl);if(self.label)iElement.text(self.label)}}}}}]);
app.directive("paymentGateway",["copartUser","constants","$q","dataServiceG2","appConfigService","scrollToDivService",function(copartUser,constants,$q,dataServiceG2,appConfigService,scrollToDivService){return{restrict:"E",replace:true,transclude:true,scope:{defaultPaymentType:"\x3d?",referenceId:"\x3d?",paymentFuncs:"\x3d?paymentFuncs",selectedProduct:"\x3c",additionalPaymentInfo:"\x3dadditionalPaymentInfo",paymentSuccessHandler:"\x3d?paymentSuccessHandler",paymentFailureHandler:"\x3d?paymentFailureHandler",
submitted:"\x3d?"},controller:function($scope,$element,$attrs){},link:{pre:function($scope,iElement,$attrs,controller){},post:function($scope,iElement,$attrs,controller){var self=$scope;self.locale=dataServiceG2.getLocale();self.paymentErrors=[];self.paymentFuncs=self.paymentFuncs||{};self.referenceId=self.referenceId||"";self.paymentSuccessHandler=self.paymentSuccessHandler||function(){};self.paymentTypes=[];self.additionalPaymentInfo=self.additionalPaymentInfo||{};self.submitted=Boolean(self.submitted);
if(appConfigService.getAppConfig()&&appConfigService.getAppConfig().getPaymentMethods()){var availablePaymentMethods=appConfigService.getAppConfig().getPaymentMethods();var paymentMethodOrder=constants.PAYMENT_METHOD_ORDER;var supportedPaymentMethods=[];if(!window.ApplePaySession)angular.forEach(paymentMethodOrder,function(paymentMethod,index){if(paymentMethod===constants.APPLE_PAY_METHOD_CODE)paymentMethodOrder.splice(index,1)});angular.forEach(paymentMethodOrder,function(paymentMethod){supportedPaymentMethods.push(_.find(availablePaymentMethods,
{"paymentMethod":paymentMethod}))});self.paymentTypes=angular.copy(supportedPaymentMethods);self.setPaymentTypes=function(){self.paymentTypes=_.filter(supportedPaymentMethods,function(paymentType){return paymentType.paymentMethod!=="WIRE"})}}$scope.$watch($attrs.additionalPaymentInfo,function(newVal,oldVal){self.setPaymentTypes()},true);var getDefaultSelectedPaymentType=function(){self.defaultPaymentType=self.defaultPaymentType||constants.DEFAULT_PAYMENT_METHOD;if(self.paymentTypes&&self.paymentTypes instanceof
Array){var defaultPaymentObj=_.find(self.paymentTypes,{"paymentMethod":self.defaultPaymentType})||_.first(self.paymentTypes);return defaultPaymentObj.paymentMethod}};self.selectPaymentMethod=function(paymentMethod){self.selectedPaymentType=paymentMethod;self.paymentErrors=[]};self.selectedPaymentType=getDefaultSelectedPaymentType();var getDefaultRequestPayload=function(){var selectedProduct=self.selectedProduct;return{"productCode":selectedProduct?selectedProduct.productCode:"","referenceId":self.referenceId,
"autoPaySubscription":selectedProduct?selectedProduct.autoPaySubscription:"","saveCardOnFile":selectedProduct?selectedProduct.saveCard:"","paymentDetails":{"paymentMethod":self.selectedPaymentType}}};var buildRequestPayload=function(){var deferred=$q.defer();var requestPayload=getDefaultRequestPayload();if(_.isFunction(self.paymentFuncs.getAddtnlPaymentInfo))self.paymentFuncs.getAddtnlPaymentInfo().then(function(addtnlPaymentInfo){if(addtnlPaymentInfo.billingAddress&&!_.isEmpty(addtnlPaymentInfo.billingAddress)){angular.extend(requestPayload.paymentDetails,
addtnlPaymentInfo);deferred.resolve(requestPayload)}else{var errorObj={code:"MISSING_BILLING_ADDRESS",description:"Please enter the billing address"};deferred.reject(errorObj)}},function(error){deferred.reject(error)});return deferred.promise};self.paymentFuncs.submitPayment=function(){self.paymentErrors=[];var deferred=$q.defer();if(self.selectedProduct.totalPrice>0&&_.isFunction(self.paymentFuncs.validatePaymentPayload))buildRequestPayload().then(function(payLoad){dataServiceG2.submitPayment(payLoad,
function(response){if(response&&response.data&&response.data.returnCode!==-1){var promoCodeTracking="";var promoAmountTracking="";var crmIdTracking="";if(self.additionalPaymentInfo&&self.additionalPaymentInfo.product.charges)if(self.additionalPaymentInfo.product.charges[0]&&self.additionalPaymentInfo.product.charges[0].promos[0]){promoCodeTracking=self.additionalPaymentInfo.product.charges[0].promos[0].promoCode;promoAmountTracking=self.additionalPaymentInfo.product.charges[0].promos[0].promoAmount}if(copartUser.getUserConfig().crmId)crmIdTracking=
copartUser.getUserConfig().crmId;copartOmnitureCallMulti("doTagRegistrationStep2Complete",[response.data.data.memberId,payLoad.productCode,promoCodeTracking,promoAmountTracking,payLoad.paymentDetails.paymentMethod,payLoad.autoPaySubscription,payLoad.saveCardOnFile,crmIdTracking]);if(_.isFunction(self.paymentSuccessHandler))self.paymentSuccessHandler(response.data);deferred.resolve(response.data)}else{var errorObjects=response.data&&response.data.data&&response.data.data.errorObjects?response.data.data.errorObjects:
{};if(_.isFunction(self.paymentFailureHandler))self.paymentFailureHandler(errorObjects);if(_.isFunction(self.paymentFuncs.paymentFailureHandler))self.paymentFuncs.paymentFailureHandler(response);scrollToDivService.scrollToDiv("membershipPurchaseForm");deferred.reject(errorObjects)}})},function(error){deferred.reject(error)});else deferred.reject({});return deferred.promise};self.paymentFuncs.validatePaymentPayload=function(){return false};self.paymentFuncs.clearErrors=function(){self.paymentErrors=
[]};self.paymentFuncs.getSelectedPaymentType=function(){return self.selectedPaymentType}}},templateUrl:"/public/fetchDirective.html?directive\x3dregistration/external-payments/payment-methods"}}]);
app.directive("cybersourcePaymentGateway",["copartUser","dataServiceG2","creditCardService","$cookies","userService","$q","constants","$exceptionHandler","cyberSourceErrors","copartUtils","errorHandler","$window","$compile",function(copartUser,dataServiceG2,creditCardService,$cookies,userService,$q,constants,exceptionHandler,cyberSourceErrors,copartUtils,errorHandler,$window,$compile){return{restrict:"E",replace:true,transclude:true,require:"^form",scope:{addtnlPaymentVO:"\x3d?bindObject",paymentErrors:"\x3d",
hidePayBtn:"\x3c",paymentFuncs:"\x3d?paymentFuncs",selectedPaymentType:"\x3d",paymentFormValid:"\x26",paymentSuccessHandler:"\x26paymentSuccessHandler",paymentFailureHandler:"\x26paymentFailureHandler",paymentDetailsForReview:"\x26paymentDetailsForReview",submitted:"\x3d?"},controller:function($scope,$element,$attrs){var self=$scope;if($attrs.hasOwnProperty("hidePayBtn"))self.hidePayBtn=true},link:{pre:function($scope,iElement,$attrs,controller){},post:function($scope,iElement,$attrs,controller){var self=
$scope;self.paymentForm=controller;self.paymentFormValid=self.paymentFormValid||{};self.loadCyberSourceForm=true;self.reloadPaymentSession=function(){init()};self.cardNumber=new CreditCardNumberVO(constants);self.paymentFuncs=self.paymentFuncs||{};self.addtnlPaymentVO=self.addtnlPaymentVO||{};var getDefaultCreditCardExpiryObj=function(){return{"month":"","year":""}};self.getCountryObj=function(params){if(!_.isEmpty(params.country)){var countryCode;if(typeof params.country==="object")countryCode=params.country.code;
else countryCode=params.country;params.country=_.find(self.countryList,function(country){return country.code===countryCode})}return params};self.populateBillingAddress=function(){if(self.physicalAddressSameAsBillingAddr){if(self.addtnlPaymentVO.physicalAddress)self.paymentFormVO.billingAddress=self.getCountryObj(_.clone(self.addtnlPaymentVO.physicalAddress))}else self.paymentFormVO.billingAddress=new AddressVO};var initializePaymentVO=function(){self.paymentFormVO=new CreditCardVO;self.paymentFormVO.billingAddress=
new AddressVO;self.paymentFormVO.cardPhoneNumber=new PhoneVO;self.physicalAddressSameAsBillingAddr=false};var init=function(){self.submitted=false;self.paymentSessionExpired=false;self.locale=dataServiceG2.getLocale();self.availableCardTypes=creditCardService.getAvailableCardTypes();self.cvvMonths=creditCardService.getCVVMonths();self.cvvYears=creditCardService.getCVVYears();self.defaultCardType=self.availableCardTypes[0];self.countryList=creditCardService.getCountryList();self.statesList=creditCardService.getStatesList();
self.cardExpiryObj=getDefaultCreditCardExpiryObj();initializePaymentVO();self.initJWTFlexConfig()};self.postPayment=function(form){if(!form.$valid){self.paymentFormInvalid=true;return}else self.paymentFormInvalid=false};self.paymentFuncs.getAddtnlPaymentInfo=function(){var deferred=$q.defer();self.generateCustomerPaymentToken().then(function(data){var cardName=self.paymentFormVO&&self.paymentFormVO.cardOwnerName&&self.paymentFormVO.cardOwnerName.split(constants.SPACE);var additionalInfo={"targetDomain":"",
"firstName":cardName&&cardName.length>0&&cardName[0],"lastName":cardName&&cardName.length>0&&cardName[1],"email":self.paymentFormVO.email,"billingAddress":copartUtils.setCountryCodeForAddress(self.paymentFormVO.billingAddress),"jwtToken":data.token};deferred.resolve(additionalInfo)},function(error){deferred.reject(error)});return deferred.promise};self.generatePaymentData=function(selectedProduct,data){return{"targetDomain":"","firstName":self.paymentFormVO.cardOwnerName,"lastName":self.paymentFormVO.cardOwnerSurName,
"email":self.paymentFormVO.email,"billingAddress":copartUtils.setCountryCodeForAddress(self.paymentFormVO.billingAddress),"jwtToken":data.token}};self.handleCyberSourcePayment=function(selectedProduct){if(_.isFunction(self.generateCustomerPaymentToken))self.generateCustomerPaymentToken().then(function(data){dataServiceG2.submitPayment(self.generatePaymentData(selectedProduct,data),function(response){if(response&&response.data&&response.data.returnCode!==-1)self.paymentSuccessHandler()(response);else{console.log("Cybersource submit payment failed: ",
response);self.paymentFailureHandler()(response)}})},function(error){console.log("Invalid card entered");exceptionHandler(error.errors)})};self.paymentFuncs.generateCustomerPaymentToken=function(){return self.generateCustomerPaymentToken().then(function(data){return data})};self.paymentFuncs.validatePaymentPayload=function(){var deferred=$q.defer();var isValid=Boolean(self.paymentForm.$valid&&self.cardNumber&&self.cardNumber.cardNumberValid&&self.cardNumber.cardCvnValid);if(isValid)deferred.resolve(isValid);
else deferred.reject({});return deferred.promise};var setUpJWTMicroform=function(token){var myStyles={"input":{"font-size":"18px","opacity":"0.8"},":focus":{"color":"blue"},":disabled":{"cursor":"not-allowed"},"valid":{"color":"#3c763d"},"invalid":{"color":"#a94442"}};var flex=new Flex(token.keyId);self.microform=flex.microform({styles:myStyles});var cardNumber=self.microform.createField("number",{placeholder:self.locale.messages["app.label.enterCardNumber"]});var cardCvn=self.microform.createField("securityCode",
{placeholder:"CVV"});self.subscribeToCardNumberEvents(cardNumber);self.subscribeToCardCvnEvents(cardCvn);cardNumber.load("#cardNumber-container");cardCvn.load("#securityCode-container");self.cardNumber=new CreditCardNumberVO(constants)};self.subscribeToCardNumberEvents=function(cardNumber){cardNumber.on("change",function(data){if(data.card&&data.card.length>0){var cardData=data.card[0];self.cardNumber.cardNumberValid=cardData.couldBeValid;self.cardNumber.cardName=cardData.name;if(cardData.lengths&&
cardData.lengths.length>0){self.cardNumber.minLength=cardData.lengths[0];self.cardNumber.maxLength=cardData.lengths[cardData.lengths.length-1]}if(cardData.securityCode){self.cardNumber.securityCodeLength=cardData.securityCode.length;self.cardNumber.securityCodeLabel=cardData.securityCode.name}if(cardData.cybsCardType&&cardData.cybsCardType!==self.cardNumber.cardType){self.cardNumber.cardType=cardData.cybsCardType;for(var i=0;i<self.availableCardTypes.length;++i)if(self.availableCardTypes[i].code===
self.cardNumber.cardType&&self.availableCardTypes[i].displayName.toLowerCase()!==self.cardNumber.cardImage){self.cardNumber.cardImage=self.availableCardTypes[i].displayName.toLowerCase();break}}}else{self.cardNumber.cardType="";self.cardNumber.cardImage=""}})};self.subscribeToCardCvnEvents=function(cardCvn){cardCvn.on("change",function(data){if(data){self.cardNumber.cardCvnValid=data.valid;self.cardNumber.cardCvnEmpty=data.empty}})};self.setCardNumberValidationMessage=function(){if(self.cardNumber.cardNumberValid)self.cardNumber.creditCardInvalidErrMsg=
"";else self.cardNumber.creditCardInvalidErrMsg=constants.CREDIT_CARD_INVALID_ERR_MSG};self.setCardCvnValidationMessage=function(){if(self.cardNumber.cardCvnValid)self.cardNumber.creditCardCvnInvalidErrMsg="";else self.cardNumber.creditCardCvnInvalidErrMsg=constants.CREDIT_CARD_CVN_INVALID_ERR_MSG.format(self.cardNumber.securityCodeLabel)};self.initJWTFlexConfig=function(){dataServiceG2.generatePaymentToken({paymentMethod:constants.CARD_PAYMENT_METHOD_CODE},function(response){if(response.returnCode!=
-1&&response.data&&response.data.response){var jwtToken=response.data.response;setUpJWTMicroform(jwtToken);self.generateCustomerPaymentToken=function(){var deferred=$q.defer();var options={expirationMonth:self.cardExpiryObj.month?self.cardExpiryObj.month+"":"",expirationYear:self.cardExpiryObj.year?self.cardExpiryObj.year+"":""};if(!self.cardNumber.cardType)options["type"]=self.paymentForm.cardType;self.microform.createToken(options,function(err,token){var response={};if(err){self.handleTokenCreationErr(err);
response.errors=err;deferred.reject(response.errors)}else{self.paymentSessionExpired=false;response.token=token;deferred.resolve(response)}});return deferred.promise}}else{self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.cybersource.load.failure"]);self.loadCyberSourceForm=false;console.log("Cyber source Flex form Error: unable to load cyber source flex form: Token generation failed ",response)}})};self.handleTokenCreationErr=function(err){self.paymentSessionExpired=false;if(err.reason===
"CREATE_TOKEN_CAPTURE_CONTEXT_NOT_FOUND")self.paymentSessionExpired=true;else if(err.reason==="CREATE_TOKEN_VALIDATION_FIELDS")self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.REJECT"]);else self.paymentSessionExpired=true;exceptionHandler(err)};self.paymentFuncs.paymentSuccessHandler=function(response){};self.paymentFuncs.paymentFailureHandler=function(response){self.paymentSessionExpired=false;var errorObjects=response.data&&response.data.data&&response.data.data.errorObjects?
response.data.data.errorObjects:{};var errorMsgs=self.handleErrorMessages(errorObjects,"app.error.paymentgateway.");errorMsgs.forEach(function(msg){self.paymentErrors.push(msg)})};self.handleErrorMessages=function(error,label){var errorObjs=[];var errorMsgs=[];if(error){errorObjs=error;if(errorObjs instanceof Array&&!_.isEmpty(errorObjs)){for(var i=0;i<errorObjs.length;++i)if(errorObjs[i].field&&errorObjs[i].field.indexOf("billTo")!==-1)errorMsgs.push(self.locale.messages["app.error.paymentgateway.cybersource.billTo.error"]);
else if(errorObjs[i].code&&self.locale.messages["app.error.paymentgateway."+errorObjs[i].code])errorMsgs.push(self.locale.messages["app.error.paymentgateway."+errorObjs[i].code]);else errorMsgs.push(self.locale.messages["app.error.paymentgateway.REJECT"]);return errorMsgs}}return errorMsgs};init()}},templateUrl:"/public/fetchDirective.html?directive\x3dregistration/external-payments/cybersource-payment-form"}}]);
app.directive("paypalPaymentGateway",["dataServiceG2","$q","errorHandler","constants","appConfigService","copartUtils",function(dataServiceG2,$q,errorHandler,constants,appConfigService,copartUtils){return{restrict:"E",templateUrl:"/public/fetchDirective.html?directive\x3dregistration/external-payments/braintree/paypal",scope:{paymentFuncs:"\x3d?paymentFuncs",paymentSuccessHandler:"\x26paymentSuccessHandler",paymentFailureHandler:"\x26paymentFailureHandler",selectedPaymentType:"\x3d",paymentErrors:"\x3d",
submitted:"\x3d?"},controller:function($scope,$element,$attrs){var self=$scope;var instanceUI=null;self.locale=dataServiceG2.getLocale();self.countryList=appConfigService.appConfig.getCountries();self.statesList=appConfigService.appConfig.getCountryStates();var additionalInfo={};self.missingBillingAddress=false;self.paymentErrors=self.paymentErrors||[];self.billingAddressVO={};dataServiceG2.generatePaymentToken({paymentMethod:constants.PAYPAL_PAY_METHOD_CODE},function(res){if(res.data.response)braintree.dropin.create({authorization:res.data.response,
container:"#bt-dropin",paymentOptionPriority:["paypal"],paypal:{flow:"vault"}},function(createErr,instance){instanceUI=instance});else{self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.paypal.load.failure"]);console.log("instanceUI: unable to load paypal ")}});self.generatePaypalPaymentData=function(selectedProduct,data){return{"nonce":data.nonce}};self.buildBillingAddressFromResponse=function(billingAddress){billingAddress=billingAddress||{};var addressVO=new AddressVO;addressVO.line1=
billingAddress.line1;addressVO.city=billingAddress.city;addressVO.postCode=billingAddress.postalCode;var countryObj=_.find(self.countryList,{twoCharCountryCode:billingAddress.countryCode})||{};var stateObj=_.find(self.statesList,{type:countryObj.code,code:billingAddress.state})||{};addressVO.country=countryObj.code||"";addressVO.state=stateObj.code||"";return addressVO};self.paymentFuncs.getAddtnlPaymentInfo=function(){var deferred=$q.defer();deferred.resolve(additionalInfo);return deferred.promise};
self.paymentFuncs.validatePaymentPayload=function(){var deferred=$q.defer();self.missingBillingAddress=false;var billingAddress={};instanceUI.requestPaymentMethod(function(err,payload){var buyerInfo=payload&&payload.details?payload.details:{};if(!_.isEmpty(buyerInfo.billingAddress))billingAddress=self.buildBillingAddressFromResponse(buyerInfo.billingAddress);else if(!_.isEmpty(self.billingAddressVO))billingAddress=copartUtils.setCountryCodeForAddress(self.billingAddressVO);if(_.isEmpty(buyerInfo)){var errorObj=
{code:"MISSING_PAYMENT_INFO",description:"Please enter valid card details"};deferred.reject(errorObj)}else if(_.isEmpty(billingAddress)){self.missingBillingAddress=true;var errorObj={code:"MISSING_BILLING_ADDRESS",description:"Please enter the billing address"};deferred.reject(errorObj)}else{additionalInfo={"nonce":payload.nonce,"firstName":buyerInfo.firstName||"","lastName":buyerInfo.lastName||"","email":buyerInfo.email||"","billingAddress":billingAddress};deferred.resolve(true)}});return deferred.promise;
try{return!_.isEmpty(instanceUI._model._paymentMethods)}catch(e){console.log("Paypal::validatePaymentPayload::",e)}return false};self.paymentFuncs.paymentSuccessHandler=function(response){};self.paymentFuncs.paymentFailureHandler=function(response){var errorObjects=response.data&&response.data.data&&response.data.data.errorObjects?response.data.data.errorObjects:{};var errorMsgs=self.handleErrorMessages(errorObjects,"app.error.paymentgateway.");errorMsgs.forEach(function(msg){self.paymentErrors.push(msg)})};
self.handleErrorMessages=function(error,label){var errorObjs=[];var errorMsgs=[];if(error){errorObjs=error;if(label)errorMsgs=errorHandler.handleErrors(errorObjs,label);else errorMsgs=errorHandler.handleErrors(errorObjs,"app.error.paymentgateway.");console.log("errorMsgs::: ",errorMsgs)}return errorMsgs}},link:{pre:function($scope,iElement,$attrs,controller){},post:function($scope,iElement,$attrs,controller){var self=$scope;self.paymentFuncs=self.paymentFuncs||{};self.init=function(){self.submitted=
false};self.init()}}}}]);
app.directive("googlepayPaymentGateway",["$q","dataServiceG2","userService","googlepayService","errorHandler","constants","appConfigService",function($q,dataServiceG2,userService,googlepayService,errorHandler,constants,appConfigService){return{restrict:"E",template:'\x3cdiv\x3e\x3cdiv id\x3d"bt-dropin-google-pay"\x3e\x3c/div\x3e\x3cdiv id\x3d"google-pay-nonce"\x3e\x3c/div\x3e\x3cdiv\x3e',scope:{paymentFuncs:"\x3d?paymentFuncs",paymentSuccessHandler:"\x26paymentSuccessHandler",paymentFailureHandler:"\x26paymentFailureHandler",
selectedPaymentType:"\x3d",paymentErrors:"\x3d"},controller:function($scope,$element,$attrs){var self=$scope;self.locale=dataServiceG2.getLocale();self.countryList=appConfigService.appConfig.getCountries();self.statesList=appConfigService.appConfig.getCountryStates();var userConfig=userService.userConfig;self.currencyCode=userConfig.defaultDisplayPref.currencyCode;var googlePayInstanceUI=null;googlepayService.getGooglePayProperties().then(function(response){var googlepaProperties=response.googlePayProperties;
self.googelPayVariables={"environment":googlepaProperties.environment||"TEST","merchantId":googlepaProperties.merchantId||undefined,"googleMerchantId":googlepaProperties.googleMerchantId||undefined,"googlePayVersion":googlepaProperties.googlePayVersion||2,"currencyCode":self.currencyCode,"totalPriceStatus":googlepaProperties.totalPriceStatus||"NOT_CURRENTLY_KNOWN","apiVersion":googlepaProperties.apiVersion||2,"apiVersionMinor":googlepaProperties.apiVersionMinor||0,"billingAddressRequired":googlepaProperties.billingAddressRequired||
true,"billingAddressParameters":{"format":googlepaProperties.billingAddressFormat||"FULL","phoneNumberRequired":googlepaProperties.phoneNumberRequired||false}};var googlePayPaymentClient=new google.payments.api.PaymentsClient({environment:self.googelPayVariables.environment});if(!googlePayPaymentClient){self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.googlepay.load.notSupported"]);return}var buildPaymentDataRequest=function(googlePayInstanceUI){var requestObj={transactionInfo:{currencyCode:self.googelPayVariables.currencyCode,
totalPriceStatus:self.googelPayVariables.totalPriceStatus}};if(self.googelPayVariables.merchantId&&self.googelPayVariables.environment!="TEST")requestObj.merchantInfo={merchantId:self.googelPayVariables.googleMerchantId};var paymentDataRequest=googlePayInstanceUI.createPaymentDataRequest(requestObj);var cardPaymentMethod=paymentDataRequest.allowedPaymentMethods[0];cardPaymentMethod.parameters.billingAddressRequired=self.googelPayVariables.billingAddressRequired;cardPaymentMethod.parameters.billingAddressParameters=
self.googelPayVariables.billingAddressParameters;return paymentDataRequest};var createGooglePayButton=googlePayPaymentClient.createButton({onClick:function(event){event.preventDefault();googlePayPaymentClient.loadPaymentData(buildPaymentDataRequest(googlePayInstanceUI)).then(function(paymentData){self.googlePayResponse=paymentData;googlePayInstanceUI.parseResponse(paymentData,function(err,result){if(err){self.paymentErrors.push(err.statusMessage||self.locale.messages["app.error.paymentgateway.googlepay.load.failure"]);
self.defaultValues()}else{self.nonce=result.nonce;var billingAddress=paymentData&&paymentData.paymentMethodData&&paymentData.paymentMethodData.info&&paymentData.paymentMethodData.info.billingAddress?paymentData.paymentMethodData.info.billingAddress:{};var countryObj=_.find(self.countryList,{twoCharCountryCode:billingAddress.countryCode})||{};var stateObj=_.find(self.statesList,{type:countryObj.code,code:billingAddress.administrativeArea})||{};self.billingAddress={name:billingAddress.name,line1:billingAddress.address1,
line2:billingAddress.address2,city:billingAddress.locality,country:countryObj.code,state:stateObj.code||"",zip1:billingAddress.postalCode};self.paymentMethodPresent=result.type;jQuery("#google-pay-nonce").html("\x3cspan\x3eSelected "+result.details.cardType+" **** **** **** "+result.details.lastFour+"\x3c/span\x3e")}})})["catch"](function(err){self.defaultValues();self.paymentErrors.push(err.statusMessage||self.locale.messages["app.error.paymentgateway.googlepay.load.failure"])})}});var loadGooglePayUI=
function(googlePayInstanceUI){var getReadyToPayLoad=function(){var requestPayLoad={};requestPayLoad.apiVersion=self.googelPayVariables.apiVersion;requestPayLoad.apiVersionMinor=self.googelPayVariables.apiVersionMinor;requestPayLoad.allowedPaymentMethods=googlePayInstanceUI.createPaymentDataRequest().allowedPaymentMethods;requestPayLoad.existingPaymentMethodRequired=true;return requestPayLoad};googlePayPaymentClient.isReadyToPay(getReadyToPayLoad()).then(function(response){if(response.result)document.getElementById("bt-dropin-google-pay").appendChild(createGooglePayButton)})["catch"](function(err){console.log("GooglePay error:isReadyToPay: ",
err);self.paymentErrors.push(err.statusMessage||self.locale.messages["app.error.paymentgateway.googlepay.load.notSupported"])})};dataServiceG2.generatePaymentToken({paymentMethod:constants.GOOGLE_PAY_METHOD_CODE},function(res){if(res.data.response)braintree.client.create({authorization:res.data.response},function(clientErr,clientInstance){if(null!=clientErr){self.paymentErrors.push(clientErr.statusMessage||self.locale.messages["app.error.paymentgateway.googlepay.load.failure"]);return}var googlePayUIRequestObj=
{client:clientInstance,googlePayVersion:self.googelPayVariables.googlePayVersion};if(self.googelPayVariables.googleMerchantId&&self.googelPayVariables.environment!="TEST")googlePayUIRequestObj.googleMerchantId=self.googelPayVariables.googleMerchantId;braintree.googlePayment.create(googlePayUIRequestObj,function(googlePaymentErr,googlePaymentInstance){googlePayInstanceUI=googlePaymentInstance;loadGooglePayUI(googlePayInstanceUI)})});else{self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.googlepay.load.failure"]);
console.log("instanceUI: unable to load Google Pay ");return}});self.paymentFuncs.getAddtnlPaymentInfo=function(){var deferred=$q.defer();var additionalInfo={"nonce":self.nonce,"billingAddress":self.billingAddress,"firstName":self.billingAddress.name,"cardPhoneNumber":self.billingAddress.phoneNumber?{phoneType:"WORK",intlDialCode:self.billingAddress.phoneNumber?self.billingAddress.phoneNumber.replace("+","").split(" ")[0]:null,phoneNumber:self.billingAddress.phoneNumber?self.billingAddress.phoneNumber.replace("+",
"").split(" ")[1]+self.billingAddress.phoneNumber.replace("+","").split(" ")[2]:null,isoTwoCharCntryCode:self.billingAddress.countryCode?self.billingAddress.countryCode.toLowerCase():null,preferenceType:"BILLING"}:null};deferred.resolve(additionalInfo);return deferred.promise};self.paymentFuncs.validatePaymentPayload=function(){try{var deferred=$q.defer();var isValid=!_.isEmpty(self.paymentMethodPresent);if(isValid)deferred.resolve(isValid);else deferred.reject({})}catch(e){deferred.reject({});console.log("GooglePay :: validatePaymentPayload::",
e)}return deferred.promise};self.paymentFuncs.paymentSuccessHandler=function(response){};self.paymentFuncs.paymentFailureHandler=function(response){var errorObjects=response.data&&response.data.data&&response.data.data.errorObjects?response.data.data.errorObjects:{};var errorMsgs=self.handleErrorMessages(errorObjects,"app.error.paymentgateway.");errorMsgs.forEach(function(msg){self.paymentErrors.push(msg)})};self.handleErrorMessages=function(error,label){var errorObjs=[];var errorMsgs=[];if(error){errorObjs=
error;if(label)errorMsgs=errorHandler.handleErrors(errorObjs,label);else errorMsgs=errorHandler.handleErrors(errorObjs,"app.error.paymentgateway.");console.log("errorMsgs::: ",errorMsgs)}return errorMsgs};self.defaultValues=function(){self.nonce=null;self.paymentMethodPresent="";self.googlePayResponse=null;self.billingAddress=null};self.init=function(){self.defaultValues()};self.init()},function(error){self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.googlepay.load.failure"])})},
link:{pre:function($scope,iElement,$attrs,controller){},post:function($scope,iElement,$attrs,controller){var self=$scope;self.paymentFuncs=self.paymentFuncs||{}}}}}]);
app.directive("applepayPaymentGateway",["$q","dataServiceG2","constants","errorHandler","appConfigService",function($q,dataServiceG2,constants,errorHandler,appConfigService){return{restrict:"E",templateUrl:"/public/fetchDirective.html?directive\x3dregistration/external-payments/apple-pay",scope:{paymentFuncs:"\x3d?paymentFuncs",paymentSuccessHandler:"\x26paymentSuccessHandler",paymentFailureHandler:"\x26paymentFailureHandler",selectedPaymentType:"\x3d",paymentErrors:"\x3d",additionalPaymentInfo:"\x3d"},
controller:function($scope,$element,$attrs){var self=$scope;self.browserUnsupported=false;self.locale=dataServiceG2.getLocale();self.nonce=null;self.paymentTokenizedResponse=null;self.paymentAuthorizedResponse=null;var applePayInstanceUI=null;self.requiredShippingContactFields=["name","phone","email","postalAddress"];self.applePaySessionversion=3;self.additionalPaymentInfo=self.additionalPaymentInfo||{};self.selectedPaymentType=self.selectedPaymentType||"";self.countryList=appConfigService.appConfig.getCountries();
self.statesList=appConfigService.appConfig.getCountryStates();self.getTotalPurchaseAmount=function(){if(self.additionalPaymentInfo&&self.additionalPaymentInfo.product&&self.additionalPaymentInfo.product.total)return self.additionalPaymentInfo.product.total};self.createPaymentSession=function(){if(window.ApplePaySession&&ApplePaySession.canMakePayments()&&self.getTotalPurchaseAmount()){var loadApplePayPayUI=function(applePayInstanceUI){document.getElementById("applePayButton").addEventListener("click",
function(e){e.preventDefault();var paymentRequest=applePayInstanceUI.createPaymentRequest({total:{label:constants.APPLE_PAY_LABEL,amount:self.getTotalPurchaseAmount()},requiredShippingContactFields:self.requiredShippingContactFields,requiredBillingContactFields:self.requiredShippingContactFields});var session=new ApplePaySession(self.applePaySessionversion,paymentRequest);session.onvalidatemerchant=function(event){applePayInstanceUI.performValidation({validationURL:event.validationURL,displayName:"Copart"},
function(validationErr,merchantSession){if(validationErr){console.error("ApplePay : Error validating merchant:",validationErr);self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.applepay.load.failure"]);session.abort();return}session.completeMerchantValidation(merchantSession)})};session.onpaymentauthorized=function(response){self.paymentAuthorizedResponse=response;applePayInstanceUI.tokenize({token:response.payment.token},function(tokenizeErr,payload){if(tokenizeErr){console.error("Error tokenizing Apple Pay:",
tokenizeErr);session.completePayment(ApplePaySession.STATUS_FAILURE);self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.applepay.load.failure"]);return}session.completePayment(ApplePaySession.STATUS_SUCCESS);self.nonce=payload.nonce;self.paymentTokenizedResponse=payload})};session.begin()})};dataServiceG2.generatePaymentToken({paymentMethod:constants.APPLE_PAY_METHOD_CODE},function(res){if(res.data.response)braintree.client.create({authorization:res.data.response},function(clientErr,
clientInstance){if(null!=clientErr){self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.applepay.load.failure"]);return}braintree.applePay.create({client:clientInstance},function(applePayErr,applePayInstance){if(applePayErr){console.error("Error creating applePayInstance:",applePayErr);self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.applepay.load.failure"]);return}applePayInstanceUI=applePayInstance;loadApplePayPayUI(applePayInstanceUI)});document.getElementById("applePayButton").style.display=
"inline"});else{self.paymentErrors.push(self.locale.messages["app.error.paymentgateway.applepay.load.failure"]);console.log("instanceUI: unable to load apple Pay ");return}});self.buildBillingAddressFromResponse=function(){if(self.paymentAuthorizedResponse&&self.paymentAuthorizedResponse.payment&&self.paymentAuthorizedResponse.payment.billingContact){var billingContact=self.paymentAuthorizedResponse.payment.billingContact||{};var addressLines=billingContact.addressLines||[];var addressVO=new AddressVO;
addressVO.line1=addressLines[0]?addressLines[0]:"";addressVO.city=billingContact.locality;addressVO.postCode=billingContact.postalCode;var countryObj=_.find(self.countryList,{twoCharCountryCode:billingContact.countryCode})||{};var stateObj=_.find(self.statesList,{type:countryObj.code,code:billingContact.administrativeArea})||{};addressVO.country=countryObj.code||"";addressVO.state=stateObj.code||"";return addressVO}return{}};self.paymentFuncs.getAddtnlPaymentInfo=function(){var deferred=$q.defer();
var additionalInfo={"nonce":self.nonce,"billingAddress":self.buildBillingAddressFromResponse()};deferred.resolve(additionalInfo);return deferred.promise};self.paymentFuncs.validatePaymentPayload=function(){var deferred=$q.defer();var isValid=!_.isEmpty(self.paymentTokenizedResponse);if(isValid)deferred.resolve(isValid);else deferred.reject({});return deferred.promise};self.paymentFuncs.paymentSuccessHandler=function(response){};self.paymentFuncs.paymentFailureHandler=function(response){var errorObjects=
response.data&&response.data.data&&response.data.data.errorObjects?response.data.data.errorObjects:{};var errorMsgs=self.handleErrorMessages(errorObjects,"app.error.paymentgateway.");errorMsgs.forEach(function(msg){self.paymentErrors.push(msg)})};self.handleErrorMessages=function(error,label){var errorObjs=[];var errorMsgs=[];if(error){errorObjs=error;if(label)errorMsgs=errorHandler.handleErrors(errorObjs,label);else errorMsgs=errorHandler.handleErrors(errorObjs,"app.error.paymentgateway.");console.log("errorMsgs::: ",
errorMsgs)}return errorMsgs}}else{console.log("Your Browser won't supports Apple Pay");if(document.getElementById("applePayButton"))document.getElementById("applePayButton").remove();self.browserUnsupported=true}}},link:{pre:function($scope,iElement,$attrs,controller){},post:function($scope,iElement,$attrs,controller){var self=$scope;self.paymentFuncs=self.paymentFuncs||{};$scope.$watch($attrs.additionalPaymentInfo,function(oldVal,newVal){if(self.selectedPaymentType===constants.APPLE_PAY_METHOD_CODE&&
oldVal.total!==newVal.total)self.createPaymentSession()},true);self.createPaymentSession()}}}}]);
app.directive("wireTransferGateway",["$q","dataServiceG2","constants",function($q,dataServiceG2,constants){return{restrict:"E",templateUrl:"/public/fetchDirective.html?directive\x3dregistration/external-payments/wire-transfer",scope:{paymentFuncs:"\x3d?paymentFuncs",paymentSuccessHandler:"\x26paymentSuccessHandler",paymentFailureHandler:"\x26paymentFailureHandler",selectedPaymentType:"\x3d",paymentErrors:"\x3d",additionalPaymentInfo:"\x3d"},controller:function($scope,$element,$attrs){var self=$scope;
self.locale=dataServiceG2.getLocale();self.additionalPaymentInfo=self.additionalPaymentInfo||{};self.selectedPaymentType=self.selectedPaymentType||""},link:{pre:function($scope,iElement,$attrs,controller){},post:function($scope,iElement,$attrs,controller){var self=$scope}}}}]);